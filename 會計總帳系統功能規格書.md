# 總帳會計系統功能規格書

## 1. 系統概述
這是一個完整的總帳會計系統，使用RPG語言開發，運行在IBM i (AS/400)平台上。系統主要用於處理會計帳務、財務報表和相關業務處理。

## 2. 系統架構
系統分為以下幾個主要模組：

### 2.1 核心模組
- **PCA系列**：主要會計處理模組 (共8個程式)
  - **PCA001**：基本會計處理
    - 功能：處理基本會計分錄輸入、修改、刪除
    - 相關檔案：[GLAFPF](#41-主要資料檔案)、[GLAAPF](#41-主要資料檔案)
    - 顯示檔案：[PCA001D](#102-顯示檔案清單)
    - 詳細說明：[PCA001.md](./docs/programs/PCA001.md)

  - **PCA002**：進階會計處理
    - 功能：處理複雜會計交易、批次分錄、自動分錄
    - 相關檔案：[GLAFPF](#41-主要資料檔案)、[GLAAPF](#41-主要資料檔案)、[GLAKPF](#41-主要資料檔案)
    - 顯示檔案：[PCA002D](#102-顯示檔案清單)
    - 詳細說明：[PCA002.md](./docs/programs/PCA002.md)

  - **PCA003**：會計科目管理
    - 功能：維護會計科目主檔、科目結構管理
    - 相關檔案：[GLAAPF](#41-主要資料檔案)、[GLAKPF](#41-主要資料檔案)
    - 顯示檔案：[PCA003D](#102-顯示檔案清單)
    - 詳細說明：[PCA003.md](./docs/programs/PCA003.md)

  - **PCA004**：會計期間管理
    - 功能：管理會計期間、開帳、關帳
    - 相關檔案：[PCCAPF](#42-系統控制檔案)、[GLAPTF](#41-主要資料檔案)
    - 顯示檔案：[PCA004D](#102-顯示檔案清單)
    - 詳細說明：[PCA004.md](./docs/programs/PCA004.md)

  - **PCA005**：會計憑證管理
    - 功能：管理會計憑證、憑證編號、憑證列印
    - 相關檔案：[GLAVTF](#41-主要資料檔案)、[GLAFPF](#41-主要資料檔案)
    - 顯示檔案：[PCA005D](#102-顯示檔案清單)
    - 詳細說明：[PCA005.md](./docs/programs/PCA005.md)

  - **PCA006**：會計分錄處理
    - 功能：處理會計分錄過帳、沖銷、調整
    - 相關檔案：[GLAFPF](#41-主要資料檔案)、[GLAAPF](#41-主要資料檔案)
    - 顯示檔案：[PCA006D](#102-顯示檔案清單)
    - 詳細說明：[PCA006.md](./docs/programs/PCA006.md)

  - **PCA007**：會計結帳處理
    - 功能：執行會計結帳、月結、年結
    - 相關檔案：[PCCCPF](#42-系統控制檔案)、[GLACTF](#41-主要資料檔案)
    - 顯示檔案：[PCA007D](#102-顯示檔案清單)
    - 詳細說明：[PCA007.md](./docs/programs/PCA007.md)

  - **PCA008**：會計報表處理
    - 功能：產生各類會計報表、報表參數設定
    - 相關檔案：[GLARPF](#43-報表相關檔案)、[GLAFPF](#41-主要資料檔案)
    - 顯示檔案：[PCA008D](#102-顯示檔案清單)
    - 詳細說明：[PCA008.md](./docs/programs/PCA008.md)

### 2.2 報表模組
- **PCR系列**：報表生成模組 (共12個程式)
  - **PCR041**：資產負債表
    - 功能：產生資產負債表、資產負債分析
    - 相關檔案：[GLARPF](#43-報表相關檔案)、[GLAAPF](#41-主要資料檔案)
    - 顯示檔案：[PCR041D](#102-顯示檔案清單)
    - 詳細說明：[PCR041.md](./docs/programs/PCR041.md)

  - **PCR042**：損益表
    - 功能：產生損益表、損益分析
    - 相關檔案：[GLARPF](#43-報表相關檔案)、[GLAAPF](#41-主要資料檔案)
    - 顯示檔案：[PCR042D](#102-顯示檔案清單)
    - 詳細說明：[PCR042.md](./docs/programs/PCR042.md)

  - **PCR043**：現金流量表
    - 功能：產生現金流量表、現金流量分析
    - 相關檔案：[GLARPF](#43-報表相關檔案)、[GLAAPF](#41-主要資料檔案)
    - 顯示檔案：[PCR043D](#102-顯示檔案清單)
    - 詳細說明：[PCR043.md](./docs/programs/PCR043.md)

  - **PCR044**：試算表
    - 功能：產生試算表、科目餘額表
    - 相關檔案：[GLARPF](#43-報表相關檔案)、[GLAAPF](#41-主要資料檔案)
    - 顯示檔案：[PCR044D](#102-顯示檔案清單)
    - 詳細說明：[PCR044.md](./docs/programs/PCR044.md)

  - **PCR044A**：特殊試算表A
    - 功能：產生客製化試算表A
    - 相關檔案：[GLARPF](#43-報表相關檔案)、[GLAAPF](#41-主要資料檔案)
    - 顯示檔案：[PCR044AD](#102-顯示檔案清單)
    - 詳細說明：[PCR044A.md](./docs/programs/PCR044A.md)

  - **PCR044B**：特殊試算表B
    - 功能：產生客製化試算表B
    - 相關檔案：[GLARPF](#43-報表相關檔案)、[GLAAPF](#41-主要資料檔案)
    - 顯示檔案：[PCR044BD](#102-顯示檔案清單)
    - 詳細說明：[PCR044B.md](./docs/programs/PCR044B.md)

  - **PCR045**：總分類帳
    - 功能：產生總分類帳、科目明細
    - 相關檔案：[GLARPF](#43-報表相關檔案)、[GLAAPF](#41-主要資料檔案)
    - 顯示檔案：[PCR045D](#102-顯示檔案清單)
    - 詳細說明：[PCR045.md](./docs/programs/PCR045.md)

  - **PCR0451**：明細分類帳
    - 功能：產生明細分類帳、交易明細
    - 相關檔案：[GLARPF](#43-報表相關檔案)、[GLAFPF](#41-主要資料檔案)
    - 顯示檔案：[PCR0451D](#102-顯示檔案清單)
    - 詳細說明：[PCR0451.md](./docs/programs/PCR0451.md)

  - **PCR046**：科目餘額表
    - 功能：產生科目餘額表、餘額分析
    - 相關檔案：[GLARPF](#43-報表相關檔案)、[GLAAPF](#41-主要資料檔案)
    - 顯示檔案：[PCR046D](#102-顯示檔案清單)
    - 詳細說明：[PCR046.md](./docs/programs/PCR046.md)

  - **PCR047**：科目分析表
    - 功能：產生科目分析表、趨勢分析
    - 相關檔案：[GLARPF](#43-報表相關檔案)、[GLAAPF](#41-主要資料檔案)
    - 顯示檔案：[PCR047D](#102-顯示檔案清單)
    - 詳細說明：[PCR047.md](./docs/programs/PCR047.md)

  - **PCR048**：部門別報表
    - 功能：產生部門別報表、部門分析
    - 相關檔案：[GLARPF](#43-報表相關檔案)、[GLAAPF](#41-主要資料檔案)
    - 顯示檔案：[PCR048D](#102-顯示檔案清單)
    - 詳細說明：[PCR048.md](./docs/programs/PCR048.md)

  - **PCR049**：專案別報表
    - 功能：產生專案別報表、專案分析
    - 相關檔案：[GLARPF](#43-報表相關檔案)、[GLAAPF](#41-主要資料檔案)
    - 顯示檔案：[PCR049D](#102-顯示檔案清單)
    - 詳細說明：[PCR049.md](./docs/programs/PCR049.md)

### 2.3 查詢模組
- **PCI系列**：資料查詢模組 (共6個程式)
  - **PCI001**：會計科目查詢
    - 功能：查詢會計科目資料、科目結構
    - 相關檔案：[GLAAPF](#41-主要資料檔案)、[GLAKPF](#41-主要資料檔案)
    - 顯示檔案：[PCI001D](#102-顯示檔案清單)
    - 詳細說明：[PCI001.md](./docs/programs/PCI001.md)

  - **PCI002**：分錄查詢
    - 功能：查詢會計分錄資料、交易明細
    - 相關檔案：[GLAFPF](#41-主要資料檔案)、[GLAAPF](#41-主要資料檔案)
    - 顯示檔案：[PCI002D](#102-顯示檔案清單)
    - 詳細說明：[PCI002.md](./docs/programs/PCI002.md)

  - **PCI003**：報表查詢
    - 功能：查詢已產生報表、報表參數
    - 相關檔案：[GLARPF](#43-報表相關檔案)、[GLAQTF](#44-查詢相關檔案)
    - 顯示檔案：[PCI003D](#102-顯示檔案清單)
    - 詳細說明：[PCI003.md](./docs/programs/PCI003.md)

  - **PCI004**：歷史資料查詢
    - 功能：查詢歷史資料、歷史報表
    - 相關檔案：[GLARPF](#43-報表相關檔案)、[GLAQTF](#44-查詢相關檔案)
    - 顯示檔案：[PCI004D](#102-顯示檔案清單)
    - 詳細說明：[PCI004.md](./docs/programs/PCI004.md)

  - **PCI005**：統計資料查詢
    - 功能：查詢統計資料、分析報表
    - 相關檔案：[GLASPF](#41-主要資料檔案)、[GLAQTF](#44-查詢相關檔案)
    - 顯示檔案：[PCI005D](#102-顯示檔案清單)
    - 詳細說明：[PCI005.md](./docs/programs/PCI005.md)

  - **PCI006**：系統日誌查詢
    - 功能：查詢系統日誌、操作記錄
    - 相關檔案：[GLALTF](#45-系統日誌檔案)、[GLAQTF](#44-查詢相關檔案)
    - 顯示檔案：[PCI006D](#102-顯示檔案清單)
    - 詳細說明：[PCI006.md](./docs/programs/PCI006.md)

### 2.4 批次處理模組
- **PCB系列**：批次處理模組 (共4個程式)
  - **PCB001**：資料備份
    - 功能：執行資料備份、備份管理
    - 相關檔案：[GLABTF](#41-主要資料檔案)、[GLALTF](#45-系統日誌檔案)
    - 顯示檔案：[PCB001D](#102-顯示檔案清單)
    - 詳細說明：[PCB001.md](./docs/programs/PCB001.md)

  - **PCB002**：資料還原
    - 功能：執行資料還原、還原管理
    - 相關檔案：[GLABTF](#41-主要資料檔案)、[GLALTF](#45-系統日誌檔案)
    - 顯示檔案：[PCB002D](#102-顯示檔案清單)
    - 詳細說明：[PCB002.md](./docs/programs/PCB002.md)

  - **PCB003**：資料清理
    - 功能：執行資料清理、空間管理
    - 相關檔案：[GLABTF](#41-主要資料檔案)、[GLALTF](#45-系統日誌檔案)
    - 顯示檔案：[PCB003D](#102-顯示檔案清單)
    - 詳細說明：[PCB003.md](./docs/programs/PCB003.md)

  - **PCB004**：資料轉換
    - 功能：執行資料轉換、格式轉換
    - 相關檔案：[GLABTF](#41-主要資料檔案)、[GLALTF](#45-系統日誌檔案)
    - 顯示檔案：[PCB004D](#102-顯示檔案清單)
    - 詳細說明：[PCB004.md](./docs/programs/PCB004.md)

## 3. 主要功能

### 3.1 會計處理功能
1. **會計分錄處理**
   - 工作流程：
     1. 輸入基本分錄 ([PCA001](#21-核心模組))
     2. 處理複雜交易 ([PCA002](#21-核心模組))
     3. 執行分錄過帳 ([PCA006](#21-核心模組))
     4. 產生分錄報表 ([PCR044](#22-報表模組))
   - 相關檔案：
     - [GLAFPF](#41-主要資料檔案)：分錄資料
     - [GLAAPF](#41-主要資料檔案)：科目資料
     - [GLARPF](#43-報表相關檔案)：報表資料

2. **會計科目管理**
   - 工作流程：
     1. 維護科目主檔 ([PCA003](#21-核心模組))
     2. 查詢科目資料 ([PCI001](#23-查詢模組))
     3. 產生科目報表 ([PCR046](#22-報表模組))
   - 相關檔案：
     - [GLAAPF](#41-主要資料檔案)：科目主檔
     - [GLAKPF](#41-主要資料檔案)：科目索引
     - [GLARPF](#43-報表相關檔案)：報表資料

3. **會計期間處理**
   - 工作流程：
     1. 管理會計期間 ([PCA004](#21-核心模組))
     2. 執行期間結帳 ([PCA007](#21-核心模組))
     3. 產生期間報表 ([PCR041](#22-報表模組) - [PCR043](#22-報表模組))
   - 相關檔案：
     - [PCCAPF](#42-系統控制檔案)：系統參數
     - [GLAPTF](#41-主要資料檔案)：期間資料
     - [GLACTF](#41-主要資料檔案)：結帳資料

4. **會計憑證管理**
   - 工作流程：
     1. 管理會計憑證 ([PCA005](#21-核心模組))
     2. 查詢憑證資料 ([PCI002](#23-查詢模組))
     3. 產生憑證報表 ([PCR045](#22-報表模組))
   - 相關檔案：
     - [GLAVTF](#41-主要資料檔案)：憑證資料
     - [GLAFPF](#41-主要資料檔案)：分錄資料
     - [GLARPF](#43-報表相關檔案)：報表資料

### 3.2 財務報表功能
1. **資產負債表**
   - 工作流程：
     1. 設定報表參數 ([PCA008](#21-核心模組))
     2. 產生資產負債表 ([PCR041](#22-報表模組))
     3. 查詢報表資料 ([PCI003](#23-查詢模組))
   - 相關檔案：
     - [GLARPF](#43-報表相關檔案)：報表資料
     - [GLAAPF](#41-主要資料檔案)：科目資料
     - [GLAQTF](#44-查詢相關檔案)：查詢資料

2. **損益表**
   - 工作流程：
     1. 設定報表參數 ([PCA008](#21-核心模組))
     2. 產生損益表 ([PCR042](#22-報表模組))
     3. 查詢報表資料 ([PCI003](#23-查詢模組))
   - 相關檔案：
     - [GLARPF](#43-報表相關檔案)：報表資料
     - [GLAAPF](#41-主要資料檔案)：科目資料
     - [GLAQTF](#44-查詢相關檔案)：查詢資料

3. **現金流量表**
   - 工作流程：
     1. 設定報表參數 ([PCA008](#21-核心模組))
     2. 產生現金流量表 ([PCR043](#22-報表模組))
     3. 查詢報表資料 ([PCI003](#23-查詢模組))
   - 相關檔案：
     - [GLARPF](#43-報表相關檔案)：報表資料
     - [GLAAPF](#41-主要資料檔案)：科目資料
     - [GLAQTF](#44-查詢相關檔案)：查詢資料

4. **其他財務報表**
   - 工作流程：
     1. 設定報表參數 ([PCA008](#21-核心模組))
     2. 產生各類報表 ([PCR044](#22-報表模組) - [PCR049](#22-報表模組))
     3. 查詢報表資料 ([PCI003](#23-查詢模組))
   - 相關檔案：
     - [GLARPF](#43-報表相關檔案)：報表資料
     - [GLAAPF](#41-主要資料檔案)：科目資料
     - [GLAQTF](#44-查詢相關檔案)：查詢資料

### 3.3 查詢功能
1. **會計科目查詢**
   - 工作流程：
     1. 設定查詢條件 ([PCI001](#23-查詢模組))
     2. 執行科目查詢
     3. 產生查詢報表 ([PCR046](#22-報表模組))
   - 相關檔案：
     - [GLAAPF](#41-主要資料檔案)：科目資料
     - [GLAKPF](#41-主要資料檔案)：科目索引
     - [GLAQTF](#44-查詢相關檔案)：查詢資料

2. **分錄查詢**
   - 工作流程：
     1. 設定查詢條件 ([PCI002](#23-查詢模組))
     2. 執行分錄查詢
     3. 產生查詢報表 ([PCR045](#22-報表模組))
   - 相關檔案：
     - [GLAFPF](#41-主要資料檔案)：分錄資料
     - [GLAAPF](#41-主要資料檔案)：科目資料
     - [GLAQTF](#44-查詢相關檔案)：查詢資料

3. **報表查詢**
   - 工作流程：
     1. 設定查詢條件 ([PCI003](#23-查詢模組))
     2. 執行報表查詢
     3. 產生查詢結果
   - 相關檔案：
     - [GLARPF](#43-報表相關檔案)：報表資料
     - [GLAQTF](#44-查詢相關檔案)：查詢資料
     - [GLALTF](#45-系統日誌檔案)：日誌資料

4. **歷史資料查詢**
   - 工作流程：
     1. 設定查詢條件 ([PCI004](#23-查詢模組))
     2. 執行歷史查詢
     3. 產生查詢報表
   - 相關檔案：
     - [GLARPF](#43-報表相關檔案)：報表資料
     - [GLAQTF](#44-查詢相關檔案)：查詢資料
     - [GLALTF](#45-系統日誌檔案)：日誌資料

### 3.4 系統管理功能
1. **使用者權限管理**
   - 工作流程：
     1. 設定使用者權限
     2. 記錄操作日誌 ([PCI006](#23-查詢模組))
     3. 查詢權限資料
   - 相關檔案：
     - [GLAUTF](#41-主要資料檔案)：使用者資料
     - [GLALTF](#45-系統日誌檔案)：日誌資料
     - [GLASTF](#41-主要資料檔案)：系統設定

2. **系統參數設定**
   - 工作流程：
     1. 維護系統參數 ([PCA004](#21-核心模組))
     2. 記錄參數異動
     3. 查詢參數資料
   - 相關檔案：
     - [PCCAPF](#42-系統控制檔案)：系統參數
     - [GLALTF](#45-系統日誌檔案)：日誌資料
     - [GLASTF](#41-主要資料檔案)：系統設定

3. **資料備份還原**
   - 工作流程：
     1. 執行資料備份 ([PCB001](#24-批次處理模組))
     2. 執行資料還原 ([PCB002](#24-批次處理模組))
     3. 查詢備份資料
   - 相關檔案：
     - [GLABTF](#41-主要資料檔案)：備份資料
     - [GLALTF](#45-系統日誌檔案)：日誌資料
     - [GLASTF](#41-主要資料檔案)：系統設定

4. **系統日誌管理**
   - 工作流程：
     1. 記錄系統日誌
     2. 查詢日誌資料 ([PCI006](#23-查詢模組))
     3. 清理日誌資料 ([PCB003](#24-批次處理模組))
   - 相關檔案：
     - [GLALTF](#45-系統日誌檔案)：日誌資料
     - [GLASTF](#41-主要資料檔案)：系統設定
     - [GLAQTF](#44-查詢相關檔案)：查詢資料

## 4. 資料庫結構
系統使用多個資料檔案：

### 4.1 主要資料檔案
- **GLAAPF**：會計主檔
  - 用途：儲存會計科目基本資料
  - 主要欄位：科目代碼、科目名稱、科目類別、科目層級、科目狀態
  - 相關程式：[PCA003](#93-核心模組-pca系列)、[PCI001](#93-查詢模組-pci系列)
  - 檔案結構：[GLAAPF.md](./docs/database/GLAAPF.md)

- **GLAFPF**：會計明細檔
  - 用途：儲存會計分錄資料
  - 主要欄位：分錄號碼、會計日期、借方金額、貸方金額、摘要說明
  - 相關程式：[PCA001](#93-核心模組-pca系列)、[PCA002](#93-核心模組-pca系列)
  - 檔案結構：[GLAFPF.md](./docs/database/GLAFPF.md)

- **GLAKPF**：會計索引檔
  - 用途：提供會計科目快速查詢索引
  - 主要欄位：索引鍵值、記錄指標、更新日期
  - 相關程式：[PCA003](#93-核心模組-pca系列)、[PCI001](#93-查詢模組-pci系列)
  - 檔案結構：[GLAKPF.md](./docs/database/GLAKPF.md)

### 4.2 系統控制檔案
- **PCCAPF**：系統參數檔
  - 用途：儲存系統參數設定
  - 主要欄位：參數代碼、參數值、參數說明
  - 相關程式：[PCA004](#93-核心模組-pca系列)
  - 檔案結構：[PCCAPF.md](./docs/database/PCCAPF.md)

- **PCCCPF**：系統控制檔
  - 用途：系統控制資訊
  - 主要欄位：控制代碼、控制值、控制說明
  - 相關程式：[PCA007](#93-核心模組-pca系列)
  - 檔案結構：[PCCCPF.md](./docs/database/PCCCPF.md)

### 4.3 報表相關檔案
- **GLARPF**：會計報表檔
  - 用途：儲存會計報表資料
  - 主要欄位：報表代碼、報表名稱、報表參數
  - 相關程式：[PCR041](#92-報表模組-pcr系列) - [PCR045](#92-報表模組-pcr系列)
  - 檔案結構：[GLARPF.md](./docs/database/GLARPF.md)

### 4.4 查詢相關檔案
- **GLAQTF**：會計查詢檔
  - 用途：儲存會計查詢條件
  - 主要欄位：查詢代碼、查詢條件、查詢結果
  - 相關程式：[PCI001](#93-查詢模組-pci系列) - [PCI006](#93-查詢模組-pci系列)
  - 檔案結構：[GLAQTF.md](./docs/database/GLAQTF.md)

### 4.5 系統日誌檔案
- **GLALTF**：會計日誌檔
  - 用途：記錄系統操作日誌
  - 主要欄位：操作日期、操作時間、操作人員、操作內容
  - 相關程式：[PCI006](#93-查詢模組-pci系列)
  - 檔案結構：[GLALTF.md](./docs/database/GLALTF.md)

## 5. 安全性設計
1. 使用者權限控制
2. 功能權限管理
3. 資料存取控制
4. 操作日誌記錄

## 6. 系統整合
1. 與其他系統的介面
2. 資料匯入匯出功能
3. 報表輸出格式
4. 批次處理整合

## 7. 系統需求
1. 硬體需求
   - IBM i (AS/400) 伺服器
   - 終端機或PC工作站

2. 軟體需求
   - IBM i 作業系統
   - RPG程式語言環境
   - 相關系統軟體

## 8. 維護與支援
1. 系統維護程序
2. 問題處理流程
3. 版本更新機制
4. 技術支援服務

## 9. 程式模組說明

### 9.1 核心模組 (PCA系列)
- **PCA001**: 基本會計處理
  - 功能：處理基本會計分錄
  - 主要檔案：GLAAPF, GLAFPF
  - 相關程式：PCA001D (顯示檔案)

- **PCA002**: 進階會計處理
  - 功能：處理複雜會計交易
  - 主要檔案：GLAAPF, GLAFPF, GLAKPF
  - 相關程式：PCA002D (顯示檔案)

### 9.2 報表模組 (PCR系列)
- **PCR041-PCR045**: 標準財務報表
  - 功能：產生各類財務報表
  - 主要檔案：GLAAPF, GLAFPF
  - 輸出格式：報表檔案

- **PCR044A/B**: 特殊報表
  - 功能：客製化報表處理
  - 主要檔案：GLAAPF, GLAFPF
  - 輸出格式：自訂格式

### 9.3 查詢模組 (PCI系列)
- **PCI001-PCI006**: 資料查詢
  - 功能：多維度資料查詢
  - 主要檔案：GLAAPF, GLAFPF
  - 相關程式：PCI001D-PCI006D

### 9.4 批次處理模組 (PCB系列)
- **PCB001-PCB002**: 批次作業
  - 功能：自動化處理程序
  - 主要檔案：GLAAPF, GLAFPF
  - 執行方式：排程執行

## 9. 系統檔案彙總表

### 9.1 實體檔案彙總表

| 檔案代碼 | 檔案名稱 | 檔案類型 | 主要用途 |
|---------|---------|---------|---------|
| GLAAPF | 會計科目主檔 | 主檔 | 儲存會計科目基本資料 |
| GLAFPF | 會計分錄主檔 | 主檔 | 儲存會計分錄資料 |
| GLAKPF | 會計科目索引檔 | 索引檔 | 會計科目索引資料 |
| GLAPRF | 會計參數檔 | 參數檔 | 儲存會計系統參數 |
| GLAPTF | 會計期間檔 | 主檔 | 儲存會計期間資料 |
| GLAVTF | 會計憑證檔 | 主檔 | 儲存會計憑證資料 |
| GLABTF | 會計批次檔 | 主檔 | 儲存會計批次資料 |
| GLACTF | 會計結帳檔 | 主檔 | 儲存會計結帳資料 |
| GLARPF | 會計報表檔 | 主檔 | 儲存會計報表資料 |
| GLAQTF | 會計查詢檔 | 主檔 | 儲存會計查詢資料 |
| GLASPF | 會計統計檔 | 主檔 | 儲存會計統計資料 |
| GLALTF | 會計日誌檔 | 主檔 | 儲存會計系統日誌 |
| GLAUTF | 會計使用者檔 | 主檔 | 儲存會計系統使用者資料 |
| GLASTF | 會計系統檔 | 主檔 | 儲存會計系統設定 |
| GLACLF | 會計分類檔 | 主檔 | 儲存會計科目分類資料 |

### 9.2 顯示檔案彙總表

| 檔案代碼 | 檔案名稱 | 主要用途 | 相關程式 |
|---------|---------|---------|---------|
| PCA001D | 基本會計處理顯示 | 基本會計分錄輸入畫面 | PCA001 |
| PCA002D | 進階會計處理顯示 | 複雜會計交易輸入畫面 | PCA002 |
| PCA003D | 會計科目管理顯示 | 會計科目維護畫面 | PCA003 |
| PCA004D | 會計期間處理顯示 | 會計期間管理畫面 | PCA004 |
| PCA005D | 會計憑證管理顯示 | 會計憑證維護畫面 | PCA005 |
| PCA006D | 會計分錄處理顯示 | 會計分錄維護畫面 | PCA006 |
| PCA007D | 會計結帳處理顯示 | 會計結帳作業畫面 | PCA007 |
| PCA008D | 會計報表處理顯示 | 會計報表產生畫面 | PCA008 |
| PCR041D | 資產負債表顯示 | 資產負債表參數設定畫面 | PCR041 |
| PCR042D | 損益表顯示 | 損益表參數設定畫面 | PCR042 |
| PCR043D | 現金流量表顯示 | 現金流量表參數設定畫面 | PCR043 |
| PCR044D | 試算表顯示 | 試算表參數設定畫面 | PCR044 |
| PCR045D | 總分類帳顯示 | 總分類帳參數設定畫面 | PCR045 |

### 9.3 報表檔案彙總表

| 檔案代碼 | 檔案名稱 | 主要用途 | 相關程式 |
|---------|---------|---------|---------|
| GLRPF | 會計報表主檔 | 儲存會計報表資料 | PCR041-PCR045 |
| GLRPDF | 會計報表參數檔 | 儲存會計報表參數 | PCR041-PCR045 |
| GLRTDF | 會計報表範本檔 | 儲存會計報表範本 | PCR041-PCR045 |
| GLARPF | 會計報表檔 | 儲存會計報表資料 | PCR041-PCR045 |

### 9.4 RPG程式彙總表

| 程式代碼 | 程式名稱 | 主要功能 | 相關檔案 |
|---------|---------|---------|---------|
| PCA001 | 基本會計處理 | 處理基本會計分錄 | GLAAPF, GLAFPF |
| PCA002 | 進階會計處理 | 處理複雜會計交易 | GLAAPF, GLAFPF, GLAKPF |
| PCA003 | 會計科目管理 | 維護會計科目主檔 | GLAAPF |
| PCA004 | 會計期間處理 | 管理會計期間 | GLAAPF, GLAFPF |
| PCA005 | 會計憑證管理 | 處理會計憑證 | GLAFPF |
| PCA006 | 會計分錄處理 | 處理會計分錄 | GLAFPF |
| PCA007 | 會計結帳處理 | 執行會計結帳 | GLAAPF, GLAFPF |
| PCA008 | 會計報表處理 | 產生會計報表 | GLAAPF, GLAFPF |
| PCR041 | 資產負債表 | 產生資產負債表 | GLAAPF, GLAFPF |
| PCR042 | 損益表 | 產生損益表 | GLAAPF, GLAFPF |
| PCR043 | 現金流量表 | 產生現金流量表 | GLAAPF, GLAFPF |
| PCR044 | 試算表 | 產生試算表 | GLAAPF, GLAFPF |
| PCR045 | 總分類帳 | 產生總分類帳 | GLAAPF, GLAFPF |

## 10. 系統檔案清單

### 10.1 實體檔案清單
1. GLAAPF - 會計科目主檔
2. GLAFPF - 會計分錄主檔
3. GLAKPF - 會計科目索引檔
4. GLAPRF - 會計參數檔
5. GLAPTF - 會計期間檔
6. GLAVTF - 會計憑證檔
7. GLABTF - 會計批次檔
8. GLACTF - 會計結帳檔
9. GLARPF - 會計報表檔
10. GLAQTF - 會計查詢檔
11. GLASPF - 會計統計檔
12. GLALTF - 會計日誌檔
13. GLAUTF - 會計使用者檔
14. GLASTF - 會計系統檔
15. GLACLF - 會計分類檔

### 10.2 顯示檔案清單
1. PCA001D - 基本會計處理顯示
2. PCA002D - 進階會計處理顯示
3. PCA003D - 會計科目管理顯示
4. PCA004D - 會計期間處理顯示
5. PCA005D - 會計憑證管理顯示
6. PCA006D - 會計分錄處理顯示
7. PCA007D - 會計結帳處理顯示
8. PCA008D - 會計報表處理顯示
9. PCR041D - 資產負債表顯示
10. PCR042D - 損益表顯示
11. PCR043D - 現金流量表顯示
12. PCR044D - 試算表顯示
13. PCR045D - 總分類帳顯示

### 10.3 報表檔案清單
1. GLRPF - 會計報表主檔
2. GLRPDF - 會計報表參數檔
3. GLRTDF - 會計報表範本檔
4. GLARPF - 會計報表檔

### 10.4 RPG程式清單
1. PCA001 - 基本會計處理
2. PCA002 - 進階會計處理
3. PCA003 - 會計科目管理
4. PCA004 - 會計期間處理
5. PCA005 - 會計憑證管理
6. PCA006 - 會計分錄處理
7. PCA007 - 會計結帳處理
8. PCA008 - 會計報表處理
9. PCR041 - 資產負債表
10. PCR042 - 損益表
11. PCR043 - 現金流量表
12. PCR044 - 試算表
13. PCR045 - 總分類帳

## 11. 資料結構說明

### 11.1 主要資料檔案
1. **GLAAPF (會計主檔)**
   - 用途：儲存會計科目主檔資料
   - 主要欄位：科目代碼、科目名稱、科目類別等

2. **GLAFPF (會計明細檔)**
   - 用途：儲存會計分錄明細
   - 主要欄位：分錄號碼、會計科目、金額、日期等

3. **GLAKPF (會計索引檔)**
   - 用途：提供快速查詢索引
   - 主要欄位：索引鍵值、記錄指標等

### 11.2 系統檔案
1. **PCCAPF (系統參數檔)**
   - 用途：儲存系統參數設定
   - 主要欄位：參數代碼、參數值等

2. **PCCCPF (系統控制檔)**
   - 用途：系統控制資訊
   - 主要欄位：控制代碼、控制值等

## 12. 系統整合介面

### 12.1 外部系統介面
1. 與其他會計系統的資料交換
2. 與ERP系統的整合
3. 與銀行系統的介接

### 12.2 資料匯入匯出
1. 支援多種檔案格式
2. 批次資料處理
3. 即時資料同步

## 13. 系統維護與支援

### 13.1 日常維護
1. 資料備份程序
2. 系統效能監控
3. 錯誤日誌分析

### 13.2 問題處理
1. 問題回報流程
2. 緊急處理程序
3. 系統修復程序

### 13.3 版本更新
1. 更新程序說明
2. 版本控制管理
3. 更新測試程序

## 14. 完整作業流程

### 14.1 日常會計作業流程
1. **會計分錄處理**
   - 輸入會計分錄 (PCA001)
   - 審核會計分錄 (PCA002)
   - 過帳處理 (PCA006)
   - 產生分錄報表 (PCR044)

2. **會計科目管理**
   - 維護會計科目 (PCA003)
   - 科目餘額查詢 (PCI001)
   - 科目分析報表 (PCR047)

3. **會計期間處理**
   - 期間開帳 (PCA004)
   - 期間結帳 (PCA007)
   - 期間報表 (PCR041-043)

### 14.2 月結作業流程
1. **月結準備**
   - 檢查未過帳分錄 (PCA001)
   - 檢查科目餘額 (PCI001)
   - 產生試算表 (PCR044)

2. **月結處理**
   - 執行月結 (PCA007)
   - 產生月結報表 (PCR041-043)
   - 備份月結資料 (PCB001)

3. **月結確認**
   - 審核月結報表
   - 確認月結完成
   - 關閉會計期間

### 14.3 年結作業流程
1. **年結準備**
   - 檢查全年分錄 (PCA001)
   - 檢查科目餘額 (PCI001)
   - 產生年度試算表 (PCR044)

2. **年結處理**
   - 執行年結 (PCA007)
   - 產生年度報表 (PCR041-043)
   - 備份年度資料 (PCB001)

3. **年結確認**
   - 審核年度報表
   - 確認年結完成
   - 關閉會計年度

### 14.4 報表作業流程
1. **標準報表**
   - 選擇報表類型 (PCR041-043)
   - 設定報表參數
   - 產生報表
   - 列印或儲存報表

2. **自訂報表**
   - 選擇報表範本 (PCR044A/B)
   - 設定報表條件
   - 產生報表
   - 列印或儲存報表

3. **分析報表**
   - 選擇分析維度 (PCR047-049)
   - 設定分析條件
   - 產生分析報表
   - 列印或儲存報表

### 14.5 系統維護流程
1. **日常維護**
   - 資料備份 (PCB001)
   - 系統檢查 (PCI006)
   - 效能監控
   - 錯誤處理

2. **定期維護**
   - 資料清理 (PCB003)
   - 系統優化
   - 參數調整
   - 版本更新

3. **緊急維護**
   - 問題診斷
   - 緊急修復
   - 資料還原 (PCB002)
   - 系統恢復

## 15. 模組關聯圖

### 15.1 核心模組關聯
```
PCA001 (基本會計處理)
    ↓
PCA002 (進階會計處理)
    ↓
PCA006 (會計分錄處理)
    ↓
PCA007 (會計結帳處理)
```

### 15.2 報表模組關聯
```
PCR041 (資產負債表)
    ↓
PCR042 (損益表)
    ↓
PCR043 (現金流量表)
    ↓
PCR044 (試算表)
```

### 15.3 查詢模組關聯
```
PCI001 (會計科目查詢)
    ↓
PCI002 (分錄查詢)
    ↓
PCI003 (報表查詢)
    ↓
PCI004 (歷史資料查詢)
```

### 15.4 批次處理模組關聯
```
PCB001 (資料備份)
    ↓
PCB002 (資料還原)
    ↓
PCB003 (資料清理)
    ↓
PCB004 (資料轉換)
```

## 16. 錯誤訊息清單

### 16.1 會計處理功能錯誤訊息

#### 16.1.1 會計分錄處理錯誤
1. **基本分錄輸入錯誤**
   - 錯誤代碼：PCA001-001
   - 錯誤訊息：科目代碼不存在
   - 發生時機：[PCA001](#21-核心模組) 輸入基本分錄時
   - 處理方式：檢查科目代碼是否正確，或使用 [PCI001](#23-查詢模組) 查詢科目資料
   - 相關檔案：[GLAAPF](#41-主要資料檔案)

   - 錯誤代碼：PCA001-002
   - 錯誤訊息：借貸不平衡
   - 發生時機：[PCA001](#21-核心模組) 輸入分錄時
   - 處理方式：檢查借方金額總和是否等於貸方金額總和
   - 相關檔案：[GLAFPF](#41-主要資料檔案)

   - 錯誤代碼：PCA001-003
   - 錯誤訊息：會計期間已關閉
   - 發生時機：[PCA001](#21-核心模組) 輸入分錄時
   - 處理方式：使用 [PCA004](#21-核心模組) 檢查會計期間狀態
   - 相關檔案：[GLAPTF](#41-主要資料檔案)

2. **進階會計處理錯誤**
   - 錯誤代碼：PCA002-001
   - 錯誤訊息：批次分錄格式錯誤
   - 發生時機：[PCA002](#21-核心模組) 處理批次分錄時
   - 處理方式：檢查批次分錄檔案格式
   - 相關檔案：[GLAFPF](#41-主要資料檔案)

   - 錯誤代碼：PCA002-002
   - 錯誤訊息：自動分錄規則錯誤
   - 發生時機：[PCA002](#21-核心模組) 執行自動分錄時
   - 處理方式：檢查自動分錄規則設定
   - 相關檔案：[GLAKPF](#41-主要資料檔案)

3. **分錄過帳錯誤**
   - 錯誤代碼：PCA006-001
   - 錯誤訊息：分錄已過帳
   - 發生時機：[PCA006](#21-核心模組) 執行過帳時
   - 處理方式：使用 [PCI002](#23-查詢模組) 查詢分錄狀態
   - 相關檔案：[GLAFPF](#41-主要資料檔案)

   - 錯誤代碼：PCA006-002
   - 錯誤訊息：分錄已被沖銷
   - 發生時機：[PCA006](#21-核心模組) 執行過帳時
   - 處理方式：檢查分錄狀態
   - 相關檔案：[GLAFPF](#41-主要資料檔案)

#### 16.1.2 會計科目管理錯誤
1. **科目維護錯誤**
   - 錯誤代碼：PCA003-001
   - 錯誤訊息：科目代碼重複
   - 發生時機：[PCA003](#21-核心模組) 新增科目時
   - 處理方式：使用 [PCI001](#23-查詢模組) 檢查科目代碼
   - 相關檔案：[GLAAPF](#41-主要資料檔案)

   - 錯誤代碼：PCA003-002
   - 錯誤訊息：科目層級錯誤
   - 發生時機：[PCA003](#21-核心模組) 維護科目時
   - 處理方式：檢查科目層級設定
   - 相關檔案：[GLAAPF](#41-主要資料檔案)

#### 16.1.3 會計期間處理錯誤
1. **期間管理錯誤**
   - 錯誤代碼：PCA004-001
   - 錯誤訊息：期間重疊
   - 發生時機：[PCA004](#21-核心模組) 設定會計期間時
   - 處理方式：檢查期間設定
   - 相關檔案：[GLAPTF](#41-主要資料檔案)

   - 錯誤代碼：PCA004-002
   - 錯誤訊息：期間未連續
   - 發生時機：[PCA004](#21-核心模組) 設定會計期間時
   - 處理方式：檢查期間連續性
   - 相關檔案：[GLAPTF](#41-主要資料檔案)

### 16.2 財務報表功能錯誤訊息

#### 16.2.1 報表產生錯誤
1. **資產負債表錯誤**
   - 錯誤代碼：PCR041-001
   - 錯誤訊息：報表期間錯誤
   - 發生時機：[PCR041](#22-報表模組) 產生報表時
   - 處理方式：檢查報表期間設定
   - 相關檔案：[GLARPF](#43-報表相關檔案)

2. **損益表錯誤**
   - 錯誤代碼：PCR042-001
   - 錯誤訊息：科目分類錯誤
   - 發生時機：[PCR042](#22-報表模組) 產生報表時
   - 處理方式：檢查科目分類設定
   - 相關檔案：[GLAAPF](#41-主要資料檔案)

3. **現金流量表錯誤**
   - 錯誤代碼：PCR043-001
   - 錯誤訊息：現金科目設定錯誤
   - 發生時機：[PCR043](#22-報表模組) 產生報表時
   - 處理方式：檢查現金科目設定
   - 相關檔案：[GLAAPF](#41-主要資料檔案)

### 16.3 查詢功能錯誤訊息

#### 16.3.1 查詢條件錯誤
1. **科目查詢錯誤**
   - 錯誤代碼：PCI001-001
   - 錯誤訊息：查詢條件格式錯誤
   - 發生時機：[PCI001](#23-查詢模組) 執行查詢時
   - 處理方式：檢查查詢條件格式
   - 相關檔案：[GLAQTF](#44-查詢相關檔案)

2. **分錄查詢錯誤**
   - 錯誤代碼：PCI002-001
   - 錯誤訊息：日期範圍錯誤
   - 發生時機：[PCI002](#23-查詢模組) 執行查詢時
   - 處理方式：檢查日期範圍設定
   - 相關檔案：[GLAQTF](#44-查詢相關檔案)

### 16.4 系統管理功能錯誤訊息

#### 16.4.1 使用者權限錯誤
1. **權限設定錯誤**
   - 錯誤代碼：SYS001-001
   - 錯誤訊息：使用者權限不足
   - 發生時機：執行需要特定權限的功能時
   - 處理方式：檢查使用者權限設定
   - 相關檔案：[GLAUTF](#41-主要資料檔案)

2. **系統參數錯誤**
   - 錯誤代碼：SYS002-001
   - 錯誤訊息：參數值超出範圍
   - 發生時機：[PCA004](#21-核心模組) 設定系統參數時
   - 處理方式：檢查參數值範圍
   - 相關檔案：[PCCAPF](#42-系統控制檔案)

### 16.5 錯誤訊息處理流程

1. **錯誤訊息格式**
   - 錯誤代碼：模組代碼-序號
   - 錯誤訊息：簡潔明確的錯誤描述
   - 發生時機：說明錯誤發生的時機
   - 處理方式：提供解決方案
   - 相關檔案：列出相關的資料檔案

2. **錯誤訊息記錄**
   - 記錄位置：[GLALTF](#45-系統日誌檔案)
   - 記錄內容：錯誤代碼、錯誤訊息、發生時間、使用者、相關資料
   - 查詢方式：使用 [PCI006](#23-查詢模組) 查詢錯誤日誌

3. **錯誤訊息通知**
   - 通知方式：系統訊息、電子郵件、簡訊
   - 通知對象：系統管理員、相關使用者
   - 通知時機：即時通知、每日彙總 