# GLWF14.txt 檔案規格書

## 檔案概述
GLWF14.txt 是一個定義08損益表工作檔(GLWF14)的資料結構檔案，屬於總帳模組(GL模組)系統的一部分。與GLWF13同樣用於處理損益表相關數據，但GLWF14的資料結構更加豐富和複雜，包含了更多的金額欄位和額外的識別資訊。該檔案主要用於支援更詳細的損益表分析，包括實際金額與預算金額的對比分析，為財務報表與分析提供更全面的數據支援。

## 檔案結構
檔案採用DDS (Data Description Specifications) 格式定義，以REF(GLRF)語句參照GLRF函式庫中的定義。其主要記錄格式為GLWF14R，包含多個與科目識別和金額相關的欄位，以項次(WF1401)和公司代碼(WF1402)作為複合主鍵，提供更靈活的數據組織能力。

### 關鍵特性
- 檔案名稱：GLWF14
- 記錄格式：GLWF14R
- 複合主鍵：WF1401（項次）和WF1402（公司代碼）
- 參照檔案：GLRF (總帳模組的參照檔案)

## 欄位結構說明

GLWF14.txt 定義了一個記錄格式(GLWF14R)，包含以下欄位：

| 欄位名稱 | 參照欄位 | 標題說明 | 用途說明 |
|----------|----------|----------|----------|
| WF1401   | -        | 項次     | 3位數數字，用於識別記錄順序或類別，作為複合主鍵的一部分 |
| WF1402   | AS04     | 公司     | 公司代碼，作為複合主鍵的一部分 |
| WF1403   | AS08     | 結算碼   | 標示是否為結算科目，'V' 為結算科目，' ' 為非結算科目 |
| WF1404   | AS10     | 科目名稱 | 關聯科目的名稱 |
| WF1405-WF1411 | AH12 | 金額一至金額七 | 用於實際金額的七個金額欄位 |
| WF1415-WF1420 | AH12 | 金額八至金額十三 | 用於預算金額的六個金額欄位 |
| WF1431   | AH12     | 金額十四 | 額外的金額欄位，可能用於特殊用途 |

### 欄位詳細說明

#### 識別與分類欄位
- **WF1401(項次)**：
  - 3位數數字(3 0)格式，用於記錄分類或排序
  - 作為複合主鍵的第一部分，增加資料組織的靈活性
  - 可能用於區分不同類型的損益項目或報表段落

- **WF1402(公司)**：
  - 參照 AS04，識別資料所屬的公司代碼
  - 作為複合主鍵的第二部分，與項次共同確保記錄的唯一性

- **WF1403(結算碼)**：
  - 參照 AS08，標識科目是否為結算科目
  - 取值 'V' 表示為結算科目，' ' 表示為非結算科目
  - 用於區分在損益表中需特別處理的結算科目

- **WF1404(科目名稱)**：
  - 參照 AS10，記錄科目的名稱
  - 便於在損益表中識別和顯示科目資訊

#### 實際金額欄位組
- **WF1405-WF1411(金額一至金額七)**：
  - 均參照 AH12(借方金額)，用於存儲實際的損益數據
  - 提供全面的實際金額記錄能力，可能用於存儲以下類型的數據：
    - 不同期間的實際損益數據(如本月、本季、本年)
    - 不同類型的實際金額(如營收、成本、毛利)
    - 不同計算階段的金額(如小計、合計)

#### 預算金額欄位組
- **WF1415-WF1420(金額八至金額十三)**：
  - 檔案注釋中標識為"預算"，表明這組欄位用於存儲預算相關的金額
  - 均參照 AH12(借方金額)，但專門用於預算金額數據
  - 與實際金額欄位組對應，便於實際與預算的對比分析

#### 額外金額欄位
- **WF1431(金額十四)**：
  - 參照 AH12(借方金額)，單獨一個金額欄位
  - 可能用於存儲特殊用途的金額數據，如差異金額或比率

### 欄位參照關係
欄位參照了多個核心檔案的定義：
1. **科目基準表(GLADPF)**：AS04(公司代碼)、AS08(結算碼)、AS10(科目名稱)
2. **會計傳票檔(GLAHPF)**：AH12(借方金額)，用於所有金額欄位的格式定義

### 主鍵結構
檔案定義了一個由兩個欄位組成的複合主鍵：
```
A          K WF1401
A          K WF1402
```

這種複合主鍵設計允許每個公司代碼下存在多個記錄，按項次區分，提供更靈活的數據組織方式。

## 與GLWF13的關係與區別

GLWF14與GLWF13同為損益表工作檔，但存在以下明顯區別：

1. **主鍵結構差異**：
   - GLWF13使用單一公司代碼作為主鍵
   - GLWF14使用項次和公司代碼的複合主鍵，允許更複雜的數據結構

2. **欄位數量與分組**：
   - GLWF13僅包含6個金額欄位
   - GLWF14包含14個金額欄位，明確分為實際金額和預算金額兩組

3. **結算碼包含**：
   - GLWF13缺少結算碼欄位
   - GLWF14包含結算碼欄位，與GLWF11和GLWF12保持一致

4. **數據組織能力**：
   - GLWF14的項次欄位允許按類別或次序組織數據
   - 可支援更結構化的損益表格式和層次

## 檔案用途

GLWF14檔案在會計系統中的主要用途可能包括：

1. **詳細損益表生成**：為更詳細、結構化的損益表提供數據基礎
2. **預算與實際對比**：專門支援實際與預算的對比分析
3. **多層次損益分析**：支援多層次的損益結構和分類分析
4. **綜合財務報表**：作為較複雜財務報表的數據源
5. **業績評估基礎**：提供業績評估和決策分析的數據基礎

## 與其他檔案的關聯

GLWF14與總帳模組中的其他檔案有以下關聯：

1. **直接參照關係**：
   - 參照GLRF檔案庫的定義
   - 參照科目基準表(GLADPF)和會計傳票檔(GLAHPF)的欄位定義

2. **功能關聯**：
   - 與科目基準表(GLADPF)關聯，獲取科目和結算屬性
   - 與會計傳票檔(GLAHPF)關聯，獲取實際金額數據
   - 可能與預算檔(GLATPF/GLAUPF)關聯，獲取預算數據
   - 與GLWF13有功能互補關係，共同支援完整的損益分析需求

3. **資料流向**：
   - 會計交易資料 → 實際金額欄位
   - 預算規劃資料 → 預算金額欄位
   - GLWF14整合資料 → 損益對比分析報表

## 檔案獨特性

相較於其他損益相關工作檔，GLWF14具有以下獨特特點：

1. **實際與預算整合設計**：
   - 在同一記錄中同時包含實際金額和預算金額欄位
   - 便於直接進行實際與預算的對比分析

2. **項次分類系統**：
   - 通過項次欄位提供更結構化的數據組織能力
   - 支援多層次、複雜結構的損益表格式

3. **豐富的金額欄位**：
   - 共14個金額欄位，提供更全面的數據儲存能力
   - 可滿足複雜損益分析的多維度需求

4. **結構化報表導向**：
   - 設計更偏向於結構化、層次化的報表需求
   - 適合生成高度定制化的管理報表

## 系統中的角色

在總帳模組系統中，GLWF14作為08損益表工作檔，可能扮演以下角色：

1. **管理報表數據中心**：提供管理決策所需的詳細損益分析數據
2. **預算控制與分析平台**：支援預算管理和差異分析
3. **高級財務報表基礎**：為更複雜的財務報表提供數據基礎
4. **業績評估工具**：支援基於預算和實際的業績評估

## 操作考量

使用GLWF14檔案時的主要操作考量：

1. **項次欄位的使用規範**：
   - 明確定義項次欄位的使用規則和編碼方式
   - 確保項次的一致性和連續性

2. **實際與預算金額的對應關係**：
   - 確保實際金額欄位與預算金額欄位的正確對應
   - 維護兩組金額欄位的數據一致性

3. **多層次結構的維護**：
   - 正確維護基於項次的多層次結構
   - 確保小計、合計等層次關係的正確性

4. **數據更新時機與順序**：
   - 明確實際金額和預算金額的更新時機
   - 確保更新順序的合理性，避免數據不一致

## 預算與實際分析應用場景

GLWF14在以下預算與實際分析場景中可能特別有用：

1. **預算執行監控**：
   - 實時監控預算執行情況
   - 識別與預算顯著偏離的領域

2. **差異分析報表**：
   - 生成實際與預算差異分析報表
   - 提供差異原因的分析基礎

3. **滾動預測更新**：
   - 支援基於實際數據更新滾動預測
   - 提供預測調整的數據基礎

4. **多期間趨勢分析**：
   - 分析多期間的預算執行趨勢
   - 評估預算準確性和業務表現

## 金額欄位的可能用途分配

GLWF14的金額欄位可能有以下用途分配：

1. **實際金額欄位(WF1405-WF1411)**：
   - WF1405：本月實際金額
   - WF1406：本季實際金額
   - WF1407：本年累計實際金額
   - WF1408：去年同期實際金額
   - WF1409：去年全年實際金額
   - WF1410：實際金額小計
   - WF1411：實際金額合計

2. **預算金額欄位(WF1415-WF1420)**：
   - WF1415：本月預算金額
   - WF1416：本季預算金額
   - WF1417：本年預算金額
   - WF1418：下季預算金額
   - WF1419：預算金額小計
   - WF1420：預算金額合計

3. **特殊金額欄位(WF1431)**：
   - 可能用於存儲實際與預算的差異百分比
   - 或作為特定分析指標的計算結果

## 項次欄位的可能使用方式

WF1401(項次)欄位作為3位數字，可能有以下使用方式：

1. **損益表層次編碼**：
   - 100、200、300等：主要類別(如營業收入、營業成本、營業費用)
   - 110、120、130等：子類別(如商品銷售收入、服務收入)
   - 111、112、113等：具體科目項目

2. **報表部分識別**：
   - 100-199：收入部分
   - 200-299：成本部分
   - 300-399：費用部分
   - 400-499：其他收支部分
   - 500-599：稅項部分
   - 900-999：合計與結果部分

3. **排序控制**：
   - 單純用於控制損益表項目的顯示順序
   - 保證報表格式的一致性和連續性

## 效能與維護考量

使用和維護GLWF14檔案時的效能與維護考量：

1. **資料量管理**：
   - 由於包含多個項次和多個金額欄位，資料量可能較大
   - 需制定適當的資料保留和清理策略

2. **資料一致性維護**：
   - 確保實際金額與預算金額的一致性
   - 特別是在涉及計算或匯總的欄位

3. **項次管理效率**：
   - 優化基於項次的查詢和處理
   - 考慮建立適當的索引提高查詢效能

4. **報表生成效能**：
   - 優化基於GLWF14的報表生成程序
   - 減少不必要的資料重複計算

## 與預算系統的整合

GLWF14作為同時包含實際和預算資料的檔案，與預算系統的整合尤為重要：

1. **預算資料同步**：
   - 建立與預算系統的資料同步機制
   - 確保預算金額的及時性和準確性

2. **預算調整反映**：
   - 在預算調整後更新預算金額欄位
   - 保持預算資訊的最新狀態

3. **實際金額反饋**：
   - 使用實際金額資料反饋至預算系統
   - 支援基於實際表現的預算調整

4. **整合報表生成**：
   - 基於GLWF14生成整合預算執行報表
   - 提供全面的預算執行視圖

## 檔案維護建議

維護GLWF14檔案的主要建議：

1. **項次編碼規範文檔**：
   - 建立並維護詳細的項次編碼規範文檔
   - 確保項次的一致使用和理解

2. **金額欄位映射文檔**：
   - 詳細記錄所有金額欄位的具體用途
   - 特別是實際金額與預算金額的對應關係

3. **定期資料驗證**：
   - 定期驗證資料的準確性和完整性
   - 尤其是涉及計算或匯總的欄位

4. **報表與資料結構協調**：
   - 確保報表需求變化時同步調整資料結構
   - 維護報表和資料結構的一致性

## 結論

GLWF14.txt是總帳系統中用於支援詳細損益分析和預算控制的工作檔案定義。它通過複合主鍵設計和豐富的金額欄位結構，提供對實際與預算資料的全面儲存和對比分析能力。特別是其項次分類機制和實際預算整合設計，使其特別適合生成結構化、多層次的管理報表和預算差異分析。正確理解和使用這個檔案對於實現有效的財務控制和決策支持至關重要，尤其是在需要密切監控預算執行和進行多維度財務分析的企業環境中。 