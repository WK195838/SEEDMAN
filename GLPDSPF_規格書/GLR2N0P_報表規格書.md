# GLR2N0P 報表規格書

## 1. 報表概述

### 1.1 基本資訊
- 程式編號：GLR2N0P
- 程式名稱：會計科目餘額明細表
- 作者：A1087 JOYCE
- 建立日期：1992.11.30
- 系統：會計總帳

### 1.2 報表用途
本報表用於顯示會計科目的餘額明細資料，包含借貸方金額及餘額資訊。

## 2. 報表欄位說明

### 2.1 表頭資訊
- 會計科目餘額明細表 (標題)
- 部門別：顯示部門代碼
- 會計科目：顯示科目代碼
- 日期範圍：顯示起訖日期
- 列印日期：顯示報表產生日期
- 列印時間：顯示報表產生時間
- 頁碼：顯示當前頁碼

### 2.2 資料欄位
1. 科目代碼 (PF1002-PF1006)
   - 長度：20位
   - 位置：依層級不同而異

2. 借方金額 (WF1007)
   - 長度：依系統設定
   - 格式：數值，含小數點
   - 位置：107-116

3. 貸方金額 (WF1008)
   - 長度：依系統設定
   - 格式：數值，含小數點
   - 位置：117-135

4. 餘額 (WF1009)
   - 長度：依系統設定
   - 格式：數值，含小數點
   - 位置：136-154

### 2.3 合計欄位
- 借方合計 (PT61)
- 貸方合計 (PT62)
- 餘額合計 (PT63)

## 3. 報表格式

### 3.1 畫面配置
1. 表頭區 (PH1)
   - 標題：會計科目餘額明細表
   - 部門別、會計科目、日期範圍
   - 列印日期、時間、頁碼

2. 資料區 (PD1-PT5)
   - 最多顯示5層科目資料
   - 每層包含科目代碼、借貸方金額及餘額
   - 使用分隔線區分不同層級

3. 合計區 (PE1-PE2)
   - 顯示總計金額
   - 包含借方、貸方及餘額合計

### 3.2 分隔線
- 使用 "=" 符號作為主要分隔線
- 使用 "-" 符號作為資料區分隔線

## 4. 報表輸出說明

### 4.1 輸出格式
- 報表寬度：173字元
- 每頁行數：依系統設定
- 字元編碼：ASCII

### 4.2 數值格式
- 金額顯示格式：'  ,   ,   ,  $0.  '
- 使用千分位分隔符號
- 金額靠右對齊

## 5. 注意事項

### 5.1 資料處理
- 科目代碼需依層級排序
- 金額計算需考慮借貸方向
- 餘額計算需考慮期初餘額

### 5.2 報表限制
- 最多顯示5層科目資料
- 金額欄位有固定長度限制
- 報表寬度固定為173字元

### 5.3 使用建議
- 建議在系統負載較低時執行
- 大量資料時需注意執行時間
- 定期檢查報表格式是否正確 