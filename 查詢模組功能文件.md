# 總帳系統查詢模組功能文件

## 1. 功能概述

### 1.1 功能目的
查詢模組(PCI系列)是總帳系統的重要組成部分，主要提供多維度的會計資料查詢功能，協助使用者快速取得所需的財務資訊，支援日常作業和決策分析。

### 1.2 功能範圍
- 會計科目查詢
- 分錄查詢
- 餘額查詢
- 交易明細查詢
- 統計分析查詢

### 1.3 功能特點
- 多條件組合查詢
- 即時資料顯示
- 彈性輸出格式
- 資料匯出功能
- 查詢結果排序

## 2. 功能架構

### 2.1 會計科目查詢 (PCI001)
- 功能描述：查詢會計科目基本資料
- 主要特點：
  * 支援科目代號查詢
  * 支援科目名稱查詢
  * 支援科目類別查詢
- 相關檔案：
  * GLAAPF：會計主檔
  * GLACPF：會計科目檔

### 2.2 分錄查詢 (PCI002)
- 功能描述：查詢會計分錄資料
- 主要特點：
  * 支援多條件查詢
  * 支援分錄明細顯示
  * 支援分錄狀態查詢
- 相關檔案：
  * GLAFPF：會計分錄檔
  * GLAAPF：會計主檔

### 2.3 餘額查詢 (PCI003)
- 功能描述：查詢會計科目餘額
- 主要特點：
  * 支援期間餘額查詢
  * 支援多幣別查詢
  * 支援餘額趨勢分析
- 相關檔案：
  * GLAAPF：會計主檔
  * GLABPF：會計餘額檔

### 2.4 交易明細查詢 (PCI004)
- 功能描述：查詢交易明細資料
- 主要特點：
  * 支援多維度查詢
  * 支援交易追蹤
  * 支援關聯交易查詢
- 相關檔案：
  * GLAFPF：會計分錄檔
  * GLADPF：會計明細檔

### 2.5 統計分析查詢 (PCI005)
- 功能描述：查詢統計分析資料
- 主要特點：
  * 支援多維度分析
  * 支援趨勢分析
  * 支援比較分析
- 相關檔案：
  * GLABPF：會計餘額檔
  * GLADPF：會計明細檔

## 3. 查詢參數設定

### 3.1 基本參數
- 查詢期間：年度、月份、日期範圍
- 公司代號：單一公司或多公司
- 科目範圍：科目代號範圍
- 查詢條件：多條件組合
- 輸出方式：螢幕、檔案、印表機

### 3.2 進階參數
- 查詢語言：中文、英文
- 幣別設定：本幣、外幣
- 排序方式：多欄位排序
- 過濾條件：特定交易類型、特定狀態
- 顯示欄位：自訂顯示欄位

## 4. 查詢結果控制

### 4.1 顯示控制
- 分頁顯示
- 欄位寬度調整
- 欄位排序
- 資料篩選
- 資料匯出

### 4.2 輸出控制
- 螢幕顯示
- Excel匯出
- CSV匯出
- PDF輸出
- 報表列印

## 5. 錯誤處理

### 5.1 錯誤訊息
- E001：查詢參數錯誤
- E002：資料不存在
- E003：格式錯誤
- E004：輸出錯誤

### 5.2 例外處理
- 查詢條件不符：系統提示修改
- 資料量過大：系統分批處理
- 輸出失敗：系統自動重試

## 6. 安全控制

### 6.1 權限控制
- 一般使用者：基本查詢權限
- 進階使用者：進階查詢權限
- 系統管理員：完整查詢權限

### 6.2 資料安全
- 查詢權限控制
- 資料存取控制
- 操作日誌記錄

## 7. 效能考量

### 7.1 效能指標
- 查詢回應時間：< 3秒
- 資料處理量：< 50,000筆
- 記憶體使用：< 500MB

### 7.2 優化建議
- 建立適當索引
- 優化查詢條件
- 定期維護資料

## 8. 維護說明

### 8.1 日常維護
- 查詢條件維護
- 顯示格式維護
- 輸出格式維護

### 8.2 問題處理
- 查詢錯誤：檢查參數設定
- 顯示問題：檢查顯示格式
- 輸出問題：檢查輸出設定

## 9. 版本歷史

### 9.1 版本記錄
| 版本 | 日期 | 修改內容 | 修改人 |
|-----|------|----------|--------|
| 1.0 | 2024/03/20 | 初始版本 | 系統開發組 |
| 1.1 | 2024/03/21 | 新增統計分析功能 | 系統開發組 |

### 9.2 修改記錄
- 2024/03/20：完成基本功能開發
- 2024/03/21：新增統計分析查詢功能

## 10. 螢幕布局說明

### 10.1 查詢主選單 (GLI2M0D)
```
+------------------------------------------+
|  總帳系統 - 查詢功能                     |
+------------------------------------------+
|  1. 會計科目查詢                         |
|  2. 分錄查詢                             |
|  3. 餘額查詢                             |
|  4. 交易明細查詢                         |
|  5. 統計分析查詢                         |
|  6. 查詢條件設定                         |
|  7. 查詢結果管理                         |
+------------------------------------------+
|  F3=結束  F4=提示  F12=取消              |
+------------------------------------------+
```

### 10.2 查詢條件設定畫面 (GLI2P0D)
```
+------------------------------------------+
|  查詢條件設定                            |
+------------------------------------------+
|  查詢期間: [    ] 年度 [  ] 月份         |
|  公司代號: [    ]                        |
|  科目範圍: [    ] 至 [    ]              |
|  交易類型: [    ]                        |
|  金額範圍: [    ] 至 [    ]              |
|  幣別    : [    ]                        |
|  狀態    : [    ]                        |
|  排序方式: [    ]                        |
+------------------------------------------+
|  F3=結束  F4=查詢  F12=取消              |
+------------------------------------------+
```

### 10.3 查詢結果顯示畫面 (GLI2R0D)
```
+------------------------------------------+
|  查詢結果                                |
+------------------------------------------+
|  條件: XXXX                             |
|  筆數: XXX                              |
+------------------------------------------+
|  科目  日期  摘要  借方  貸方  餘額      |
|  ----  ----  ----  ----  ----  ----      |
|  XXXX  XXXX  XXXX  XXXX  XXXX  XXXX      |
|  XXXX  XXXX  XXXX  XXXX  XXXX  XXXX      |
|  XXXX  XXXX  XXXX  XXXX  XXXX  XXXX      |
+------------------------------------------+
|  F3=結束  F4=匯出  F12=取消              |
+------------------------------------------+
```

### 10.4 會計科目查詢畫面 (GLI2A0D)
```
+------------------------------------------+
|  會計科目查詢                            |
+------------------------------------------+
|  科目代號: [    ]                        |
|  科目名稱: [                    ]        |
|  科目類別: [    ]                        |
+------------------------------------------+
|  科目代號  科目名稱  類別  狀態  餘額    |
|  --------  --------  ----  ----  ----    |
|  XXXX      XXXX      XXXX  XXXX  XXXX    |
|  XXXX      XXXX      XXXX  XXXX  XXXX    |
|  XXXX      XXXX      XXXX  XXXX  XXXX    |
+------------------------------------------+
|  F3=結束  F4=查詢  F12=取消              |
+------------------------------------------+
```

### 10.5 分錄查詢畫面 (GLI2E0D)
```
+------------------------------------------+
|  分錄查詢                                |
+------------------------------------------+
|  分錄日期: [    ] 至 [    ]              |
|  分錄號碼: [    ]                        |
|  交易類型: [    ]                        |
+------------------------------------------+
|  分錄號碼  日期  摘要  借方  貸方  狀態  |
|  --------  ----  ----  ----  ----  ----  |
|  XXXX      XXXX  XXXX  XXXX  XXXX  XXXX  |
|  XXXX      XXXX  XXXX  XXXX  XXXX  XXXX  |
|  XXXX      XXXX  XXXX  XXXX  XXXX  XXXX  |
+------------------------------------------+
|  F3=結束  F4=查詢  F12=取消              |
+------------------------------------------+
```

### 10.6 餘額查詢畫面 (GLI2B0D)
```
+------------------------------------------+
|  餘額查詢                                |
+------------------------------------------+
|  查詢期間: [    ] 年度 [  ] 月份         |
|  科目範圍: [    ] 至 [    ]              |
|  幣別    : [    ]                        |
+------------------------------------------+
|  科目代號  科目名稱  期初  借方  貸方  期末|
|  --------  --------  ----  ----  ----  ----|
|  XXXX      XXXX      XXXX  XXXX  XXXX  XXXX|
|  XXXX      XXXX      XXXX  XXXX  XXXX  XXXX|
|  XXXX      XXXX      XXXX  XXXX  XXXX  XXXX|
+------------------------------------------+
|  F3=結束  F4=查詢  F12=取消              |
+------------------------------------------+
```

### 10.7 統計分析查詢畫面 (GLI2S0D)
```
+------------------------------------------+
|  統計分析查詢                            |
+------------------------------------------+
|  分析期間: [    ] 年度 [  ] 月份         |
|  分析維度: [    ]                        |
|  比較期間: [    ] 年度 [  ] 月份         |
+------------------------------------------+
|  維度  本期金額  上期金額  差異  成長率  |
|  ----  --------  --------  ----  ----    |
|  XXXX  XXXX      XXXX      XXXX  XXXX    |
|  XXXX  XXXX      XXXX      XXXX  XXXX    |
|  XXXX  XXXX      XXXX      XXXX  XXXX    |
+------------------------------------------+
|  F3=結束  F4=查詢  F12=取消              |
+------------------------------------------+
``` 