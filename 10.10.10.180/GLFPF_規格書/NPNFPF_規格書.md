# NPNFPF 檔案規格書

## 基本資訊
- 檔案名稱: NPNFPF
- 檔案類型: 實體檔案 (PF)
- 來源目錄: QDDSSRC_GLFLIB
- 檔案說明: 支出年度和認證檔

## 紀錄格式
- 紀錄格式名稱: NF0
- 參考檔案: NPRF (參考欄位定義檔)
- 唯一性: UNIQUE (不允許重複記錄)

## 欄位規格
| 欄位名稱 | 參考欄位 | 資料型態 | 欄位說明 | 備註 |
|---------|---------|---------|---------|------|
| NF01 | AA01 | 字元 | 部門別 | 識別部門的代碼 |
| NF02 | AC02 | 數值 | 年度 | 會計年度代碼 |
| NF02A | - | 數值 | 會計期間 | 會計期間代碼 |
| NF03 | - | 字元 | 支出類別 | 支出分類的代碼 |
| NF04 | - | 字元 | 年度代號 | 特定年度的識別代碼 |
| NF05 | - | 字元 | A&P CODE | A&P費用代碼 |
| NF051 | - | 字元 | A&P CODE第一碼 | A&P費用代碼的首字 |
| NF06 | - | 字元 | 供應商代號 | 供應商的識別碼 |
| NF06A | - | 字元 | 供應商代號第一碼 | 供應商代號的首字 |
| NF07 | - | 字元 | 品項代號 | 品項的識別碼 |
| NF08 | - | 字元 | 員工代號 | 員工的識別碼 |
| NF09 | AH12 | 數值 | 核銷金額 | 核銷的金額 |
| NF10 | AH10 | 日期 | 認證日期 | 認證的處理日期 |
| NF11 | AH02 | 字元 | 認證編號 | 認證的唯一編號 |
| NF97 | AA97 | 時間戳記 | 建立時間 | 記錄建立的時間 |
| NF98 | AA98 | 日期 | 建立日期 | 記錄建立的日期 |
| NF99 | AA99 | 字元 | 建立者 | 記錄建立者的識別碼 |

## 索引資訊
檔案的索引鍵包含以下欄位:
1. NF01 (部門別)
2. NF02 (年度)
3. NF02A (會計期間)
4. NF03 (支出類別)
5. NF04 (年度代號)
6. NF05 (A&P CODE)
7. NF06 (供應商代號)
8. NF07 (品項代號)
9. NF08 (員工代號)
10. NF10 (認證日期)
11. NF11 (認證編號)

## 特殊欄位說明
1. NF01 (部門別): 
   - 識別部門的代碼，用於區分不同部門的支出記錄
   - 參照GLRF中的AA01欄位定義
   - 作為多層索引鍵的第一層

2. NF02 (年度) 和 NF02A (會計期間):
   - 會計年度代碼和期間，識別支出所屬的財務週期
   - NF02參照GLRF中的AC02欄位定義
   - NF02A指定具體的會計期間

3. NF03 (支出類別):
   - 支出分類的代碼，用於區分不同類型的支出
   - 支出類別代碼說明:
     - 10: 固定資產
     - 20: 員工福利
     - 30: 銷售費

4. NF04 (年度代號):
   - 特定年度的識別代碼
   - 年度代號99表示跨年度支出

5. NF05 (A&P CODE) 和 NF051 (A&P CODE第一碼):
   - A&P費用代碼，進一步細分支出用途
   - NF051儲存A&P CODE的第一個字元，可能用於快速分類

6. NF06 (供應商代號) 和 NF06A (供應商代號第一碼):
   - 供應商的識別碼，用於追蹤支出來源
   - NF06A儲存供應商代號的第一個字元，用於分類或快速查詢

7. NF07 (品項代號):
   - 品項的識別碼，用於記錄支出所對應的具體品項

8. NF08 (員工代號):
   - 員工的識別碼，可能用於記錄經手人或相關人員

9. NF09 (核銷金額):
   - 核銷的金額，記錄實際支出數額
   - 參照GLRF中的AH12欄位定義
   - 非索引鍵欄位

10. NF10 (認證日期) 和 NF11 (認證編號):
    - 認證的處理日期和唯一編號
    - 參照GLRF中的AH10和AH02欄位定義
    - 用於識別和追蹤認證記錄

## 檢核規則
1. 主索引鍵規則:
   - NF01 + NF02 + NF02A + NF03 + NF04 + NF05 + NF06 + NF07 + NF08 + NF10 + NF11 組合必須唯一
   - 不允許重複的支出認證記錄

2. 欄位檢核:
   - NF03 (支出類別) 必須是有效的支出類別代碼 (10, 20, 30)
   - NF09 (核銷金額) 必須是有效的數值
   - NF10 (認證日期) 必須是有效的日期格式
   - NF11 (認證編號) 必須是有效的認證編號格式

3. 關聯檢核:
   - NF01, NF02, NF03, NF04, NF05 組合應存在於NPNDPF檔案中
   - NF06 (供應商代號) 應存在於供應商主檔中
   - NF11 (認證編號) 應存在於認證主檔中

## 相關檔案
- NPRF: 參考欄位定義檔，提供欄位的詳細資料型態和長度
- GLRF: 提供參考欄位(AA01, AC02, AH10, AH02等)的定義
- NPNCPF: 支出年度代碼檔案，提供支出類別和年度的定義
- NPNDPF: 年度A&P預算與實支檔案，與此檔案的支出資訊相關
- NPNEPF: 沖銷會計憑證檔案，與此檔案的認證資訊相關

## 備註
- 本檔案規格書根據QDDSSRC_GLFLIB/NPNFPF.txt檔案內容產生
- NPNFPF是用於記錄支出年度和認證關係的檔案，是A&P系統中連接預算和實際支出的關鍵組件
- 檔案採用UNIQUE關鍵字，確保每一組支出認證記錄都是唯一的
- 檔案有11個索引鍵欄位，形成複雜但完整的多層識別系統
- 此檔案包含多個參考資訊，如部門別、支出類別、供應商、品項和員工等
- 此檔案的主要用途是追蹤A&P支出的核銷情況，並與認證系統整合
- 檔案結構設計支援詳細的支出分析，可從多個維度查詢和統計支出資訊 