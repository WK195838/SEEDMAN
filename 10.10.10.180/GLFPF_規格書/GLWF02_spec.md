# GLWF02.txt 檔案規格書

## 檔案概述
GLWF02.txt 是一個定義會計明細工作檔(GLWF02)的資料結構檔案，屬於總帳模組(GL模組)系統的一部分。該檔案用於處理會計明細資料，提供比傳票臨時存檔更詳細的明細層級資訊，是會計系統中處理明細資料的重要工作檔案。

## 檔案結構
檔案採用DDS (Data Description Specifications) 格式定義，以REF(GLRF)語句參照GLRF函式庫中的定義。其主要記錄格式為GLWF02R，包含多個與會計明細相關的欄位，並定義了多個組合鍵值(Composite Key)欄位，形成一個複雜的複合主鍵結構。

### 關鍵特性
- 檔案名稱：GLWF02
- 記錄格式：GLWF02R
- 複合主鍵：由12個欄位組成的複雜主鍵結構
- 參照檔案：GLRF (總帳模組的參照檔案)

## 欄位結構說明

GLWF02.txt 定義了一個記錄格式(GLWF02R)，其中包含以下主要欄位：

| 欄位名稱 | 參照欄位 | 標題說明 | 用途說明 |
|----------|----------|----------|----------|
| W0201    | AH01     | 公司代碼 | 識別資料所屬公司 |
| W0202    | AH04     | 會計科目 | 會計科目代碼 |
| W0203A   | AH05A    | 維度代碼1 | 明細分類用的第一個維度代碼 |
| W0204A   | AH06A    | 維度代碼2 | 明細分類用的第二個維度代碼 |
| W0205A   | AH07A    | 維度代碼3 | 明細分類用的第三個維度代碼 |
| W0206A   | AH08A    | 維度代碼4 | 明細分類用的第四個維度代碼 |
| W0207A   | AH09A    | 維度代碼5 | 明細分類用的第五個維度代碼 |
| W0203    | AH05     | 部門名稱 | 部門的名稱說明 |
| W0204    | AH06     | 成本中心 | 成本中心代碼 |
| W0205    | AH07     | 專案代號1 | 第一個專案代號 |
| W0206    | AH08     | 專案代號2 | 第二個專案代號 |
| W0207    | AH09     | 月份 | 會計月份 |
| W0208    | AH10     | 過帳日期 | 明細資料的過帳日期 |
| W0209    | AH02     | 會計年度 | 明細資料所屬會計年度 |
| W0210    | AH12     | 借方金額 | 明細的借方金額 |
| W0211    | AH13     | 貸方金額 | 明細的貸方金額 |
| W0212    | AH16     | 摘要 | 明細資料的說明摘要 |
| W0213    | AF22     | 傳票來源 | 識別明細資料的來源類型 |
| W0214    | AF06     | 傳票類型 | 明細資料的傳票類型 |
| W0216    | AF03     | 單據名稱 | 關聯單據的名稱 |
| W0217    | AH03     | 傳票編號 | 明細資料關聯的傳票編號 |
| W0218    | 1A       | 處理狀態 | 明細資料的處理狀態標記 |

### 欄位分組說明
欄位可分為以下幾個功能組：

1. **基本識別欄位**：
   - W0201 (公司代碼)
   - W0209 (會計年度)
   - W0217 (傳票編號)

2. **會計分類欄位**：
   - W0202 (會計科目)
   - W0203A-W0207A (維度代碼1-5)
   - W0203-W0207 (部門、成本中心、專案等)

3. **金額相關欄位**：
   - W0210 (借方金額)
   - W0211 (貸方金額)

4. **描述性欄位**：
   - W0212 (摘要)
   - W0216 (單據名稱)

5. **控制欄位**：
   - W0213 (傳票來源)
   - W0214 (傳票類型)
   - W0218 (處理狀態)

### 欄位參照關係
欄位主要參照兩個核心檔案的定義：
1. **會計傳票檔(GLAHPF)**：如AH01, AH02, AH03等
2. **會計憑證檔(GLAFPF)**：如AF03, AF06, AF22等

### 主鍵結構
檔案定義了12個組合鍵值，形成一個複雜的複合主鍵：
```
A          K W0202
A          K W0203A
A          K W0204A
A          K W0205A
A          K W0206A
A          K W0207A
A          K W0203
A          K W0204
A          K W0205
A          K W0206
A          K W0207
A          K W0208
```

這個複合主鍵結構涵蓋了會計科目、五個維度代碼、部門、成本中心、專案代號、月份和過帳日期，確保每筆明細資料的唯一性。

## 檔案用途

GLWF02檔案在會計系統中的主要用途包括：

1. **明細資料處理**：提供會計明細資料的處理工作區
2. **多維度分析**：支援按多個維度進行會計資料的分類和分析
3. **暫存處理結果**：作為會計處理過程中的中間結果暫存區
4. **報表生成前處理**：用於報表生成前的資料整理和準備
5. **批次處理緩衝**：在批次處理會計明細時，作為資料的緩衝區

## 與其他檔案的關聯

GLWF02與總帳模組中的其他檔案有以下關聯：

1. **直接參照關係**：
   - 參照GLRF檔案庫的定義
   - 欄位格式參照會計傳票檔(GLAHPF)和會計憑證檔(GLAFPF)的欄位定義

2. **功能關聯**：
   - 與GLWF01(傳票臨時存檔)互補，GLWF01處理傳票層級，GLWF02處理明細層級
   - 可能是GLAHPF(會計傳票檔)中資料的明細展開
   - 為GLAMPF(借貸彙總明細檔)提供處理前的資料來源

3. **資料流向**：
   - 傳票資料 → 明細展開 → GLWF02(明細工作檔) → 處理/分析 → 產生報表或更新其他檔案

## 系統中的角色

在總帳模組系統中，GLWF02作為會計明細工作檔，扮演以下角色：

1. **明細資料處理中心**：處理需要多維度分析的會計明細資料
2. **多維度分析工具**：提供按多個維度進行會計分析的基礎
3. **報表生成的資料源**：為各種會計報表提供多維度的資料來源
4. **資料轉換工作區**：在不同格式的資料轉換過程中提供工作區

## 特殊設計考量

從GLWF02的設計可以觀察到以下特殊考量：

1. **多維度支援**：
   - 設計了五個維度代碼(W0203A-W0207A)和五個對應的描述性欄位(W0203-W0207)
   - 這種設計使得會計資料可以從多個維度進行分類和分析

2. **複合主鍵設計**：
   - 使用12個欄位組成複合主鍵，確保在多維度分析中資料的唯一性
   - 包含會計科目、維度代碼、部門、成本中心等多個層面的識別欄位

3. **狀態管理**：
   - W0218欄位用於標記處理狀態，可能用於追蹤資料處理的不同階段

## 操作考量

使用GLWF02檔案時的主要操作考量：

1. **資料量和性能**：
   - 明細層級的資料量可能很大，需要考慮索引設計和查詢效率
   - 複雜的複合主鍵可能影響資料插入和更新效率

2. **維護複雜性**：
   - 多維度設計增加了資料維護的複雜性
   - 需要確保各維度代碼和描述的一致性

3. **資料同步**：
   - 需要與傳票層級資料(GLWF01/GLAHPF)保持同步
   - 各維度代碼的變更需要同步更新

## 結論

GLWF02.txt是總帳系統中重要的會計明細工作檔定義，通過支援多維度的資料結構，為會計資料的處理和分析提供了強大的彈性。它的設計反映了會計系統中對多角度分析的需求，能夠處理複雜的會計明細資料分類和匯總。理解和正確使用這個檔案對於實現會計系統中的多維度報表和分析功能至關重要。 