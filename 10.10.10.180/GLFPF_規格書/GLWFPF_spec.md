# GLWFPF 檔案規格說明

## 檔案概述
GLWFPF是總帳模組的憑證暫存檔案，用於暫時儲存會計憑證資料，作為交易處理和資料驗證的中介站。此檔案在會計憑證處理流程中扮演關鍵角色，支援憑證的錄入、驗證、處理和轉移。

## 檔案結構
- **檔案名稱**: GLWFPF
- **記錄格式**: WF00
- **描述**: 會計憑證暫存檔案
- **用途**: 提供憑證處理的暫存區，支援資料驗證和處理

## 主要功能
- 暫存會計憑證的交易資料
- 支援憑證的新增、預覽和修改操作
- 在資料正式儲存前提供驗證和檢查機制
- 作為交易資料從前端進入正式會計檔案的中介層

## 欄位結構

| 欄位名稱 | 資料類型 | 標題 | 用途說明 |
|---------|---------|------|---------|
| GF01 | 字元(2) | 公司編號 | 識別公司的代碼 |
| GF02 | 字元(1) | $/# | 幣別標識 |
| GF03 | 字元(1) | C/P/R | 處理類型標識 |
| GF04 | 字元(5) | 憑證號碼前置號 | 組成完整憑證編號的前置部分 |
| GF05Y | 字元(2) | 憑證日期（年） | 憑證記錄的年份部分 |
| GF05M | 字元(2) | 憑證日期（月） | 憑證記錄的月份部分 |
| GF05D | 字元(2) | 憑證日期（日） | 憑證記錄的日期部分 |
| GF06 | 字元(1) | ERR-HAND | 錯誤處理標識 |
| GF07 | 字元(10) | 會計科目 | 交易涉及的會計科目代碼 |
| GF08 | 字元(10) | 對方科目 | 交易涉及的對方科目代碼 |
| GF09 | 字元(1) | 借貸別 | 標識交易是借方還是貸方 |
| GF10 | 數字(15,2) | 金額 | 交易金額 |
| GF11 | 字元(1) | 對應帳 | 對應帳戶標識 |
| GF12 | 字元(9) | 對應帳號碼 | 對應帳戶的編號 |
| GF13 | 溢位(8) | 參數一 | 自定義參數字段 |
| GF14 | 溢位(8) | 參數二 | 自定義參數字段 |
| GF15 | 字元(4) | 公司 | 憑證所屬的公司代碼 |
| GF16 | 溢位(30) | 摘要 | 交易的簡短描述 |
| GF17 | 字元(1) | *BLANKS | 預留空白字段 |
| GF18 | 數字(8,0) | 輸入日 | 資料輸入的日期 |
| GF19 | 數字(8,0) | 憑證日 | 憑證的正式日期 |

## 欄位詳細說明

### GF01（公司編號）
- 固定值為"R1"
- 用於識別資料所屬的公司代碼

### GF02（$/#）
- 固定值為"$"
- 標識交易使用的幣別類型

### GF03（C/P/R）
- 處理類型標識
- "C" - 新增操作
- "P" - 預覽操作
- "R" - 修改操作

### GF04（憑證號碼前置號）
- 5位前置編號，用於組成完整的憑證編號
- 前2位：憑證產生部門代碼
- 第3-4位：子系統代碼
- 後2位：序號

### GF05Y/GF05M/GF05D（憑證日期）
- 分別儲存憑證的年、月、日
- 固定為西元年月日格式

### GF06（ERR-HAND）
- 錯誤處理標識
- 固定值為空白（" "）

### GF07（會計科目）
- 記錄交易涉及的會計科目代碼
- 與總帳科目主檔相關聯

### GF08（對方科目）
- 記錄交易涉及的對方科目代碼
- 支援複合分錄的科目對應關係

### GF09（借貸別）
- 標識交易方向
- "借" - 借方交易
- "貸" - 貸方交易

### GF10（金額）
- 15位數字，含2位小數
- 記錄交易的金額值

### GF11（對應帳）
- 是否有對應的其他帳戶
- 通常用於複雜交易的處理

### GF12（對應帳號碼）
- 對應帳戶的編號
- 當GF11啟用時使用
- 固定值為空白（" "）時表示無對應帳號

### GF13/GF14（參數一/參數二）
- 8位溢位數字欄位
- 用於儲存額外的參數資訊，如日期編碼或參考值

### GF15（公司）
- 4位公司代碼
- 憑證號碼的組成部分
- 第1位：使用者代號

### GF16（摘要）
- 30位溢位字元欄位
- 記錄交易的簡短描述或說明

### GF17（*BLANKS）
- 預留欄位，固定為空白

### GF18（輸入日）
- 8位數字，記錄資料輸入的日期
- 通常以YYYYMMDD格式儲存

### GF19（憑證日）
- 8位數字，記錄憑證的正式日期
- 通常以YYYYMMDD格式儲存
- 固定值為空白（" "）時表示尚未確認

## 索引結構
- **複合主索引**: GF04, GF15
  - 按憑證號碼前置號和公司代碼排序
  - 支援快速檢索特定憑證記錄

## 主要用途
1. **憑證暫存處理**：在正式儲存前暫存憑證資料
2. **資料驗證**：提供中介層進行資料完整性和正確性驗證
3. **操作彈性**：支援新增、預覽和修改三種操作類型
4. **審核流程**：作為審核流程的一部分，確保資料符合會計準則

## 與其他檔案的關係
- **GLAFPF（會計憑證檔）**: GLWFPF中處理完成的資料最終會轉入GLAFPF
- **GLAHPF（會計傳票檔）**: 與傳票檔案有關聯，提供憑證層級的資料
- **GLADPF（科目基準表）**: 引用科目代碼，確保使用有效的會計科目

## 操作考量
1. **資料完整性**：
   - 確保所有必填欄位都有有效值
   - 驗證借貸平衡和科目有效性

2. **處理流程**：
   - 根據GF03欄位的值執行不同的處理邏輯
   - 從預覽到正式儲存的流程管理

3. **臨時資料管理**：
   - 定期清理已處理完成的臨時資料
   - 維護適當的資料備份機制

## 資料流動
1. **資料來源**：
   - 使用者輸入 → 前端系統 → 暫存於GLWFPF
   - 其他模組提供的交易資料 → 轉換處理 → GLWFPF

2. **資料目的地**：
   - GLWFPF（驗證通過）→ GLAFPF（會計憑證檔）
   - GLWFPF（需要修改）→ 返回使用者介面

## 系統角色
GLWFPF在總帳系統中扮演交易資料臨時處理的關鍵角色。它提供了一個中介層，使得系統能夠在正式記錄交易前進行必要的驗證和處理。此檔案的設計反映了會計系統對資料完整性和準確性的高要求，確保只有經過驗證的交易資料才能進入正式的會計紀錄。 