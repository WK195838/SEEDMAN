# NPRF 檔案規格書

## 基本資訊
- 檔案名稱: NPRF
- 檔案類型: 參考欄位定義檔 (RF)
- 來源目錄: QDDSSRC_GLFLIB
- 檔案說明: A&P系統參考欄位定義檔

## 紀錄格式
- 紀錄格式名稱: NPRFR
- 參考檔案: GLRF (基礎參考欄位定義檔)

## 檔案範圍
檔案包含以下A&P系統相關檔案的欄位定義：
1. NPNAPF: A&P CODE主檔
2. NPNBPF: A&P會計憑證檔案
3. NPNCPF: 支出年度代碼檔案
4. NPNDPF: 年度A&P預算與實支檔案
5. NPNEPF: 沖銷會計憑證檔案
6. NPNFPF: 支出年度和認證檔

## 欄位分組
### 1. NPNAPF (A&P CODE主檔) 欄位
| 欄位名稱 | 參考欄位 | 資料型態 | 欄位長度 | 欄位說明 | 備註 |
|---------|---------|---------|---------|---------|------|
| NA01 | AC02 | 數值 | 4 | 年度 | 會計年度代碼 |
| NA02 | - | 字元 | 3 | A&P CODE | A&P費用代碼 |
| NA03 | - | 字元 | 30 | A&P說明 | A&P代碼的說明 |
| NA04 | - | 字元 | 1 | A&P旗標 | T=支付，D=借貸 |
| NA97 | AA97 | 時間戳記 | 6 | 建立時間 | 記錄建立的時間 |
| NA98 | AA98 | 日期 | 8 | 建立日期 | 記錄建立的日期 |
| NA99 | AA99 | 字元 | 10 | 建立者 | 記錄建立者的識別碼 |

### 2. NPNBPF (A&P會計憑證檔案) 欄位
| 欄位名稱 | 參考欄位 | 資料型態 | 欄位長度 | 欄位說明 | 備註 |
|---------|---------|---------|---------|---------|------|
| NB01 | AA01 | 字元 | 2 | 部門別 | 識別部門的代碼 |
| NB02 | AF02 | 字元 | 8 | 會計憑證 | 會計憑證的識別碼 |
| NB97 | AA97 | 時間戳記 | 6 | 建立時間 | 記錄建立的時間 |
| NB98 | AA98 | 日期 | 8 | 建立日期 | 記錄建立的日期 |
| NB99 | AA99 | 字元 | 10 | 建立者 | 記錄建立者的識別碼 |

### 3. NPNCPF (支出年度代碼檔案) 欄位
| 欄位名稱 | 資料型態 | 欄位長度 | 欄位說明 | 備註 |
|---------|---------|---------|---------|------|
| NC01 | 字元 | 2 | 支出類別 | 支出分類代碼 (10=固定資產,20=員工福利,30=銷售費,99=其他) |
| NC02 | 字元 | 2 | 年度 | 年度代碼 |
| NC97 | 時間戳記 | 6 | 建立時間 | 參照AA97 |
| NC98 | 日期 | 8 | 建立日期 | 參照AA98 |
| NC99 | 字元 | 10 | 建立者 | 參照AA99 |

### 4. NPNDPF (年度A&P預算與實支檔案) 欄位
| 欄位名稱 | 參考欄位 | 資料型態 | 欄位說明 | 備註 |
|---------|---------|---------|---------|------|
| ND01 | AA01 | 字元 | 部門別 | 識別部門的代碼 |
| ND02 | AC02 | 數值 | 年度 | 會計年度代碼 |
| ND03 | - | 字元 | 支出類別 | 支出分類代碼 (10=固定資產,20=員工福利,30=銷售費,99=其他) |
| ND04 | - | 字元 | 年度代號 | 年度代號(99=跨年度支出) |
| ND05 | - | 字元 | A&P CODE | A&P費用代碼 |
| ND051 | - | 字元 | A&P CODE第一碼 | A&P費用代碼的首字 |
| ND06B-ND18B | AH12 | 數值 | 預算金額 | 各月份和全年的預算金額 |
| ND06A-ND18A | AH12 | 數值 | 實支金額 | 各月份和全年的實際支出金額 |
| ND97 | AA97 | 時間戳記 | 建立時間 | 記錄建立的時間 |
| ND98 | AA98 | 日期 | 建立日期 | 記錄建立的日期 |
| ND99 | AA99 | 字元 | 建立者 | 記錄建立者的識別碼 |

### 5. NPNEPF (沖銷會計憑證檔案) 欄位
| 欄位名稱 | 參考欄位 | 資料型態 | 欄位長度 | 欄位說明 | 備註 |
|---------|---------|---------|---------|---------|------|
| NE01 | AA01 | 字元 | 2 | 部門別 | 識別部門的代碼 |
| NE02 | AF02 | 字元 | 8 | 會計憑證 | 會計憑證的識別碼 |
| NE97 | AA97 | 時間戳記 | 6 | 建立時間 | 記錄建立的時間 |
| NE98 | AA98 | 日期 | 8 | 建立日期 | 記錄建立的日期 |
| NE99 | AA99 | 字元 | 10 | 建立者 | 記錄建立者的識別碼 |

### 6. NPNFPF (支出年度和認證檔) 欄位
| 欄位名稱 | 參考欄位 | 資料型態 | 欄位長度 | 欄位說明 | 備註 |
|---------|---------|---------|---------|---------|------|
| NF01 | AA01 | 字元 | 2 | 部門別 | 識別部門的代碼 |
| NF02 | AC02 | 數值 | 4 | 年度 | 會計年度代碼 |
| NF02A | - | 數值 | 2 | 會計期間 | 會計期間代碼 |
| NF03 | - | 字元 | 2 | 支出類別 | 支出分類代碼 (10=固定資產,20=員工福利,30=銷售費,99=其他) |
| NF04 | - | 字元 | 2 | 年度代號 | 年度代號 |
| NF05 | - | 字元 | 3 | A&P CODE | A&P費用代碼 |
| NF051 | - | 字元 | 1 | A&P CODE第一碼 | A&P費用代碼的首字 |
| NF06 | - | 字元 | 6 | 供應商代號 | 供應商的識別碼 |
| NF06A | - | 字元 | 1 | 供應商代號第一碼 | 供應商代號的首字 |
| NF07 | - | 字元 | 5 | 品項代號 | 品項的識別碼 |
| NF08 | - | 字元 | 6 | 員工代號 | 員工的識別碼 |
| NF09 | AH12 | 數值 | - | 核銷金額 | 核銷的金額 |
| NF10 | AH10 | 日期 | - | 認證日期 | 認證的處理日期 |
| NF11 | AH02 | 字元 | - | 認證編號 | 認證的唯一編號 |
| NF97 | AA97 | 時間戳記 | 6 | 建立時間 | 記錄建立的時間 |
| NF98 | AA98 | 日期 | 8 | 建立日期 | 記錄建立的日期 |
| NF99 | AA99 | 字元 | 10 | 建立者 | 記錄建立者的識別碼 |

## 參考欄位說明
參考欄位來自以下主要來源：
1. **GLRF (基礎參考欄位定義檔)**：
   - AA01: 部門別，長度為2字元
   - AA97: 建立時間，6位時間戳記
   - AA98: 建立日期，8位日期
   - AA99: 建立者，10位字元
   - AC02: 年度，4位數值
   - AF02: 會計憑證，8位字元
   - AH02: 認證編號，來自會計認證主檔
   - AH10: 認證日期，來自會計認證主檔
   - AH12: 金額欄位，來自會計認證主檔

## 共通欄位模式
NPRF檔案中的欄位遵循以下命名模式：
1. 前綴(N)：表示A&P系統
2. 第二個字母(A-F)：對應檔案編號
3. 序號(01-99)：欄位的序號
4. 後綴(A/B)：用於區分相關欄位，如A表示實支，B表示預算

## 特殊欄位說明
1. **建立資訊欄位**:
   每個檔案都包含97-99三個欄位，用於記錄建立時間、日期和使用者資訊:
   - xx97: 建立時間 (參照AA97)
   - xx98: 建立日期 (參照AA98)
   - xx99: 建立者 (參照AA99)

2. **支出類別代碼**:
   NC01, ND03, NF03 欄位都使用相同的支出類別代碼:
   - 10: 固定資產
   - 20: 員工福利 
   - 30: 銷售費
   - 99: 其他

3. **A&P CODE相關欄位**:
   - NA02, ND05, NF05: 完整的A&P CODE
   - ND051, NF051: A&P CODE的第一個字元，用於快速分類

## 備註
- 本檔案規格書根據QDDSSRC_GLFLIB/NPRF.txt檔案內容產生
- NPRF是A&P系統中所有檔案的欄位定義參考檔
- 此檔案參考GLRF取得基礎欄位定義，延伸出A&P系統特有的欄位定義
- 此檔案是A&P系統中所有物理檔案(PF)和邏輯檔案(LF)的基礎參考
- 檔案命名模式使用N作為A&P系統的識別前綴
- 檔案提供欄位的資料型態、長度和用途定義，確保系統內資料結構的一致性 