# 應收帳款系統—主控程式規格書（ARA000）

## 一、基本資訊
- **程式名稱**：ARA000
- **作者**：未標註
- **建立日期**：1996/10/30
- **系統**：應收帳款系統
- **子系統**：主控功能
- **功能說明**：主控程式，負責主畫面初始化、條件檢查與分流至明細查詢或其他功能程式。
- **備註**：本程式為主控入口，依據輸入條件呼叫不同子程式。

## 二、檔案架構與關聯圖

### 1. 主要檔案
- **ARA000D**：顯示檔（WORKSTN，主畫面輸入與顯示）

### 2. 檔案關聯圖
```
[ARA000]───(顯示/輸入)──→[ARA000D]
   │
   ├─(條件A)──→[ARA008]
   └─(其他)───→[SOR088C]
```

## 三、檔案欄位名稱、長度屬性與檢核規則

### 1. ARA000D（顯示檔）
| 欄位名稱 | 長度 | 屬性 | 說明 | 檢核規則 |
|----------|------|------|------|----------|
| $USER    | 10   | 字串 | 使用者代碼 | 必填 |
| $EVR     | 1    | 字元 | 交易類別 | 必填，限定值 |
| $CPY     | 3    | 整數 | 複製份數 | 必填，數值 |
| $ADD     | 1    | 字元 | 操作別 | 必填，限定值 |
| $PRTID   | 2    | 字元 | 列印機代號 | 必填，限定值 |
| ...      | ...  | ...  | ...  | ... |

## 四、輸出入螢幕規格

### 1. 主畫面輸入區
- $USER（使用者代碼）、$EVR（交易類別）、$CPY（複製份數）、$ADD（操作別）、$PRTID（列印機代號）
- 支援條件輸入與功能選擇

### 2. 功能鍵
- F3：離開
- 其他：依條件呼叫不同子程式

## 五、處理流程與子程序邏輯

### 1. 主流程
1. 初始化（RTN010）：設定畫面、初始化變數
2. 主迴圈：顯示主畫面，等待使用者輸入
3. 檢查（RTN100）：依據輸入條件判斷分流
   - 若 DENT='A'，則呼叫 ARA008
   - 其他則呼叫 SOR088C
4. 結束：離開程式

### 2. 子程序邏輯與運算規則
- RTN010：初始化畫面與變數
- RTN100：檢查輸入條件，依據 DENT 值分流呼叫不同子程式

## 六、錯誤處理程序說明與訊息清冊

### 1. 錯誤處理程序
- 若輸入資料不符規則，於 RTN100 進行檢查，並可於畫面顯示錯誤訊息（需搭配顯示檔設計）
- 其他錯誤可於主程式或子程式中進行處理，並顯示對應訊息

### 2. 訊息清冊（範例）
| 訊息代碼 | 說明 |
|----------|------|
| ERR001   | 輸入資料有誤，請重新輸入 |
| ...      | ... |

## 七、其他備註
- 主控程式僅負責分流與基本檢查，實際業務邏輯於子程式（如 ARA008、SOR088C）中實作
- 欄位與功能可依需求擴充

本規格書依據 ARA000.txt 製作，完整記錄 ARA000 程式結構、檔案欄位、處理流程與錯誤處理。如需調整或有其他需求，歡迎隨時告知！ 