# 應收帳款系統—利率資料操作程式規格書（ARA003）

## 一、基本資訊
- **程式名稱**：ARA003
- **作者**：A1005 ROGER CHIEN
- **建立日期**：80/11/21
- **修改日期**：無
- **系統**：應收帳款系統
- **子系統**：應收帳款子系統
- **功能說明**：利率資料操作
- **備註**：無特殊說明

## 二、檔案架構與關聯圖

### 1. 主要檔案
- **ARA003D**：顯示檔（WORKSTN）

### 2. 檔案關聯圖
```
[ARA003]──────►[ARA003D]
```

## 三、檔案欄位名稱、長度屬性與檢核規則

### 1. 資料結構
| 結構名稱 | 欄位名稱 | 長度 | 屬性 | 說明 | 檢核規則 |
|----------|----------|------|------|------|----------|
| DA02     | CHK      | 4    | 字串 | 檢查用欄位 | - |
| DA02     | ARDA02   | 4    | 整數 | 利率值（無小數點顯示） | 需為數字 |
| -        | DDA02    | -    | 整數 | 顯示用利率（乘以100） | 計算用 |

### 2. 系統變數與設定
| 欄位名稱 | 長度 | 屬性 | 說明 | 檢核規則 |
|----------|------|------|------|----------|
| $USER    | 10   | 字串 | 使用者代碼 | - |
| $EGMDY   | 6    | 整數 | 系統日期 | - |

## 四、輸出入螢幕規格

### 1. 主畫面（DSPC1）
- 輸入/顯示區：
  - 利率輸入欄位（DDA02）：顯示已乘以100的利率值

### 2. 功能鍵
- F3：離開
- ENTER：確認

## 五、處理流程與子程序邏輯

### 1. 主流程
1. 變數定義與初始化
2. 資料預處理
   - 檢查輸入利率是否為空白，若為空白設為0
   - 將利率值乘以100用於畫面顯示
3. 畫面顯示：顯示乘以100後的利率值
4. 使用者輸入處理
   - 處理F3離開
   - 若未離開，則將輸入值除以100轉回實際利率
5. 資料輸出：將處理後的利率值輸出
6. 結束（LR）：釋放資源，結束程式

### 2. 資料處理邏輯
- **利率轉換**：
  - 輸入時：實際利率值乘以100顯示（例：2.5% 顯示為 250）
  - 輸出時：畫面輸入值除以100儲存（例：250 儲存為 2.5%）
- **預設值處理**：
  - 當CHK為空白時（初次使用），將ARDA02設為0

## 六、錯誤處理程序說明與訊息清冊

### 1. 錯誤處理程序
- 使用 `*LOCK` 指令鎖定輸入資料，防止異常修改
- 使用 `*NAMVAR` 指令定義變數，確保資料定義正確
- 程式較簡單，未設複雜錯誤處理機制

### 2. 狀態指示器
| 指示器 | 說明 |
|--------|------|
| *IN03  | F3功能鍵，用於結束程式 |
| LR     | 程式結束指示器 |

## 七、其他備註
1. 本程式主要處理利率數值的轉換與顯示
2. 使用簡單的利率轉換流程：
   - 輸入介面中顯示的利率值為實際利率的100倍，方便使用者輸入（無需輸入小數點）
   - 程式內部處理時將顯示值除以100，轉換為實際利率值
3. 使用資料結構DA02存取利率值，通過OUT指令輸出處理後的資料
4. 程式流程簡單，主要為單一畫面的資料輸入與轉換處理

本規格書依據 ARA003.txt 製作，完整記錄 ARA003 程式結構、資料欄位、處理流程與邏輯。如需調整或有其他需求，歡迎隨時告知！ 