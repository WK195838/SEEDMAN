     H****************************************************************
     H*   泛太資訊科技開發股份有限公司－版權所有    TEL:27313250   *
     H*                                                              *
     H*    PROGRAM-ID   : PYA4021                                    *
     H*    PROGRAM NAME :公司獎金核定作業　                        *
     H*    AUTHOR       : A1084 CHARLES                              *
     H*    CREATE DATE  : 79/07/17                                   *
     H*    UPDATE DATE  : 90/08/06 A1274 EVA                         *
     H*    SYSTEM       :人事薪資系統                              *
     H****************************************************************
     FPYPBPF  UP  E           K        DISK
     FPYEMPF  IF  E           K        DISK
     FPYPCPF  O   E           K        DISK                      A
     FPYDSPF  IF  E           K        DISK
     E*---------------------------------------------------------------
     E                    C1          3  1               .成本中心１
     E                    C2          3  3               .成本中心２
     E                    C3          3  1               .成本中心３
     E                    A1          3  5 2             .分攤率
     E*---------------------------------------------------------------
     I*
     I           UDS
     I                                      101 110 $USER
     I                                      211 2160DDATE
     I                                      201 2080$A8YMD
     I*
     I                                      501 502 DPB01
     I                                      505 506 DPB04
     I                                      561 5630DPB03
     I                                      606 6110WOS03
     I            DS
     I                                        1   7 PB14
     I                                        1   1 PB141
     I                                        2   2 PB142
     I                                        3   3 PB143
     I                                        4   7 PB144
     I*
     I/COPY PYDDSSRC,PYEMDS01
     C*==============================================================*
     C*                    DEFN
     C*==============================================================*
     C           *LIKE     DEFN PB06      PB06S
     C           *LIKE     DEFN PB08      PB08S
     C           *LIKE     DEFN PB09      PB09S
     C           *LIKE     DEFN PB10      PB10S
     C           *LIKE     DEFN PB11      PB11S
     C           *LIKE     DEFN PB12      PB12S
     C*==============================================================*
     C*                    KEY LIST
     C*==============================================================*
     C           KEYEM     KLIST
     C                     KFLD           PB01
     C                     KFLD           PB02
     C*==============================================================*
     C*                    MAIN ROUTINE
     C*==============================================================*
     C                     EXSR RTN100                     .成本中心
     C                     EXSR RTN200                     .成本分攤
     C*
     C*記錄當月份該員工所屬的工作地點及部門別　          *YH USE ONLY
     C*以方便分區計算及報繳所得稅
     C           KEYEM     CHAINEM0                  40
  01-C           *IN40     IFEQ '0'
    C                     MOVELEM041     PB141     P
    C                     MOVELEM042     PB142     P
    C                     MOVELEM043     PB143     P
    C                     MOVELEM044     PB144     P
    C                     MOVELEM135     PB15      P
  01*C                     ELSE
    C                     MOVEL*BLANK    PB14
    C                     MOVEL*BLANK    PB15
  01-C                     END
     C*
     C                     Z-ADD$A8YMD    PB96
     C                     Z-ADD$A8YMD    PB97
     C                     TIME           WTIME  120
     C                     MOVELWTIME     PB98
     C                     MOVEL$USER     PB99
     C*
     C                     UPDATPB0
     C*
     C*==============================================================*
     C*   RTN100... 員工基本資料 PYEMPF
     C*==============================================================*
01===C           RTN100    BEGSR
|    C*
|    C*設定成本中心
|    C                     MOVEL*BLANK    C1
|    C                     MOVEL*BLANK    C2
|    C                     MOVEL*BLANK    C2
|    C                     MOVEL*ZERO     A1
|    C                     Z-ADD*ZERO     IC      10
|    C*
|    C           KEYEM     SETLLDS0
|    C           KEYEM     READEDS0                      40
| 01-C           *IN40     DOWEQ'0'
|   C*
|   C                     ADD  1         IC
|   C                     MOVELDS041     C1,IC
|   C                     MOVELDS042     C2,IC
|   C                     MOVELDS043     C3,IC
|   C                     Z-ADDDS05      A1,IC
|   C*
|   C           KEYEM     READEDS0                      40
| 01-C                     END
|    C*
01===C                     ENDSR
     C*==============================================================*
     C*          RTN200...成本分攤
     C*==============================================================*
02===C           RTN200    BEGSR
|    C*
|    C                     MOVELPB01      PC01
|    C                     MOVELPB02      PC02
|    C                     Z-ADDPB03      PC03
|    C                     MOVELPB04      PC04
|    C                     Z-ADD$A8YMD    PC97
|    C                     TIME           WTIME  120
|    C                     MOVELWTIME     PC98
|    C                     MOVEL$USER     PC99
|    C*
|    C                     Z-ADD*ZERO     PB06S
|    C                     Z-ADD*ZERO     PB08S
|    C                     Z-ADD*ZERO     PB09S
|    C                     Z-ADD*ZERO     PB10S
|    C                     Z-ADD*ZERO     PB11S
|    C                     Z-ADD*ZERO     PB12S
|    C*
|    C                     Z-ADD1         X1      10
| 01-C           X1        DOWLEIC
|   C                     EXSR RTN210
|   C                     ADD  1         X1
| 01-C                     END
|    C*
02===C                     ENDSR
     C*==============================================================*
     C*   RTN210... 成本資料PYPCPF
     C*==============================================================*
03===C           RTN210    BEGSR
|    C*
|    C                     MOVELC1,X1     PC091
|    C                     MOVELC2,X1     PC092
|    C                     MOVELC3,X1     PC093
|    C                     Z-ADDA1,X1     PC10
|    C*
| 01-C           X1        IFEQ IC
|   C*
|   C           PB06      SUB  PB06S     PC06
|   C           PB08      SUB  PB08S     PC08
|   C           PB09      SUB  PB09S     PC11
|   C           PB10      SUB  PB10S     PC12
|   C           PB11      SUB  PB11S     PC13
|   C           PB12      SUB  PB12S     PC14
|   C*
| 01*C                     ELSE
|   C           PB06      MULT A1,X1     WAMT   197
|   C           WAMT      DIV  100       PC06      H
|   C                     ADD  PC06      PB06S
|   C*
|   C           PB08      MULT A1,X1     WAMT
|   C           WAMT      DIV  100       PC08      H
|   C                     ADD  PC08      PB08S
|   C*
|   C           PB09      MULT A1,X1     WAMT
|   C           WAMT      DIV  100       PC11      H
|   C                     ADD  PC11      PB09S
|   C*
|   C           PB10      MULT A1,X1     WAMT
|   C           WAMT      DIV  100       PC12      H
|   C                     ADD  PC12      PB10S
|   C*
|   C           PB11      MULT A1,X1     WAMT
|   C           WAMT      DIV  100       PC13      H
|   C                     ADD  PC13      PB11S
|   C*
|   C           PB12      MULT A1,X1     WAMT
|   C           WAMT      DIV  100       PC14      H
|   C                     ADD  PC14      PB12S
|   C*
| 01-C                     END
|    C*
|    C                     WRITEPC0
|    C*
03===C                     ENDSR
