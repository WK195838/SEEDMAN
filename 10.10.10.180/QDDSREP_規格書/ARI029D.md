# 應收帳款系統顯示檔規格書

## 一、基本資訊
- **顯示檔名稱**：ARI029D
- **程式名稱**：ARI029
- **作者**：AN MING HSIA
- **系統**：應收帳款系統
- **子系統**：應收帳款子系統
- **功能說明**：單一發票明細查詢
- **建立日期**：08/11/93
- **修改記錄**：
  - M001 01.12.13 MICHELLE 增加發票明細查詢功能

## 二、顯示格式

### 1. 螢幕規格
- **螢幕大小**：24行 x 80列
- **訊息位置**：第24行
- **游標位置**：D#ROW, D#COL

### 2. 功能鍵設定
- **F3**：返回前頁

### 3. 標題區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 1,2 | 程式名稱 | 'ARI029' | 高亮度 |
| 1,26 | 訊息內容 | MSGCON(030 URE9999 *LIBL/REMF) | 高亮度 |
| 1,62 | 日期標籤 | '日期:' | - |
| 1,70 | 系統日期 | $EGMDY (6Y) | EDTCDE(Y) |
| 2,2 | 程式代碼 | 'SCR001' | - |
| 2,32 | 功能標題 | '單一發票明細查詢' | 高亮度 |
| 2,62 | 時間標籤 | '時間:' | - |
| 2,70 | 系統時間 | TIME | EDTWRD('  :  :  ') |
| 3,62 | 使用者標籤 | ' USER :' | - |
| 3,70 | 使用者代碼 | $USER (10A) | 輸出(O) |

### 4. 明細列表區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 7,4 | 發票號碼 | SI02 | 輸出(O) |
| 7,16 | 客戶代碼 | SI01 | 輸出(O) |
| 7,20 | 發票日期 | DSI21 (6Y) | 輸出(O)，EDTCDE(Y) |
| 7,29 | 客戶名稱 | SI10 | 輸出(O) |
| 7,42 | 付款帳號 | SI08 | 輸出(O) |
| 7,48 | 付款銀行 | SI09 | 輸出(O) |
| 7,62 | 金額合計 | TOTAL (9) | 輸出(O)，EDTCDE(1) |
| 8,41 | 備註 | ME04 | 輸出(O) |
| 8,61 | 其他 | DSI18 (14) | 輸出(O) |

### 5. 功能說明區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 5,3 | 說明 | '發票明細、客戶、金額、帳號等查詢' | 底線(UL) |
| 22,2 | 功能說明 | '注意' | - |
| 22,10 | 功能鍵說明 | 'F3=返回前頁' | - |

### 6. 錯誤訊息區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 24,2 | 錯誤訊息 | ERR1-ERR8 (63A) | 輸出(O)，MSGID(UPT/URE/CPF)，高亮度 |
| 24,66 | 系統訊息 | MSGCON(014 UPT9999 *LIBL/PTMF) | 高亮度 |

## 三、功能說明

1. **主要功能**
   - 提供單一發票明細查詢介面
   - 支援依發票號碼、客戶、日期、金額等查詢

2. **操作流程**
   - 輸入查詢條件（如發票號碼、客戶、日期等）
   - 執行查詢

3. **資料驗證**
   - 發票號碼、客戶代碼、日期、金額等格式檢查
   - 欄位內容合理性檢查

4. **特殊處理**
   - 金額、日期格式化
   - 合計金額計算

## 四、相關檔案

1. **相關程式**
   - ARI029：單一發票明細查詢主程式

2. **訊息檔案**
   - PTMF：系統訊息檔案
   - REMF：錯誤訊息檔案

這份顯示檔規格書詳細說明了ARI029D的結構和用途。作為單一發票明細查詢的顯示介面，此檔案提供了完整的查詢、驗證與錯誤處理機制，確保系統能夠有效地查詢與管理發票明細資料。 