# 發票帳款子系統顯示檔規格書

## 一、基本資訊
- **顯示檔名稱**：ARA008D
- **程式名稱**：ARA008
- **作者**：A1092 TAYLOR
- **系統**：人事薪資系統
- **子系統**：發票帳款子系統
- **功能說明**：到期處理
- **建立日期**：81/03/25
- **更新日期**：81/04/17 (PHILIP)

## 二、修改記錄

| 修改代碼 | 日期 | 說明 |
|---------|------|------|
| M001 | 98.11.10 | MICHELLE手動修改Y2K問題 |
| M002 | 00.04.14 | 新增DUTY相關功能 |

## 三、顯示檔格式

### 1. 畫面格式總覽
- **畫面大小**：24行 x 80列
- **訊息位置**：第24行
- **資料參照庫**：*LIBL/RERF

### 2. 子檔結構 (SFLSR1)

#### 子檔欄位

| 欄位名稱 | 欄位說明 | 類型/長度 | 位置(行,列) | 屬性 |
|---------|---------|----------|------------|------|
| RRN1 | 記錄編號 | 4S 0 | - | 隱藏(H) |
| HSG16 | 標記 | 1A | - | 隱藏(H) |
| DOPT1 | 選項 | 1A | 10,2 | 輸入(B)，有效值：' '、'2'、'4' |
| SG01 | 廠商代碼 | R | 10,4 | 輸出(O)，REFFLD(RERFR/SG01) |
| DSG06 | 到期日期 | 6Y 0 | 10,8 | 輸出(O)，EDTWRD('  /  /  ') |
| SG02 | 到期金額 | R | 10,18 | 輸出(O) |
| SG09 | 到期說明 | R | 10,31 | 輸出(O) |
| SG04 | 到期狀態 | R | 10,44 | 輸出(O) |
| SG05 | 到期類型 | R | 10,50 | 輸出(O) |
| DSG10 | 到期金額 | 9Y 0 | 10,55 | 輸出(O)，EDTCDE(1) |
| SG14 | 到期備註 | R | 10,69 | 輸出(O) |
| DFLD1 | 系統代碼 | 10A | 10,71 | 輸出(O) |

### 3. 子檔控制格式 (SFLCR1)
- **子檔大小**：20筆記錄
- **每頁顯示**：10筆記錄
- **功能鍵**：
  - F3：返回主畫面
  - 滾動(ROLLUP)：下一頁

#### 顯示欄位

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 1,2 | 程式編號 | 'ARA008' | 固定顯示 |
| 1,26 | 系統標題 | MSGCON(030 URE9999) | 高亮顯示 |
| 1,62 | 日期標籤 | '日期:' | 固定顯示 |
| 1,70 | 系統日期 | $EGMDY (6Y 0) | 輸出(O)，EDTCDE(Y) |
| 2,2 | 畫面編號 | 'SCR001' | 固定顯示 |
| 2,33 | 功能標題 | '到期處理' | 高亮顯示 |
| 2,62 | 時間標籤 | '時間:' | 固定顯示 |
| 2,70 | 系統時間 | TIME | 格式'  :  :  ' |
| 3,62 | 用戶標籤 | ' USER :' | 固定顯示 |
| 3,70 | 用戶ID | $USER (10A) | 輸出(O) |
| 4,1 | 提示訊息 | '輸入作業年度:' | 固定顯示 |
| 5,5 | 功能說明2 | '2=修改到期' | 固定顯示 |
| 5,20 | 功能說明4 | '4=刪除' | 固定顯示 |
| 7,3 | 日期格式 | '(MM/DD/YY)' | 固定顯示 |
| 8,2 | 列表標題 | 'A廠商代碼  到期日期  到期金額  到期說明  到期狀態  到期類型  到期金額' | 底線(UL) |

#### 輸入欄位

| 欄位名稱 | 欄位說明 | 位置(行,列) | 長度/類型 | 屬性 | 限制/檢核 |
|---------|---------|------------|----------|------|----------|
| DBGN1 | 廠商代碼 | 9,4 | 2A | 輸入(B) | - |
| DBGN2 | 到期日期 | 9,8 | 6Y 0 | 輸入(B) | EDTCDE(Y) |
| DBGN3 | 到期金額 | 9,18 | R | 輸入(B) | REFFLD(SG02) |

### 4. 底部控制格式 (DSPC1)

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 22,2 | 功能鍵說明 | '功能 F3 =返回主畫面' | 固定顯示 |
| 24,2 | 訊息顯示 | DMSG (78A) | 高亮顯示(HI) |
| 24,66 | 系統訊息 | MSGCON(014 UPT9999) | 高亮顯示(HI) |

### 5. 底部控制格式 (DSPC2)

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 22,2 | 功能鍵說明 | '功能 F3 =返回主畫面 F12=返回前畫面' | 固定顯示 |
| 24,2 | 訊息顯示 | DMSG (78A) | 高亮顯示(HI) |
| 24,66 | 系統訊息 | MSGCON(014 UPT9999) | 高亮顯示(HI) |

### 6. 子檔結構 (SFLSR2)

#### 子檔欄位

| 欄位名稱 | 欄位說明 | 類型/長度 | 位置(行,列) | 屬性 |
|---------|---------|----------|------------|------|
| RRN2 | 記錄編號 | 4S 0 | - | 隱藏(H) |
| DOPT2 | 選項 | 1A | 12,2 | 輸入(B)，有效值：' '、'2'、'5' |
| SH03 | 到期金額 | R | 12,5 | 輸出(O) |
| SH04 | 到期金額 | R | 12,18 | 輸出(O)，EDTCDE(1) |
| SH05 | 到期金額 | R | 12,27 | 輸出(O)，EDTCDE(1) |
| DFLD2 | 到期金額 | 5Y 0 | 12,36 | 輸出(O)，EDTCDE(1) |
| DFLD3 | 到期金額 | 4Y 0 | 12,45 | 輸出(O)，EDTCDE(1) |
| DSH07 | 到期金額 | 9Y 0 | 12,55 | 輸出(O)，EDTCDE(1) |
| DS207 | 到期金額 | 9Y 0 | 12,67 | 輸出(O)，EDTCDE(1) |

### 7. 子檔控制格式 (SFLCR2)
- **子檔大小**：16筆記錄
- **每頁顯示**：8筆記錄
- **功能鍵**：
  - F3：返回主畫面
  - F4：新增資料
  - F5：查詢資料
  - F12：返回前畫面

#### 顯示欄位

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 1,2 | 程式編號 | 'ARA008' | 固定顯示 |
| 1,26 | 系統標題 | MSGCON(030 URE9999) | 高亮顯示(HI) |
| 1,62 | 日期標籤 | '日期:' | 固定顯示 |
| 1,70 | 系統日期 | $EGMDY (6Y 0) | 輸出(O)，EDTCDE(Y) |
| 2,2 | 畫面編號 | 'SCR002' | 固定顯示 |
| 2,33 | 功能標題 | '到期處理' | 高亮顯示(HI) |
| 2,62 | 時間標籤 | '時間:' | 固定顯示 |
| 2,70 | 系統時間 | TIME | 格式'  :  :  ' |
| 3,62 | 用戶標籤 | ' USER :' | 固定顯示 |
| 3,70 | 用戶ID | $USER (10A) | 輸出(O) |
| 4,7 | 廠商標籤 | '廠商:' | 固定顯示 |
| 4,15 | 廠商代碼 | SG01 (R) | 輸出(O)，REFFLD(SG0/SG01) |
| 4,18 | 廠商名稱 | #B03 (R) | 輸出(O) |
| 5,3 | 到期金額標籤 | '到期金額:' | 固定顯示 |
| 5,15 | 到期金額 | SG04 (R) | 輸出(O)，REFFLD(SG0/SG04) |
| 5,21 | 到期狀態 | SG05 (R) | 輸出(O)，REFFLD(SG0/SG05) |
| 5,26 | 到期說明 | ME04 (R) | 輸出(O) |
| 6,3 | 到期日期標籤 | '到期日期:' | 固定顯示 |
| 6,15 | 到期日期 | SG02 (R) | 輸出(O)，REFFLD(SG0/SG02) |
| 6,40 | 到期日期標籤 | '到期日期:' | 固定顯示 |
| 6,52 | 到期日期 | LSG06 (6Y 0) | 輸出(O)，EDTWRD('  /  /  ') |
| 6,64 | 日期格式 | '(MM/DD/YY)' | 固定顯示 |
| 7,3 | 到期備註標籤 | '到期備註:' | 固定顯示 |
| 7,15 | 到期備註 | SG09 (R) | 輸出(O)，REFFLD(SG0/SG09) |
| 7,40 | 到期備註標籤 | '到期備註:' | 固定顯示 |
| 7,52 | 到期備註 | LSG26 (6Y 0) | 輸出(O)，EDTWRD('  /  /  ') |
| 7,64 | 日期格式 | '(MM/DD/YY)' | 固定顯示 |
| 8,3 | 到期類型標籤 | '到期類型:' | 固定顯示 |
| 8,15 | 到期類型 | SG18 (R) | 輸出(O)，REFFLD(SG0/SG18) |
| 8,36 | 到期金額標籤 | '到期金額:' | 固定顯示 |
| 8,52 | 到期金額 | DSG10 (9Y 0) | 輸出(O)，EDTCDE(1) |
| 9,4 | 功能說明2 | '2=修改到期處理' | 固定顯示 |
| 9,22 | 功能說明5 | '5=修改到期查詢' | 固定顯示 |
| 10,18 | 標題1 | '--到期金額--' | 固定顯示 |
| 10,36 | 標題2 | '-到期金額-' | 固定顯示 |
| 11,2 | 列表標題 | 'A 到期金額    到期金額  到期金額  到期金額  到期金額  到期金額' | 底線(UL) |

## 四、功能說明

1. **主要功能**
   - 提供到期處理的主選單介面
   - 支援到期資料的新增、修改、刪除和查詢功能
   - 管理不同廠商的到期資料
   - 提供到期狀態追蹤功能

2. **操作流程**
   - 主畫面顯示已有的到期資料清單
   - 使用者可輸入廠商代碼和到期日期進行篩選
   - 針對清單中的記錄，可選擇修改(2)或刪除(4)
   - 選擇功能後進入詳細資料畫面

3. **資料檢核**
   - 廠商代碼必須存在
   - 到期日期必須符合格式要求
   - 到期金額必須為有效數值
   - 日期格式必須符合MM/DD/YY格式

4. **特殊處理**
   - 使用者權限控制：不同欄位根據功能模式有不同的顯示屬性
   - 資料格式控制：金額使用EDTCDE(1)進行格式化
   - 日期格式控制：使用EDTWRD('  /  /  ')進行格式化
   - 欄位屬性控制：根據不同條件設定不同的顯示屬性(PC、RI、UL、PR等)

## 五、錯誤處理

系統提供多種錯誤訊息處理，包括：
- UPT 2150：資料輸入錯誤
- UPT 2142：資料格式錯誤
- UPT 2050：資料不存在
- UPT 0010：需要輸入
- UPT 2010：資料已存在
- UPT 2020：資料庫檢核錯誤
- UPT 0040：日期格式錯誤
- UPT 0030：必填欄位
- URE 0063：系統錯誤
- URE 0026：系統錯誤
- URE 0123：系統錯誤
- URE 0025：系統錯誤
- URE 0102：系統錯誤

## 六、相關檔案

1. **參照檔案**
   - RERF：欄位參照檔案
   - SOSGPF：系統參照檔案

2. **訊息檔案**
   - REMF：系統訊息檔
   - PTMF：程式訊息檔

3. **相關程式**
   - ARA008：到期處理主程式

這份顯示檔規格書詳細說明了ARA008D的結構和用途。作為到期處理的主選單介面，此檔案提供了完整的資料維護功能，包括資料的新增、修改、刪除和查詢。透過清晰的畫面規劃和完善的資料檢核機制，確保系統能夠有效地管理各廠商的到期資料。 