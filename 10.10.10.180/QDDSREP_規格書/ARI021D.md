# 應收帳款系統顯示檔規格書

## 一、基本資訊
- **顯示檔名稱**：ARI021D
- **程式名稱**：ARI021
- **作者**：A1139 JANE
- **系統**：應收帳款系統
- **子系統**：應收帳款子系統
- **功能說明**：發票明細查詢 (I)
- **建立日期**：81/03/25
- **修改記錄**：
  - M004 00.10.16 MICHELLE 應收帳款功能擴充
  - M005 01.01.12 MICHELLE 幣別功能擴充

## 二、顯示格式

### 1. 螢幕規格
- **螢幕大小**：24行 x 80列
- **訊息位置**：第24行
- **游標位置**：D#ROW, D#COL

### 2. 功能鍵設定
- **F1**：新增明細
- **F3**：返回前頁
- **F12**：返回主選單

### 3. 標題區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 1,2 | 程式名稱 | 'ARI021' | 高亮度 |
| 1,26 | 訊息內容 | MSGCON(030 URE9999 *LIBL/REMF) | 高亮度 |
| 1,62 | 日期標籤 | '日期:' | - |
| 1,70 | 系統日期 | $EGMDY (6Y) | EDTCDE(Y) |
| 2,2 | 程式代碼 | 'SCR001' | - |
| 2,29 | 功能標題 | '發票明細查詢[批次付款]' | 高亮度 |
| 2,62 | 時間標籤 | '時間:' | - |
| 2,70 | 系統時間 | TIME | EDTWRD('  :  :  ') |
| 3,62 | 使用者標籤 | ' USER :' | - |
| 3,70 | 使用者代碼 | $USER (10A) | 輸出(O) |

### 4. 輸入區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 4,2 | 客戶代碼標籤 | '客戶代碼:' | - |
| 4,14 | 客戶代碼 | SI01 | 輸出(O) |
| 4,17 | 客戶代碼後綴 | D#B03 | 輸出(O) |
| 4,39 | 付款帳號標籤 | '付款帳號:' | - |
| 4,52 | 付款帳號 | SI08 | 輸出(O) |
| 4,58 | 付款銀行 | SI09 | 輸出(O) |
| 5,2 | 發票號碼標籤 | '發票號碼:' | - |
| 5,14 | 發票號碼 | SI02 | 輸出(O) |
| 5,52 | 客戶名稱 | ME04 | 輸出(O) |
| 6,2 | 幣別標籤 | '幣別:' | - |
| 6,14 | 幣別 | SI25 | 輸出(O)，EDTCDE(J) |
| 6,39 | 發票日期標籤 | '發票日期:' | - |
| 6,52 | 發票日期 | DSI21 (6Y) | 輸出(O)，EDTWRD('  /  /  ') |
| 7,2 | 到期日標籤 | '到期日:' | - |
| 7,14 | 到期日 | SI27 | 輸出(O)，EDTCDE(1) |
| 7,39 | 票據到期日標籤 | '票據到期日:' | - |
| 7,52 | 票據到期日 | SI11 | 輸出(O) |
| 8,2 | 付款方式標籤 | '付款方式:' | - |
| 8,14 | 付款方式 | SI12 | 輸出(O) |
| 8,39 | 實收金額標籤 | '實收金額:' | - |
| 8,52 | 實收金額 | SI30 | 輸出(O)，EDTCDE(J) |
| 9,2 | 確認日期標籤 | '確認日期:' | - |
| 9,15 | 確認日期 | DSI35 (6Y) | 輸出(O)，EDTWRD('  /  /  ') |

### 5. 列表區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 9,2 | 功能選項 | DOPT1 (1A) | 輸入(B)，VALUES(' ' '5' '6') |
| 9,4 | 付款方式 | SI12 | 輸出(O) |
| 9,10 | 幣別 | SI13 | 輸出(O) |
| 9,15 | 發票日期 | DSI21 (6Y) | 輸出(O)，EDTCDE(Y) |
| 9,24 | 發票號碼 | SI02 | 輸出(O) |
| 9,35 | 客戶名稱 | SI10 | 輸出(O) |
| 9,49 | 幣別 | SI25 | 輸出(O)，EDTCDE(L) |
| 9,60 | 金額 | DTOT (9Y) | 輸出(O)，EDTCDE(3) |
| 9,71 | 實收金額 | SI30 | 輸出(O)，EDTCDE(L) |

### 6. 明細區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 12,3 | 產品編號 | SJ03 | 輸出(O) |
| 12,14 | 產品名稱 | D#A | 輸出(O)，EDTCDE(3) |
| 12,22 | 數量 | SJ13 (4Y) | 輸出(O)，EDTCDE(1) |
| 12,28 | 單價 | PRICE (9,2) | 輸出(O)，EDTCDE(3) |
| 12,39 | 幣別 | DSJ06 (9) | 輸出(O)，EDTCDE(3) |
| 12,50 | 金額 | SJ14 (5Y) | 輸出(O)，EDTCDE(1) |
| 12,61 | 稅額 | SJ15 (4Y) | 輸出(O)，EDTCDE(1) |
| 12,67 | 票據金額 | SJ09 | 輸出(O)，EDTCDE(1) |
| 13,2 | 付款方式 | MA03 | 輸出(O) |

### 7. 功能說明區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 5,5 | 功能鍵說明 | '5=明細查詢' | - |
| 5,21 | 功能鍵說明 | '6=刪除明細' | - |
| 22,2 | 功能說明 | '注意' | - |
| 22,10 | 功能鍵說明 | 'F3 =返回前頁' | - |
| 22,66 | 系統訊息 | MSGCON(014 UPT9999 *LIBL/PTMF) | 高亮度 |

### 8. 錯誤訊息區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 24,2 | 錯誤訊息 | DMSG (78A) | 輸出(O)，高亮度 |
| 24,2 | 錯誤訊息1-10 | ERR1-ERR10 (63A) | 輸出(O)，MSGID(UPT/URE/CPF)，高亮度 |
| 24,66 | 系統訊息 | MSGCON(014 UPT9999 *LIBL/PTMF) | 高亮度 |

## 三、功能說明

1. **主要功能**
   - 提供發票明細查詢與維護介面
   - 支援明細查詢、刪除、資料維護
   - 處理發票明細相關操作

2. **操作流程**
   - 選擇功能選項（查詢/刪除）
   - 輸入或查詢發票明細資料
   - 執行明細查詢或刪除

3. **資料驗證**
   - 客戶代碼、發票號碼、日期、金額、幣別等格式檢查
   - 狀態、備註等合理性檢查

4. **特殊處理**
   - 日期格式轉換
   - 金額格式化
   - 幣別與匯率換算
   - Duty與Y2K功能處理

## 四、相關檔案

1. **相關程式**
   - ARI021：發票明細查詢主程式

2. **訊息檔案**
   - PTMF：系統訊息檔案
   - REMF：錯誤訊息檔案

這份顯示檔規格書詳細說明了ARI021D的結構和用途。作為發票明細查詢的顯示介面，此檔案提供了完整的明細查詢、維護與錯誤處理機制，確保系統能夠有效地查詢與維護發票明細。 