# 應收帳款系統—票據分批收款明細查詢顯示檔規格書（ARR066D）

## 一、基本資訊
- **顯示檔名稱**：ARR066D
- **程式名稱**：ARR066
- **作者**：AN MING HSIA
- **系統**：應收帳款系統
- **子系統**：票據分批收款明細
- **功能說明**：票據分批收款明細查詢
- **建立日期**：81/12/24
- **備註**：Y2K MODIFY (98.12.23 by MICHELLE)

## 二、顯示格式

### 1. 螢幕規格
- **螢幕大小**：24行 x 80列
- **訊息位置**：第24行
- **游標位置**：D#ROW, D#COL
- **列印功能**：支援

### 2. 功能鍵設定
- **F3**：返回前頁（CA03）
- **F4**：說明/HELP（CF04）

### 3. 標題區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 1,2 | 程式名稱 | 'ARR066' | 高亮度 |
| 1,26 | 訊息內容 | MSGCON(030 URE9999 *LIBL/REMF) | 高亮度 |
| 1,62 | 日期標籤 | '日期:' | - |
| 1,70 | 系統日期 | $EGMDY (6Y) | EDTCDE(Y) |
| 2,2 | 程式代碼 | 'SCR001' | - |
| 2,32 | 畫面標題 | '票據分批收款明細查詢' | 高亮度 |
| 2,62 | 時間標籤 | '時間:' | - |
| 2,70 | 系統時間 | TIME | EDTWRD('  :  :  ') |
| 3,62 | 使用者標籤 | 'USER :' | - |
| 3,70 | 使用者代碼 | $USER (10A) | 輸出(O) |

### 4. 輸入區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 5,28 | 區分別 | COMP (1A) | VALUES(' ' '1' '2' '3')，1=本地 2=外幣 3=全部，空白=全部 |
| 7,28 | 票據號碼起 | DSI08S (參照SI08) | 必填，反白 |
| 7,46 | 票據號碼迄 | DSI08E (參照SI08) | 必填，反白 |
| 8,28 | 客戶代號起 | DSI31S (參照SI31) | 必填，反白 |
| 8,48 | 客戶代號迄 | DSI31E (參照SI31) | 必填，反白 |
| 9,40 | 發票日期起 | DSI21S (6,0) | 必填，反白，EDTWRD('  /  /  ')，(MM/DD/YY) |
| 9,51 | 發票日期迄 | DSI21E (6,0) | 必填，反白，EDTWRD('  /  /  ')，(MM/DD/YY) |
| 10,40 | 匯出金額 | DSORT (4Y) | 必填，反白，EDTCDE(Z)，RANGE(0 9999) |
| 12,41 | 明細類別 | DSEL (1A) | VALUES('A','B')，A-本票分批 B-支票分批 |

### 5. 功能說明區
| 位置(行,列) | 說明 | 特性 |
|------------|------|------|
| 20,29 | '***請輸入查詢條件後按Enter***' | 高亮度 |
| 22,2 | '注意' | - |
| 22,10 | 'F3 =返回前頁' | - |
| 22,26 | 'F4 =說明/HELP' | - |

### 6. 錯誤訊息區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 24,2 | 錯誤訊息1 | ERR1 (50A) | 輸出(O)，MSGID(UPT 2140 PTMF)，高亮度 |
| 24,2 | 錯誤訊息2 | ERR2 (50A) | 輸出(O)，MSGID(UPT 2110 PTMF)，高亮度 |
| 24,2 | 錯誤訊息3 | ERR3 (50A) | 輸出(O)，MSGID(UPT 2150 PTMF)，高亮度 |
| 24,2 | 錯誤訊息4 | ERR4 (50A) | 輸出(O)，MSGID(UPT 0010 PTMF)，高亮度 |
| 24,2 | 錯誤訊息5 | ERR5 (50A) | 輸出(O)，MSGID(UPT 2010 PTMF)，高亮度 |
| 24,2 | 錯誤訊息6 | ERR6 (50A) | 輸出(O)，MSGID(UPT 0040 PTMF)，高亮度 |
| 24,2 | 錯誤訊息7 | ERR7 (50A) | 輸出(O)，MSGID(UPT 1011 PTMF)，高亮度 |
| 24,2 | 錯誤訊息10 | ERR10 (50A) | 輸出(O)，MSGID(UPT 0041 PTMF)，高亮度 |
| 24,2 | 錯誤訊息11 | ERR11 (50A) | 輸出(O)，MSGID(UPT 0011 PTMF)，高亮度 |
| 24,2 | 錯誤訊息8 | ERR8 (63A) | 輸出(O)，MSGID(URE 0051 REMF)，高亮度 |
| 24,66 | 系統訊息 | MSGCON(014 UPT9999 *LIBL/PTMF) | 高亮度 |

## 三、功能說明
1. 提供票據分批收款明細查詢及列印作業。
2. 支援多條件查詢（區分別、票據號碼、客戶代號、發票日期、匯出金額、明細類別等）。
3. 支援查詢結果列印與多份數設定。

## 四、資料驗證
- 各欄位格式、範圍、必填性檢查。
- 區分別、票據號碼、客戶代號、發票日期、匯出金額、明細類別等選項有效性。

## 五、相關檔案
- **主程式**：ARR066
- **參考欄位定義檔**：RERF
- **訊息檔案**：PTMF（系統訊息）、REMF（錯誤訊息）

本規格書已依據 ARR066D.txt 製作，完整記錄 ARR066D 顯示檔結構與用途。如需調整或有其他需求，歡迎隨時告知！ 