# 發票帳款子系統顯示檔規格書

## 一、基本資訊
- **顯示檔名稱**：ARA010D
- **程式名稱**：ARA010
- **作者**：A1118 PHILIP
- **系統**：人事薪資系統
- **子系統**：發票帳款子系統
- **功能說明**：統一發票到期查詢
- **建立日期**：81/04/27

## 二、顯示格式

### 1. 螢幕規格
- **螢幕大小**：24行 x 80列
- **訊息位置**：第24行
- **資料參照庫**：*LIBL/RERF
- **游標位置**：D#ROW, D#COL

### 2. 功能鍵設定
- **F3**：返回前頁
- **F4**：查詢說明

### 3. 標題區

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 1,2 | 程式名稱 | 'ARA010' | 高亮度 |
| 1,26 | 系統標題 | MSGCON(030 URE9999 *LIBL/REMF) | 高亮度 |
| 1,62 | 日期標籤 | '日期:' | - |
| 1,70 | 系統日期 | $EGMDY (6Y 0) | 輸出(O)，EDTCDE(Y) |
| 2,2 | 畫面編號 | 'SCR001' | - |
| 2,62 | 時間標籤 | '時間:' | - |
| 2,70 | 系統時間 | TIME | EDTWRD('  :  :  ') |
| 3,62 | 使用者標籤 | 'USER :' | - |
| 3,70 | 使用者代碼 | $USER (10A) | 輸出(O) |

### 4. 輸入區

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 6,26 | 廠商代碼標籤 | '廠商代碼:' | - |
| 6,41 | 廠商代碼 | DSI01 (R) | 輸入(B)，REFFLD(SI01)，DSPATR(RI)，DSPATR(PC) |
| 8,26 | 到期月份標籤 | '到期月份:' | - |
| 8,41 | 到期月份 | DSI21S (4Y 0) | 輸入(B)，EDTWRD('  /  ')，DSPATR(RI)，DSPATR(PC) |
| 8,49 | 日期格式 | '(MM/YY)' | - |

### 5. 選項區

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 16,26 | 列印選項標籤 | '列印選項:' | - |
| 16,38 | 列印選項 | $EVR (1Y 0) | 輸入(B)，VALUES(1 2)，EDTCDE(3)，CHECK(RB) |
| 16,43 | 選項說明 | '(1-列印   2-不列印)' | - |
| 17,26 | 每頁筆數標籤 | '每頁筆數:' | - |
| 17,38 | 每頁筆數 | $CPY (3Y 0) | 輸入(B)，EDTCDE(3)，CHECK(RB) |
| 18,26 | 每行筆數標籤 | '每行筆數:' | 高亮度 |
| 18,38 | 每行筆數 | $PRTID (2Y 0) | 輸入(B)，高亮度，CHECK(RB)，EDTCDE(3) |

### 6. 功能說明區

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 20,31 | 功能說明 | '***請選擇列印選項***' | 高亮度 |
| 22,2 | 功能鍵說明 | '功能' | - |
| 22,10 | F3說明 | 'F3 =返回前頁' | - |
| 22,26 | F4說明 | 'F4 =查詢說明' | - |

### 7. 訊息區

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 24,2 | 錯誤訊息1 | ERR1 (50A) | 輸出(O)，MSGID(UPT 2142 PTMF)，高亮度 |
| 24,2 | 錯誤訊息2 | ERR2 (50A) | 輸出(O)，MSGID(UPT 2142 PTMF)，高亮度 |
| 24,2 | 錯誤訊息3 | ERR3 (50A) | 輸出(O)，MSGID(UPT 0010 PTMF)，高亮度 |
| 24,2 | 錯誤訊息4 | ERR4 (50A) | 輸出(O)，MSGID(UPT 2010 PTMF)，高亮度 |
| 24,2 | 錯誤訊息5 | ERR5 (50A) | 輸出(O)，MSGID(UPT 0040 PTMF)，高亮度 |
| 24,2 | 錯誤訊息6 | ERR6 (50A) | 輸出(O)，MSGID(UPT 1011 PTMF)，高亮度 |
| 24,2 | 錯誤訊息7 | ERR7 (50A) | 輸出(O)，MSGID(UPT 0041 PTMF)，高亮度 |
| 24,2 | 錯誤訊息10 | ERR10 (50A) | 輸出(O)，MSGID(UPT 2150 PTMF)，高亮度 |
| 24,2 | 錯誤訊息11 | ERR11 (50A) | 輸出(O)，MSGID(URE 0131 REMF)，高亮度 |
| 24,66 | 系統訊息 | MSGCON(014 UPT9999 *LIBL/PTMF) | 高亮度 |

## 三、功能說明

1. **主要功能**
   - 提供統一發票到期查詢功能
   - 支援列印選項設定
   - 提供查詢說明功能

2. **操作流程**
   - 輸入廠商代碼
   - 輸入到期月份
   - 選擇列印選項
   - 設定每頁筆數
   - 設定每行筆數
   - 執行查詢或列印

3. **資料驗證**
   - 廠商代碼必填
   - 到期月份格式檢查
   - 列印選項值域檢查
   - 每頁筆數必填
   - 每行筆數必填

4. **特殊處理**
   - 日期格式化處理
   - 時間格式化處理
   - 錯誤訊息顯示處理

## 四、錯誤處理

| 錯誤代碼 | 錯誤訊息 | 說明 |
|---------|---------|------|
| UPT 2142 | 錯誤訊息1 | 系統錯誤訊息1 |
| UPT 2142 | 錯誤訊息2 | 系統錯誤訊息2 |
| UPT 0010 | 錯誤訊息3 | 系統錯誤訊息3 |
| UPT 2010 | 錯誤訊息4 | 系統錯誤訊息4 |
| UPT 0040 | 錯誤訊息5 | 系統錯誤訊息5 |
| UPT 1011 | 錯誤訊息6 | 系統錯誤訊息6 |
| UPT 0041 | 錯誤訊息7 | 系統錯誤訊息7 |
| UPT 2150 | 錯誤訊息10 | 系統錯誤訊息10 |
| URE 0131 | 錯誤訊息11 | 系統錯誤訊息11 |

## 五、相關檔案

1. **參照檔案**
   - RERF：欄位參照檔案

2. **訊息檔案**
   - REMF：系統訊息檔
   - PTMF：程式訊息檔

3. **相關程式**
   - ARA010：統一發票到期查詢主程式

這份顯示檔規格書詳細說明了ARA010D的結構和用途。作為統一發票到期查詢的顯示介面，此檔案提供了完整的查詢功能和列印選項設定，確保系統能夠有效地處理統一發票到期查詢的需求。 