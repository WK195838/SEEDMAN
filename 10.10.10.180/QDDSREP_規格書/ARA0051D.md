# 發票帳款子系統顯示檔規格書

## 一、基本資訊
- **顯示檔名稱**：ARA0051D
- **程式名稱**：ARA005
- **作者**：A1087 JOYCE
- **系統**：發票帳款系統
- **子系統**：發票帳款子系統
- **功能說明**：入帳處理和入帳查詢
- **建立日期**：81/03/26
- **修改記錄**：
  - M001 | 98.11.09 | MICHELLE手動修改Y2K問題
  - M004 | 00.10.16 | 新增幣別功能

## 二、顯示格式

### 1. 螢幕規格
- **螢幕大小**：24行 x 80列
- **訊息位置**：第24行
- **游標位置**：D#ROW, D#COL

### 2. 功能鍵設定
- **F3**：返回前頁
- **F5**：入帳處理
- **F12**：返回主選單

### 3. 標題區

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 1,2 | 程式名稱 | 'ARA005' | 高亮度 |
| 1,26 | 訊息內容 | MSGCON(030 URE9999 *LIBL/REMF) | 高亮度 |
| 1,62 | 日期標籤 | '日期:' | - |
| 1,70 | 系統日期 | $EGMDY (6Y) | EDTCDE(Y) |
| 2,2 | 程式代碼 | 'SCR003' | - |
| 2,35 | 功能標題 | '入帳處理' | 高亮度 |
| 2,62 | 時間標籤 | '時間:' | - |
| 2,70 | 系統時間 | TIME | EDTWRD('  :  :  ') |
| 3,62 | 使用者標籤 | ' USER :' | - |
| 3,70 | 使用者代碼 | $USER (10A) | 輸出(O) |

### 4. 輸入區

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 4,2 | 發票號碼標籤 | '發票號碼:' | - |
| 4,14 | 發票號碼 | AC01 | 輸出(O) |
| 4,17 | 發票號碼後綴 | #B03 | 輸出(O) |
| 4,39 | 廠商代碼標籤 | '廠商代碼:' | - |
| 4,51 | 廠商代碼 | AC02 | 輸出(O) |
| 4,57 | 廠商名稱 | AC03 | 輸出(O) |
| 4,62 | 廠商簡稱 | ME04 | 輸出(O) |
| 5,2 | 發票日期標籤 | '發票日期:' | - |
| 5,14 | 發票日期 | DAC04 (6Y) | 輸出(O)，EDTWRD('  /  /  ') |
| 5,39 | 發票幣別標籤 | '發票幣別:' | - |
| 5,51 | 發票幣別 | AC05 | 輸出(O) |
| 5,54 | 幣別類型 | MTYPE (6A) | 輸出(O) |
| 6,2 | 到期幣別標籤 | '到期幣別:' | - |
| 6,14 | 到期幣別 | AC08 | 輸出(O)，EDTCDE(1) |
| 6,37 | 到期金額標籤 | '到期金額:' | - |
| 6,51 | 到期金額 | AC10 | 輸出(O)，EDTCDE(J) |
| 7,2 | 到期日期標籤 | '到期日期:' | - |
| 7,14 | 到期日期 | AC06 | 輸出(O) |
| 7,39 | 入帳日期標籤 | '入帳日期:' | - |
| 7,51 | 入帳日期 | DAC07 (6Y) | 輸出(O)，EDTWRD('  /  /  ') |

### 5. 列表區

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 13,2 | 功能選項 | DOPT1 (1A) | 輸入(B)，VALUES(' ' '5' '6' '7') |
| 13,4 | 發票號碼 | DSI21 (6) | 輸出(O) |
| 13,13 | 廠商代碼 | SI02 | 輸出(O) |
| 13,24 | 廠商名稱 | SI11 | 輸出(O) |
| 13,37 | 幣別 | SI25 | 輸出(O)，EDTCDE(L) |
| 13,48 | 幣別 | SI30 | 輸出(O)，EDTCDE(L) |
| 13,60 | 入帳日期 | DAD08 | 輸入(B)，EDTCDE(3) |
| 13,72 | 入帳金額 | DAD12 (6) | 輸入(B)，EDTCDE(4) |

### 6. 功能說明區

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 22,2 | 功能說明 | '注意' | - |
| 22,10 | 功能鍵說明 | 'F3 =返回前頁' | - |
| 22,26 | 功能鍵說明 | 'F5=入帳處理' | - |
| 22,45 | 功能鍵說明 | 'F12=返回主選單' | - |

### 7. 錯誤訊息區

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 24,2 | 錯誤訊息 | DMSG (78A) | 輸出(O)，高亮度 |
| 24,2 | 錯誤訊息1-12 | ERR1-ERR12 (63A) | 輸出(O)，MSGID(UPT/URE)，高亮度 |

## 三、功能說明

1. **主要功能**
   - 提供入帳處理介面
   - 支援入帳資料查詢
   - 處理入帳相關操作

2. **操作流程**
   - 選擇功能選項（查詢/處理）
   - 輸入入帳資料
   - 執行入帳處理

3. **資料驗證**
   - 發票號碼格式檢查
   - 日期格式檢查
   - 金額格式檢查
   - 幣別檢查

4. **特殊處理**
   - 日期格式轉換
   - 金額格式化
   - 幣別轉換
   - Y2K問題處理

## 四、相關檔案

1. **相關程式**
   - ARA005：入帳處理主程式

2. **訊息檔案**
   - PTMF：系統訊息檔案
   - REMF：錯誤訊息檔案

這份顯示檔規格書詳細說明了ARA0051D的結構和用途。作為入帳處理的顯示介面，此檔案提供了完整的入帳資料處理和查詢機制，確保系統能夠有效地處理發票入帳相關的操作。 