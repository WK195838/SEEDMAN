# 發票帳款子系統顯示檔規格書

## 一、基本資訊
- **顯示檔名稱**：ARA016D
- **程式名稱**：ARA016
- **作者**：TINA
- **系統**：人事薪資系統
- **子系統**：發票帳款子系統
- **功能說明**：統一發票到期處理選單 (A/U/D/I)
- **建立日期**：1982/08/25
- **修改記錄**：
  - M001 | 98.11.17 | MANUAL MODIFY BY MICHELLE FOR Y2K
  - M004 | 00.05.04 | 新增欄位，修改欄位

## 二、顯示格式

### 1. 螢幕規格
- **螢幕大小**：24行 x 80列
- **訊息位置**：第24行
- **資料參照庫**：*LIBL/RERF
- **游標位置**：D#ROW, D#COL

### 2. 功能鍵設定
- **F3**：返回前頁
- **F4**：新增資料
- **F5**：修改資料
- **F6**：新增資料
- **F12**：返回主選單

### 3. 標題區

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 1,2 | 程式名稱 | 'ARA016' | 高亮度 |
| 1,26 | 系統標題 | MSGCON(030 URE9999 *LIBL/REMF) | 高亮度 |
| 1,62 | 日期標籤 | '日期:' | - |
| 1,70 | 系統日期 | $EGMDY (6Y 0) | 輸出(O)，EDTCDE(Y) |
| 2,2 | 畫面編號 | 'SCR001' | - |
| 2,30 | 功能標題 | '統一發票到期處理選單' | 高亮度 |
| 2,62 | 時間標籤 | '時間:' | - |
| 2,70 | 系統時間 | TIME | EDTWRD('  :  :  ') |
| 3,62 | 使用者標籤 | 'USER :' | - |
| 3,70 | 使用者代碼 | $USER (10A) | 輸出(O) |

### 4. 選單區

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 5,1 | 選單標題 | '輸入選單代號:' | - |
| 6,6 | 選項1 | '2=修改' | - |
| 6,16 | 選項2 | '4=刪除' | - |
| 6,26 | 選項3 | '5=查詢' | - |
| 6,36 | 選項4 | '6=新增查詢' | - |
| 7,3 | 欄位標題 | '選項' | - |
| 7,74 | 欄位標題 | '備註' | - |
| 8,3 | 欄位說明 | '廠商代號 廠商名稱 到期日期 到期金額 幣別 匯率 金額' | 底線 |

### 5. 輸入區

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 9,5 | 選項 | DOPT1 (1A) | 輸入(B)，DSPATR(PC RI)，VALUES(' ' '2' '4' '5' '6') |
| 9,5 | 廠商代號 | SS01 | 輸出(O) |
| 9,8 | 到期日期 | DSS21 (6Y 0) | 輸出(O)，EDTCDE(Y) |
| 9,19 | 廠商名稱 | SS08 | 輸出(O) |
| 9,37 | 到期金額 | SS02 | 輸出(O) |
| 9,48 | 幣別 | SS27 | 輸出(O)，EDTCDE(1) |
| 9,63 | 匯率 | SS28 | 輸出(O)，EDTCDE(1) |
| 9,76 | 備註 | SS20 | 輸出(O) |
| 9,78 | 狀態 | SS36 | 輸出(O) |
| 10,8 | 到期日期 | DSS22 (6Y 0) | 輸出(O)，EDTCDE(Y) |
| 10,18 | 廠商名稱 | ME04 | 輸出(O) |
| 10,37 | 到期金額 | SS04 | 輸出(O) |
| 10,48 | 幣別 | SS25 | 輸出(O)，EDTCDE(1) |
| 10,63 | 匯率 | SS26 | 輸出(O)，EDTCDE(1) |

### 6. 功能說明區

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 22,2 | 功能鍵說明 | '功能' | - |
| 22,10 | F3說明 | 'F3 =返回前頁' | - |
| 22,26 | F6說明 | 'F6 =新增' | - |

### 7. 訊息區

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 24,2 | 錯誤訊息0 | ERR0 (63A) | 輸出(O)，MSGID(CPF 5203 PTMF)，高亮度 |
| 24,2 | 系統訊息 | DMSG (78A) | 輸出(O)，高亮度 |
| 24,2 | 錯誤訊息1-14 | ERR1-ERR14 (63A) | 輸出(O)，MSGID(UPT/URE)，高亮度 |
| 24,66 | 系統訊息 | MSGCON(014 UPT9999 *LIBL/PTMF) | 高亮度 |

## 三、功能說明

1. **主要功能**
   - 提供統一發票到期處理選單功能
   - 支援新增、修改、刪除、查詢操作
   - 提供資料維護介面

2. **操作流程**
   - 選擇功能選項
   - 輸入相關資料
   - 執行資料處理

3. **資料驗證**
   - 選項值檢查
   - 日期格式檢查
   - 金額格式檢查

4. **特殊處理**
   - 日期格式化處理
   - 金額格式化處理
   - 錯誤訊息顯示處理

## 四、錯誤處理

| 錯誤代碼 | 錯誤訊息 | 說明 |
|---------|---------|------|
| CPF 5203 | 錯誤訊息0 | 系統錯誤訊息0 |
| UPT 2150 | 錯誤訊息1 | 系統錯誤訊息1 |
| UPT 2142 | 錯誤訊息2 | 系統錯誤訊息2 |
| UPT 2050 | 錯誤訊息3 | 系統錯誤訊息3 |
| UPT 0010 | 錯誤訊息4 | 系統錯誤訊息4 |
| UPT 2010 | 錯誤訊息5 | 系統錯誤訊息5 |
| UPT 2020 | 錯誤訊息6 | 系統錯誤訊息6 |
| UPT 0040 | 錯誤訊息7 | 系統錯誤訊息7 |
| UPT 0030 | 錯誤訊息8 | 系統錯誤訊息8 |
| URE 0080 | 錯誤訊息9 | 系統錯誤訊息9 |
| UPT 0011 | 錯誤訊息10 | 系統錯誤訊息10 |
| UPT 0012 | 錯誤訊息11 | 系統錯誤訊息11 |
| URE 0135 | 錯誤訊息12 | 系統錯誤訊息12 |
| URE 0158 | 錯誤訊息13 | 系統錯誤訊息13 |
| URE 0159 | 錯誤訊息14 | 系統錯誤訊息14 |

## 五、相關檔案

1. **參照檔案**
   - RERF：欄位參照檔案

2. **訊息檔案**
   - REMF：系統訊息檔
   - PTMF：程式訊息檔

3. **相關程式**
   - ARA016：統一發票到期處理主程式

這份顯示檔規格書詳細說明了ARA016D的結構和用途。作為統一發票到期處理選單的顯示介面，此檔案提供了完整的選單功能和錯誤訊息處理機制，確保系統能夠有效地處理統一發票到期相關的操作需求。 