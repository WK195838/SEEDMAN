# 發票帳款子系統顯示檔規格書

## 一、基本資訊
- **顯示檔名稱**：ARA0081D
- **程式名稱**：ARA008
- **作者**：A1087 JOYCE
- **系統**：發票帳款系統
- **子系統**：發票帳款子系統
- **功能說明**：批次付款處理明細
- **建立日期**：81/03/27
- **修改記錄**：
  - M001 98.11.10 MICHELLE Y2K手動修改
  - M002 00.04.13 FOR DUTY功能擴充

## 二、顯示格式

### 1. 螢幕規格
- **螢幕大小**：24行 x 80列
- **訊息位置**：第24行
- **游標位置**：D#ROW, D#COL

### 2. 功能鍵設定
- **F3**：返回前頁
- **F5**：資料查詢
- **F12**：返回主選單

### 3. 標題區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 1,2 | 程式名稱 | 'ARA008' | 高亮度 |
| 1,26 | 訊息內容 | MSGCON(030 URE9999 *LIBL/REMF) | 高亮度 |
| 1,62 | 日期標籤 | '日期:' | - |
| 1,70 | 系統日期 | $EGMDY (6Y) | EDTCDE(Y) |
| 2,2 | 程式代碼 | 'SCR003' | - |
| 2,33 | 功能標題 | '批次付款處理' | 高亮度 |
| 2,62 | 時間標籤 | '時間:' | - |
| 2,70 | 系統時間 | TIME | EDTWRD('  :  :  ') |
| 3,62 | 使用者標籤 | ' USER :' | - |
| 3,70 | 使用者代碼 | $USER (10A) | 輸出(O) |

### 4. 輸入區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 4,2 | 廠商代碼標籤 | '廠商代碼:' | - |
| 4,14 | 廠商代碼 | SH01 | 輸出(O) |
| 4,17 | 廠商代碼後綴 | #B03 | 輸出(O) |
| 4,36 | 付款帳號標籤 | '付款帳號:' | - |
| 4,50 | 付款帳號 | SG04 | 輸出(O) |
| 4,56 | 付款銀行 | SG05 | 輸出(O) |
| 4,61 | 廠商簡稱 | ME04 | 輸出(O) |
| 5,2 | 付款日期標籤 | '付款日期:' | - |
| 5,14 | 付款日期 | SH03 | 輸出(O) |
| 5,24 | 付款方式 | MA03 | 輸出(O) |
| 5,43 | 匯款日期標籤 | '匯款日期:' | - |
| 5,57 | 匯款日期 | DSG06 (6Y) | 輸出(O)，EDTWRD('  /  /  ') |
| 5,67 | 匯款日期格式 | '(MM/DD/YY)' | - |
| 6,2 | 票據號碼標籤 | '票據號碼:' | - |
| 6,14 | 票據號碼 | SG09 | 輸出(O) |
| 6,43 | 兌現日期標籤 | '兌現日期:' | - |
| 6,57 | 兌現日期 | DSG26 (6Y) | 輸出(O)，EDTWRD('  /  /  ') |
| 6,67 | 兌現日期格式 | '(MM/DD/YY)' | - |
| 7,2 | 付款備註標籤 | '付款備註:' | - |
| 7,14 | 付款備註 | SH02 | 輸出(O) |
| 7,39 | 扣款金額標籤 | '扣款金額:' | - |
| 7,57 | 扣款金額 | DSH07 | 輸出(O)，EDTCDE(J) |
| 8,2 | 匯款金額標籤 | '匯款金額:' | - |
| 8,14 | 匯款金額 | SH04 | 輸出(O)，EDTCDE(J) |
| 8,39 | 實付金額標籤 | '實付金額:' | - |
| 8,57 | 實付金額 | DSH041 | 輸出(O)，EDTCDE(J) |
| 9,2 | 票據金額標籤 | '票據金額:' | - |
| 9,14 | 票據金額 | SH05 | 輸出(O)，EDTCDE(J) |
| 9,39 | 實付票據金額標籤 | '實付票據金額:' | - |
| 9,57 | 實付票據金額 | DSH051 | 輸出(O)，EDTCDE(J) |

### 5. 列表區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 13,2 | 功能選項 | DOPT1 (1A) | 輸入(B)，VALUES(' ' '2' '5') |
| 13,4 | 發票號碼 | DAG04 | 輸出(O) |
| 13,15 | 發票日期 | DSJ04A | 輸出(O)，EDTCDE(1) |
| 13,22 | 到期日 | SJ13 | 輸出(O)，EDTCDE(1) |
| 13,28 | 幣別 | DSJ06A | 輸出(O)，EDTCDE(3) |
| 13,39 | 匯率 | DSJ06B (9Y) | 輸出(O)，EDTCDE(3) |
| 13,49 | 發票金額 | DAG12 | 輸出(B)，EDTCDE(3) |
| 13,55 | 實付金額 | DAG13 | 輸出(B)，EDTCDE(3) |
| 13,60 | 票據金額 | DAG06 | 輸出(B)，EDTCDE(3) |
| 13,71 | 實付票據金額 | DAG07 (9Y) | 輸出(O)，EDTCDE(3) |
| 14,4 | 發票日期 | DSI21 (6Y) | 輸出(O)，EDTCDE(Y) |
| 14,15 | 數量1 | QTY1 | 輸出(O)，EDTCDE(1) |
| 14,22 | 數量2 | QTY2 | 輸出(O)，EDTCDE(1) |
| 14,55 | 實付金額 | DAG21 (9Y) | 輸出(B)，EDTCDE(1) |
| 14,67 | 匯款金額 | DSI24 (9Y) | 輸出(O)，EDTCDE(J) |

### 6. 功能說明區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 10,4 | 功能說明 | '2=付款' | - |
| 10,18 | 功能說明 | '5=明細查詢' | - |
| 10,41 | 標註 | '註記:' | - |
| 10,61 | 標註說明 | '*=註記' | - |
| 22,2 | 功能說明 | '注意' | - |
| 22,31 | 功能鍵說明 | 'F3 =返回前頁' | - |
| 22,47 | 功能鍵說明 | 'F5 =資料查詢' | - |
| 22,63 | 功能鍵說明 | 'F12=返回主選單' | - |

### 7. 錯誤訊息區
| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 24,2 | 錯誤訊息 | DMSG (78A) | 輸出(O)，高亮度 |
| 24,2 | 錯誤訊息1-17 | ERR1-ERR17 (63A) | 輸出(O)，MSGID(UPT/URE)，高亮度 |
| 24,66 | 系統訊息 | MSGCON(014 UPT9999 *LIBL/PTMF) | 高亮度 |

## 三、功能說明

1. **主要功能**
   - 提供批次付款處理明細介面
   - 支援批次付款、明細查詢、資料註記
   - 處理付款相關操作

2. **操作流程**
   - 選擇功能選項（付款/明細查詢）
   - 輸入或查詢付款資料
   - 執行批次付款處理

3. **資料驗證**
   - 廠商代碼、發票號碼、日期、金額、幣別等格式檢查
   - 數量、匯率等合理性檢查

4. **特殊處理**
   - 日期格式轉換
   - 金額格式化
   - 幣別與匯率換算
   - Y2K與Duty功能處理

## 四、相關檔案

1. **相關程式**
   - ARA008：批次付款處理主程式

2. **訊息檔案**
   - PTMF：系統訊息檔案
   - REMF：錯誤訊息檔案

這份顯示檔規格書詳細說明了ARA0081D的結構和用途。作為批次付款處理明細的顯示介面，此檔案提供了完整的付款、查詢與註記機制，確保系統能夠有效地處理批次付款相關的操作。 