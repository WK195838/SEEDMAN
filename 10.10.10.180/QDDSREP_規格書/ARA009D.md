# 發票帳款子系統顯示檔規格書

## 一、基本資訊
- **顯示檔名稱**：ARA009D
- **程式名稱**：ARA009
- **作者**：A1187 JOYCE
- **系統**：人事薪資系統
- **子系統**：發票帳款子系統
- **功能說明**：到期處理
- **建立日期**：81/03/18

## 二、修改記錄

| 修改代碼 | 日期 | 說明 |
|---------|------|------|
| M001 | - | 新增到期日期欄位 |

## 三、顯示檔格式

### 1. 畫面格式總覽
- **畫面大小**：24行 x 80列
- **訊息位置**：第24行
- **資料參照庫**：*LIBL/RERF

### 2. 詳細資料畫面 (DSPD1)

#### 功能鍵設定
- F3：返回主畫面
- F4：新增資料
- F14：處理資料

#### 顯示欄位

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 1,2 | 程式編號 | 'ARA009' | 固定顯示 |
| 1,26 | 系統標題 | MSGCON(030 URE9999) | 高亮顯示(HI) |
| 1,62 | 日期標籤 | '日期:' | 固定顯示 |
| 1,70 | 系統日期 | $EGMDY (6Y 0) | 輸出(O)，EDTCDE(Y) |
| 2,2 | 畫面編號 | 'SCR001' | 固定顯示 |
| 2,31 | 功能標題 | '到期處理' | 高亮顯示(HI) |
| 2,62 | 時間標籤 | '時間:' | 固定顯示 |
| 2,70 | 系統時間 | TIME | 格式'  :  :  ' |
| 3,62 | 用戶標籤 | ' USER :' | 固定顯示 |
| 3,70 | 用戶ID | $USER (10A) | 輸出(O) |

#### 輸入欄位

| 欄位名稱 | 欄位說明 | 位置(行,列) | 長度/類型 | 屬性 | 限制/檢核 |
|---------|---------|------------|----------|------|----------|
| DSC01S | 廠商代碼起 | 6,36 | R | 輸入(B) | REFFLD(SC01) |
| DSC01E | 廠商代碼迄 | 6,41 | R | 輸入(B) | REFFLD(SC01) |
| DSC31S | 到期金額起 | 10,36 | R | 輸入(B) | REFFLD(SC31) |
| DSC31E | 到期金額迄 | 10,41 | R | 輸入(B) | REFFLD(SC31) |
| DSC39S | 到期日期起 | 12,36 | 6Y 0 | 輸入(B) | EDTWRD('  /  /  ') |
| DSC39E | 到期日期迄 | 12,47 | 6Y 0 | 輸入(B) | EDTWRD('  /  /  ') |
| DSC33S | 到期狀態起 | 8,36 | R | 輸入(B) | REFFLD(SC33) |
| DSC33E | 到期狀態迄 | 8,41 | R | 輸入(B) | REFFLD(SC33) |
| DSC02S | 到期類型起 | 14,36 | R | 輸入(B) | REFFLD(SC02) |
| DSC02E | 到期類型迄 | 14,51 | R | 輸入(B) | REFFLD(SC02) |

#### 底部控制格式

| 位置(行,列) | 欄位說明 | 顯示格式 | 特性 |
|------------|---------|---------|------|
| 22,2 | 功能鍵說明 | '功能 F3 =返回主畫面' | 固定顯示 |
| 22,10 | 功能鍵說明 | 'F04=新增資料' | 固定顯示 |
| 22,26 | 功能鍵說明 | 'F14=處理資料' | 固定顯示 |
| 24,2 | 錯誤訊息 | ERR1-ERR12 (50A) | 高亮顯示(HI) |
| 24,66 | 系統訊息 | MSGCON(014 UPT9999) | 高亮顯示(HI) |

## 四、功能說明

1. **主要功能**
   - 提供到期處理的查詢介面
   - 支援多條件組合查詢
   - 提供資料新增和處理功能

2. **操作流程**
   - 使用者可輸入多個查詢條件
   - 可選擇新增資料或處理資料
   - 提供返回主畫面的功能

3. **資料檢核**
   - 廠商代碼必須存在
   - 到期日期必須符合格式要求
   - 到期金額必須為有效數值
   - 日期格式必須符合MM/DD/YY格式

4. **特殊處理**
   - 欄位屬性控制：根據不同條件設定不同的顯示屬性(RI、PC、HI、UL、PR等)
   - 日期格式控制：使用EDTWRD('  /  /  ')進行格式化
   - 金額格式控制：使用REFFLD進行參照

## 五、錯誤處理

系統提供多種錯誤訊息處理，包括：
- UPT 2142：資料格式錯誤
- UPT 2110：資料輸入錯誤
- UPT 2150：資料輸入錯誤
- UPT 0010：需要輸入
- UPT 2010：資料已存在
- UPT 0040：日期格式錯誤
- UPT 1011：資料不存在
- UPT 0041：資料格式錯誤
- URE 0108：系統錯誤

## 六、相關檔案

1. **參照檔案**
   - RERF：欄位參照檔案

2. **訊息檔案**
   - REMF：系統訊息檔
   - PTMF：程式訊息檔

3. **相關程式**
   - ARA009：到期處理主程式

這份顯示檔規格書詳細說明了ARA009D的結構和用途。作為到期處理的查詢介面，此檔案提供了多條件組合查詢功能，並支援資料的新增和處理。透過清晰的畫面規劃和完善的資料檢核機制，確保系統能夠有效地管理到期資料。 