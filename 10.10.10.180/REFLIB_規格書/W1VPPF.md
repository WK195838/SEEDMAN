# VIP基本資料檔規格書（W1VPPF）

## 一、基本資訊
- **檔案名稱**：W1VPPF
- **檔案說明**：VIP基本資料檔
- **檔案類型**：實體檔案（Physical File）
- **關鍵欄位**：VP02 + VP021
- **備註**：UNIQUE索引

## 二、記錄格式（VP0）

### 1. 欄位定義
| 欄位名稱 | 長度 | 屬性 | 說明 | 檢核規則 |
|----------|------|------|------|----------|
| VP01     | 5    | 字元 | 專櫃編號 | 必填 |
| VP02     | 15   | 字元 | 會員編號 | 必填，主鍵的一部分 |
| VP021    | 5    | 字元 | 分店編號 | 必填，主鍵的一部分 |
| VP03     | 42   | 物件 | 姓名 | 必填 |
| VP041    | 2    | 數值(0) | 出生月份 | 必填，無小數位 |
| VP042    | 2    | 數值(0) | 出生日期 | 必填，無小數位 |
| VP05     | 1    | 字元 | 性別 | 必填，有效值：M-男、F-女、''-其他 |
| VP06     | 62   | 物件 | 聯絡地址 | 選填 |
| VP07     | 42   | 物件 | 行動電話或市話 | 選填 |
| VP08     | 30   | 字元 | E-MAIL ADDRESS | 選填 |
| VP09     | 1    | 字元 | 同意個資使用 | 必填，有效值：Y-同意、N-不同意 |
| VP10     | 1    | 字元 | 生日禮盒 | 選填，有效值：V-需要、''-不需要 |
| VP11     | 1    | 字元 | DM寄送 | 選填，有效值：V-需要、''-不需要 |
| VP12     | 1    | 字元 | EMAIL寄送 | 選填，有效值：V-需要、''-不需要 |
| VP13     | 1    | 字元 | 電話通知 | 選填，有效值：V-需要、''-不需要 |
| VP14     | 1    | 字元 | 會員等級 | 必填，有效值：A-一般、B-高級 |

### 2. 索引定義
- **主索引**：VP02（會員編號）+ VP021（分店編號）（唯一索引）

## 三、關聯與檢核規則

### 1. 主鍵檢核
- VP02（會員編號）+ VP021（分店編號）組成唯一主鍵
- 不允許重複的主鍵值

### 2. 資料完整性檢核
- VP01（專櫃編號）：必須是系統中已登記的有效專櫃編號
- VP02（會員編號）：必須符合系統定義的會員編號格式
- VP021（分店編號）：必須是系統中有效的分店編號
- VP03（姓名）：不可為空
- VP041（出生月份）：必須是1-12之間的有效數值
- VP042（出生日期）：必須是1-31之間的有效數值，並與月份相符
- VP05（性別）：必須是有效的性別代碼（M-男、F-女、''-其他）
- VP09（同意個資使用）：必須是有效的代碼（Y-同意、N-不同意）
- VP14（會員等級）：必須是有效的等級代碼（A-一般、B-高級）

### 3. 業務規則
- 每個會員編號和分店編號的組合只能有一筆記錄
- 出生月份和日期應該組成有效的日期（如避免2月30日等無效日期）
- 會員通知偏好（VP10-VP13）決定會員接收不同類型通知的方式
- 個資使用同意（VP09）為「N」時，可能影響某些會員服務的提供
- 會員等級（VP14）影響會員可獲得的優惠和服務內容

## 四、使用說明

### 1. 檔案用途
- 儲存VIP會員的基本資料
- 管理會員的通知偏好設定
- 區分不同等級的會員服務
- 作為會員管理和行銷活動的資料基礎

### 2. 操作注意事項
- 新增記錄時，必須確保VP02、VP021組合的唯一性
- 會員資料應遵循個資法規範，根據VP09欄位的設定決定資料使用範圍
- 聯絡方式應保持最新，特別是有設定通知需求的會員
- 出生月份和日期資料用於生日禮盒發送判斷，應確保正確性

本規格書依據W1VPPF.txt製作，完整記錄W1VPPF檔案結構、欄位屬性與檢核規則。如需調整或有其他需求，歡迎隨時告知！ 