# 禮券訂單主檔規格書（W2BCPF）

## 一、基本資訊
- **檔案名稱**：W2BCPF
- **檔案說明**：禮券訂單主檔
- **檔案類型**：實體檔案（Physical File）
- **關鍵欄位**：BC01 + BC02 + BC03
- **備註**：UNIQUE索引

## 二、記錄格式（BC0）

### 1. 欄位定義
| 欄位名稱 | 長度 | 屬性 | 說明 | 檢核規則 |
|----------|------|------|------|----------|
| BC01     | 8    | 數值(0) | 訂單號 | 必填，主鍵的一部分，無小數位 |
| BC02     | 5    | 字元 | 作業點 | 必填，主鍵的一部分 |
| BC03     | 12   | 字元 | 訂單名稱 | 必填，主鍵的一部分 |
| BC04     | 1    | 字元 | 狀態 | 必填 |
| BC05     | 10   | 字元 | 確認人員 | 選填 |
| BCXX     | 8    | 數值(0) | 更新日期 | 系統自動產生，無小數位 |
| BCYY     | 6    | 數值(0) | 更新時間 | 系統自動產生，無小數位 |
| BCZZ     | 10   | 字元 | 更新人員 | 系統自動產生 |

### 2. 索引定義
- **主索引**：BC01（訂單號）+ BC02（作業點）+ BC03（訂單名稱）（唯一索引）

## 三、關聯與檢核規則

### 1. 主鍵檢核
- BC01（訂單號）+ BC02（作業點）+ BC03（訂單名稱）組成唯一主鍵
- 不允許重複的主鍵值

### 2. 資料完整性檢核
- BC01（訂單號）：必須是有效的數值，無小數位
- BC02（作業點）：必須是系統中已定義的有效作業點
- BC03（訂單名稱）：必須是有效的訂單名稱
- BC04（狀態）：必須是有效的狀態碼（如：A=處理中，C=已完成，X=已取消等）
- BC05（確認人員）：若填寫，必須是系統中有效的操作員ID

### 3. 業務規則
- 每個訂單號、作業點和訂單名稱的組合只能有一筆記錄
- 狀態碼（BC04）控制禮券訂單是否可用於系統操作
- 訂單建立時，系統自動指派訂單號（BC01）
- 確認人員（BC05）記錄訂單的審核或處理人員
- 系統會自動記錄更新相關資訊（BCXX、BCYY、BCZZ）

## 四、使用說明

### 1. 檔案用途
- 儲存禮券訂單的基本資料
- 管理禮券訂單的狀態
- 記錄訂單的確認和處理情況
- 作為禮券訂單明細的參照主檔

### 2. 操作注意事項
- 新增記錄時，必須確保BC01、BC02、BC03組合的唯一性
- 系統會自動維護BCXX（更新日期）、BCYY（更新時間）和BCZZ（更新人員）欄位
- 修改記錄時，應注意保留原有的主鍵值，避免造成資料關聯性問題
- 狀態變更需符合系統定義的狀態流程，不可隨意變更
- 此檔案通常與禮券卡片主檔（W2BAPF）和禮券卡片明細檔（W2BBPF）配合使用

本規格書依據W2BCPF.txt製作，完整記錄W2BCPF檔案結構、欄位屬性與檢核規則。如需調整或有其他需求，歡迎隨時告知！ 