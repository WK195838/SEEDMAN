# VIP檔案工作檔規格書（W1VPWF）

## 一、基本資訊
- **檔案名稱**：W1VPWF
- **檔案說明**：VIP檔案工作檔
- **檔案類型**：實體檔案（Physical File）
- **關鍵欄位**：WP02 + WP021 + WP01 + WP08 + WP05 + WP03 + WP09 + WP10 + WP11 + WP12 + WP13
- **備註**：UNIQUE索引、多重索引檔

## 二、記錄格式（WP0）

### 1. 欄位定義
| 欄位名稱 | 長度 | 屬性 | 說明 | 檢核規則 |
|----------|------|------|------|----------|
| WP01     | 5    | 字元 | 專櫃編號 | 必填，索引的一部分 |
| WP02     | 15   | 字元 | 會員編號 | 必填，索引的一部分 |
| WP021    | 5    | 字元 | 分店編號 | 必填，索引的一部分 |
| WP03     | 42   | 物件 | 姓名 | 必填，索引的一部分 |
| WP041    | 2    | 數值(0) | 出生月份 | 必填，無小數位 |
| WP042    | 2    | 數值(0) | 出生日期 | 必填，無小數位 |
| WP05     | 1    | 字元 | 性別 | 必填，索引的一部分，有效值：M-男、F-女、''-其他 |
| WP06     | 62   | 物件 | 聯絡地址 | 選填 |
| WP07     | 42   | 物件 | 行動電話或市話 | 選填 |
| WP08     | 30   | 字元 | E-MAIL ADDRESS | 選填，索引的一部分 |
| WP09     | 1    | 字元 | 同意個資使用 | 必填，索引的一部分，有效值：Y-同意、N-不同意 |
| WP10     | 1    | 字元 | 生日禮盒 | 索引的一部分，有效值：V-需要、''-不需要 |
| WP11     | 1    | 字元 | DM寄送 | 索引的一部分，有效值：V-需要、''-不需要 |
| WP12     | 1    | 字元 | EMAIL寄送 | 索引的一部分，有效值：V-需要、''-不需要 |
| WP13     | 1    | 字元 | 電話通知 | 索引的一部分，有效值：V-需要、''-不需要 |
| WP14     | 1    | 字元 | 會員等級 | 必填，有效值：A-一般、B-高級 |

### 2. 索引定義
- **複合索引**：WP02 + WP021 + WP01 + WP08 + WP05 + WP03 + WP09 + WP10 + WP11 + WP12 + WP13

## 三、關聯與檢核規則

### 1. 索引檢核
- 多個欄位組成複合索引，用於快速檢索與分類
- 不允許重複的索引值組合

### 2. 資料完整性檢核
- WP01（專櫃編號）：必須是系統中已登記的有效專櫃編號
- WP02（會員編號）：必須符合系統定義的會員編號格式
- WP021（分店編號）：必須是系統中有效的分店編號
- WP03（姓名）：不可為空
- WP041（出生月份）：必須是1-12之間的有效數值
- WP042（出生日期）：必須是1-31之間的有效數值，並與月份相符
- WP05（性別）：必須是有效的性別代碼（M-男、F-女、''-其他）
- WP09（同意個資使用）：必須是有效的代碼（Y-同意、N-不同意）
- WP14（會員等級）：必須是有效的等級代碼（A-一般、B-高級）

### 3. 業務規則
- 此工作檔結構與W1VPPF（VIP基本資料檔）相似，但增加了更多索引欄位
- 用於會員資料的快速搜尋、排序和分析作業
- 會員通知偏好（WP10-WP13）可用於特定行銷活動的會員篩選
- 會員資料異動前，可先在工作檔進行操作，確認無誤後再更新至主檔
- 個資使用同意（WP09）為「N」時，可能影響特定會員資料的使用範圍

## 四、使用說明

### 1. 檔案用途
- 作為VIP會員資料的臨時工作區
- 提供多重索引，支援複雜的會員資料查詢與分析
- 用於會員資料篩選與行銷活動規劃
- 執行大量會員資料處理前的暫存區

### 2. 操作注意事項
- 由於索引欄位較多，新增或修改資料時需額外注意資料的一致性
- 索引欄位的變更可能影響系統查詢效能
- 工作檔資料變更後，應適時同步更新至主檔W1VPPF
- 查詢時可利用各種索引欄位組合，提高查詢效率
- 大量資料處理時，應注意工作檔容量與系統效能

本規格書依據W1VPWF.txt製作，完整記錄W1VPWF檔案結構、欄位屬性與檢核規則。如需調整或有其他需求，歡迎隨時告知！ 