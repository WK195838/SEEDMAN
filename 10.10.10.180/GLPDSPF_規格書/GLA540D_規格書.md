# GLA540D 螢幕顯示檔規格書

## 一、基本資訊
- 檔案名稱：GLA540D
- 檔案類型：螢幕顯示檔
- 來源目錄：10.10.10.180/QDDSSRC_GLPLIB
- 程式說明：年度科目設定及查詢
- 系統：會計總帳系統
- 子系統：會計總帳系統
- 作者：JOYCE (A1087)
- 建立日期：1992.12.04
- 更新日期：

## 二、螢幕規格
- 顯示大小：24x80
- 參考檔案：GLRF
- 訊息位置：第22行
- 列印功能：支援
- 條件指示器：
  - CA03(03)：主畫面顯示控制
  - CF04(04)：列印控制
  - CF05(05)：查詢控制
  - CF06(06)：新增控制
  - CF09(09)：公司設定控制
  - CF12(12)：返回控制
  - CF13(13)：公司設定控制

## 三、記錄格式

### 1. 主畫面 (DSPD1)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| CONAME | 1,25 | 32 | A | O | 公司名稱 |
| DDATE | 1,72 | 6 | Y | O | 系統日期 |
| $USERN | 2,2 | 10 | A | O | 使用者代號 |
| DAH01 | 3,16 | - | R | B | 公司代號 |
| #B02 | 3,19 | - | R | O | 公司名稱 |
| DAH02 | 4,16 | - | R | B | 會計科目代號 |

### 2. 明細畫面 (DSPD2)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| DAH03 | 6,16 | - | R | O | 科目代號 |
| DFUN | 6,60 | 14 | A | O | 功能說明 |
| DAH04 | 7,16 | - | R | B | 科目名稱 |
| DAF03 | 7,26 | - | R | O | 科目說明 |
| DAH12 | 8,16 | - | R | B | 上級科目 |
| DAH13 | 9,16 | - | R | B | 下級科目 |
| DAH11 | 9,70 | 1 | A | B | 是否允許 |

### 3. 子檔記錄 (SFLSR)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| DOPT | 9,2 | 1 | A | B | 處理選項 |
| RRN | 9,2 | 3 | Y | H | 記錄編號 |
| DAH031 | 9,4 | - | R | O | 科目代號 |
| DAH041 | 9,8 | - | R | O | 科目名稱 |
| DAH042 | 9,17 | - | R | O | 科目名稱 |
| DAF031 | 9,26 | 18 | A | O | 科目說明 |
| DAH121 | 9,46 | - | R | O | 上級科目 |
| DAH131 | 9,64 | - | R | O | 下級科目 |
| DAH161 | 10,25 | - | R | O | 科目類別 |
| DAH111 | 10,78 | 1 | A | O | 是否允許 |

## 四、功能鍵說明
- PF2：批次處理
- PF3：返回前頁
- PF4：列印資料
- PF5：查詢資料
- PF6：新增資料
- PF9：公司設定
- PF12：返回前頁
- PF13：公司設定

## 五、輸入欄位驗證
1. 必填欄位：
   - 公司代號 (DAH01)
   - 會計科目代號 (DAH02)
   - 科目代號 (DAH03)
   - 科目名稱 (DAH04)
   - 上級科目 (DAH12)
   - 下級科目 (DAH13)

2. 資料格式：
   - 公司代號：必須為有效公司代號
   - 會計科目代號：必須為有效科目代號
   - 科目代號：必須為有效科目代號
   - 是否允許：Y/N

## 六、錯誤處理
- 錯誤訊息顯示位置：第22行
- 錯誤訊息格式：MSGID(&ERRID &ERRF)
- 錯誤類型：
  - 必填欄位未輸入
  - 資料格式錯誤
  - 公司代號不存在
  - 科目代號不存在
  - 年度不合理

## 七、使用說明
1. 查詢條件設定：
   - 輸入公司代號
   - 輸入會計科目代號
   - 選擇處理選項

2. 功能操作說明：
   - 使用PF2進行批次處理
   - 使用PF3返回前頁
   - 使用PF4列印資料
   - 使用PF5查詢資料
   - 使用PF6新增資料
   - 使用PF9/PF13進行公司設定

3. 注意事項：
   - 公司代號必須為有效值
   - 會計科目代號必須存在
   - 科目代號必須存在
   - 上級科目必須存在
   - 下級科目必須存在
   - 是否允許必須為Y/N 