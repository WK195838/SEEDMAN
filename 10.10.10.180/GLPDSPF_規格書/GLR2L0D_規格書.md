# GLR2L0D 螢幕規格書

## 一、基本資訊
- 檔案名稱：GLR2L0D
- 檔案類型：顯示檔案
- 來源目錄：10.10.10.180/QDDSSRC_GLPLIB
- 程式說明：部門費用分析明細顯示檔案
- 系統：會計系統
- 子系統：總帳系統
- 作者：A1087 JOYCE
- 建立日期：1992.12.18
- 更新日期：
- 備註：部門費用分析明細顯示檔案

## 二、螢幕規格
1. 顯示大小：24列 x 80行
2. 參考檔案：GLRF
3. 列印功能：支援
4. 訊息位置：第22列
5. 游標控制：使用 #LIN 和 #COL 變數
6. 功能鍵設定：
   - PF3：返回前頁
   - PF4：重新查詢
   - PF14：批次處理

## 三、螢幕佈局

### 主畫面
```
<GLR2L0.1>                    [公司名稱]                    [系統日期]
[使用者代號]                    部門費用分析明細查詢

公司代號: [    ]
會計日期: [  /  /  ]
列印格式: [    ]
列印環境: [ ] (0-查詢 1-列印 2-批次)
每頁筆數: [   ]
列印代號: [  ]

***請輸入查詢條件***
***資料處理中請稍候***

[錯誤訊息]

說明
PF3 =返回前頁
PF4 =重新查詢
PF14=批次處理                                 [茂世科技]
```

## 四、紀錄格式

### 主畫面欄位
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| #LIN | 1 | 3 | S | H | 游標列位置 |
| #COL | 1 | 3 | S | H | 游標行位置 |
| CONAME | 25 | 32 | A | O | 公司名稱 |
| DDATE | 69 | 6 | 0 | O | 系統日期 |
| $USERN | 2 | 10 | A | O | 使用者代號 |
| DAI01 | 39 | 4 | A | B | 公司代號 |
| DAK12 | 39 | 6 | 0 | B | 會計日期 |
| DAR03 | 39 | 2 | A | B | 列印格式 |
| $PENV | 39 | 1 | A | B | 列印環境 |
| $CPY | 39 | 3 | 0 | B | 每頁筆數 |
| $PRTCD | 39 | 2 | A | B | 列印代號 |
| ERRID | 1 | 7 | A | H | 錯誤訊息ID |
| ERRF | 1 | 10 | A | H | 錯誤訊息檔案 |
| ERRMSG | 2 | 70 | A | O | 錯誤訊息內容 |

## 五、功能鍵說明
1. PF3：返回前頁
2. PF4：重新查詢
3. PF14：批次處理

## 六、輸入欄位驗證
1. 必填欄位：
   - 公司代號 (DAI01)
   - 會計日期 (DAK12)
   - 列印格式 (DAR03)
   - 列印環境 ($PENV)
   - 每頁筆數 ($CPY)
   - 列印代號 ($PRTCD)

2. 欄位格式：
   - 公司代號：4位英數字
   - 會計日期：6位數字，格式為 YYMMDD
   - 列印格式：2位英數字
   - 列印環境：1位數字，值域為0-2
   - 每頁筆數：3位數字
   - 列印代號：2位英數字

## 七、錯誤處理
1. 錯誤訊息顯示：
   - 位置：第22列
   - 格式：錯誤訊息ID + 錯誤訊息內容
   - 屬性：高亮度顯示

2. 錯誤處理程序：
   - 顯示錯誤訊息
   - 等待使用者修正
   - 重新執行查詢

## 八、使用說明
1. 螢幕用途：
   - 提供部門費用分析明細查詢介面
   - 支援查詢、列印和批次處理功能
   - 顯示查詢結果和錯誤訊息

2. 操作流程：
   - 輸入查詢條件
   - 選擇列印環境
   - 執行查詢或批次處理
   - 查看結果或錯誤訊息

3. 注意事項：
   - 所有欄位皆為必填
   - 列印環境需選擇正確的選項
   - 批次處理時需等待處理完成
   - 錯誤訊息會顯示在畫面下方 