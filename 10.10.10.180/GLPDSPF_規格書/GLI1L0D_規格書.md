# GLI1L0D 螢幕顯示檔規格書

## 一、基本資訊
- 檔案名稱：GLI1L0D
- 檔案類型：螢幕顯示檔
- 來源目錄：10.10.10.180/QDDSSRC_GLPLIB
- 程式說明：傳票科目餘額查詢
- 系統：會計總帳系統
- 子系統：會計總帳系統
- 作者：D910121
- 建立日期：1994.06.29
- 更新日期：

## 二、螢幕規格
- 顯示大小：24x80
- 參考檔案：GLFLIB/GLRF
- 螢幕代號：GLI1L0.1/GLI1L0.2/GLI1L0.3
- 訊息位置：第22行
- 列印功能：支援
- 條件指示器：
  - 31-35：欄位顯示控制
  - 36-39：欄位高亮顯示控制
  - 50：明細資料顯示控制
  - 51：明細資料控制顯示
  - 52：明細資料清除控制
  - 60-61：欄位顯示控制
  - 62-68：欄位顯示控制
  - 99：錯誤訊息控制
  - CA03：畫面控制
  - CF04：畫面控制
  - CF12：畫面控制

## 三、螢幕佈局

### 主畫面 (GLI1L0.1)
```
<GLI1L0.1>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                    傳票科目餘額查詢                   時間: [時間]

公司代號  : [    ]
傳票號碼  : [    ]
---------------------------------------------------------
[錯誤訊息顯示區域]
注意    PF3 =返回前頁    PF4 =查詢明細
                                                           【茂世資訊】
```

### 明細畫面 (GLI1L0.2)
```
<GLI1L0.2>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                    傳票科目餘額查詢                   時間: [時間]

公司代號  : [    ] [公司名稱]
傳票號碼  : [    ] [傳票名稱]
科目日期  : [  /  /  ] _
查詢類別  : [ ] (1.預算餘額 2.預算科目 3.明細)
---------------------------------------------------------
輸入欄位           :
---------------------------------------------------------
[欄位1] : [    ]
[欄位2] : [    ]
[欄位3] : [    ]
[欄位4] : [    ]
[欄位5] : [  /  /  ]
---------------------------------------------------------
[錯誤訊息顯示區域]
注意    PF3 =返回前頁    PF4 =查詢明細    PF12=返回前頁
                                                           【茂世資訊】
```

### 查詢結果畫面 (GLI1L0.3)
```
<GLI1L0.3>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                    傳票科目餘額查詢                   時間: [時間]

公司代號  : [    ] [公司名稱]
傳票號碼  : [    ] [傳票名稱]
科目日期  : [  /  /  ] _
查詢類別  : [ ] (1.預算餘額 2.預算科目 3.明細)
---------------------------------------------------------
S (=一筆) : 5-科目明細
P : V-預算餘額
A : V-預算科目
S 科目日期    科目代號     借方金額       貸方金額          餘額    PA
---------------------------------------------------------
[明細資料顯示區域]
---------------------------------------------------------
[合計區域]
---------------------------------------------------------
[錯誤訊息顯示區域]
注意    PF2 =傳票查詢    PF3 =返回前頁    PF4 =查詢明細
注意    PA1 =下一頁    PA2 =上一頁
                                                           【茂世資訊】
```

## 四、記錄格式

### 明細畫面 (SFLSR)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| RRN | - | 3 | S | H | 記錄編號 |
| DOPT | 11,2 | 1 | A | B | 選項 |
| SAH10 | 11,4 | 7 | Y | O | 科目日期 |
| AH02 | 11,14 | - | R | O | 科目代號 |
| AH12 | 11,24 | - | R | O | 借方金額 |
| AH13 | 11,42 | - | R | O | 貸方金額 |
| C | 11,60 | 13 | Y | O | 餘額 |
| DAH18 | 11,79 | 2 | - | O | 預算狀態 |
| AH16 | 12,24 | - | R | O | 摘要 |

### 主畫面 (DSPD1)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| CONAME | 1,25 | 32 | A | O | 公司名稱 |
| DDATE | 1,72 | 6 | Y | O | 系統日期 |
| $USERN | 2,2 | 10 | A | O | 使用者ID |
| DAH01 | 3,16 | - | R | B | 公司代號 |
| DAH04 | 4,16 | - | R | B | 傳票號碼 |

### 明細畫面 (DSPD2)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| CONAME | 1,25 | 32 | A | O | 公司名稱 |
| DDATE | 1,72 | 6 | Y | O | 系統日期 |
| $USERN | 2,2 | 10 | A | O | 使用者ID |
| DAH01 | 3,16 | - | R | O | 公司代號 |
| #B02 | 3,25 | - | R | O | 公司名稱 |
| DAH04 | 4,16 | - | R | O | 傳票號碼 |
| AF03 | 4,25 | - | R | O | 傳票名稱 |
| DAH10 | 5,16 | - | R | B | 科目日期 |
| A | 6,16 | 1 | A | B | 查詢類別 |
| DAA031 | 10,1 | - | R | O | 欄位1名稱 |
| DAH05 | 10,24 | - | R | B | 欄位1值 |
| DAA032 | 11,1 | - | R | O | 欄位2名稱 |
| DAH06 | 11,24 | - | R | B | 欄位2值 |
| DAA033 | 12,1 | - | R | O | 欄位3名稱 |
| DAH07 | 12,24 | - | R | B | 欄位3值 |
| DAA034 | 13,1 | - | R | O | 欄位4名稱 |
| DAH08 | 13,24 | - | R | B | 欄位4值 |
| DAA035 | 14,1 | - | R | O | 欄位5名稱 |
| DAH09 | 14,24 | - | R | B | 欄位5值 |

## 五、功能鍵說明
- PF2：傳票查詢
- PF3：返回前頁
- PF4：查詢明細
- PF12：返回前頁
- PA1：下一頁
- PA2：上一頁

## 六、輸入欄位驗證
1. 必填欄位：
   - 公司代號 (DAH01)
   - 傳票號碼 (DAH04)
   - 科目日期 (DAH10)
   - 查詢類別 (A)

2. 資料格式：
   - 公司代號：必須為有效公司代號
   - 傳票號碼：必須為有效傳票號碼
   - 科目日期：必須為有效日期格式 (YY/MM/DD)
   - 查詢類別：必須為1、2或3
   - 金額格式：必須為有效金額格式

## 七、錯誤處理
- 錯誤訊息顯示位置：第22行
- 錯誤訊息格式：
  - MSGID(&ERRID &ERRF)：動態錯誤訊息
- 錯誤類型：
  - 必填欄位未輸入
  - 資料格式錯誤
  - 公司代號不存在
  - 傳票號碼不存在
  - 查詢條件不合理

## 八、使用說明
1. 查詢條件設定：
   - 輸入公司代號
   - 輸入傳票號碼
   - 設定科目日期
   - 選擇查詢類別 (1.預算餘額 2.預算科目 3.明細)
   - 設定其他查詢條件

2. 功能操作說明：
   - 使用PF4進行明細查詢
   - 使用PF3返回前頁
   - 使用PF12返回前頁
   - 使用PA1查看下一頁
   - 使用PA2查看上一頁

3. 注意事項：
   - 公司代號必須為有效值
   - 傳票號碼必須為有效值
   - 日期格式必須正確 (YY/MM/DD)
   - 查詢類別必須為1、2或3
   - 明細資料每頁顯示5筆
   - 可查看預算狀態和科目狀態 