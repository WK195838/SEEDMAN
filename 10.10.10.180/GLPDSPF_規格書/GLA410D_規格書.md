# GLA410D 螢幕顯示檔案規格書

## 基本資訊
- 檔案名稱：GLA410D
- 檔案類型：螢幕顯示檔案 (DSPF)
- 來源目錄：QDDSSRC_GLPLIB
- 程式說明：會計科目格式設定處理
- 系統：茂世會計系統
- 子系統：總帳系統
- 作者：JOYCE (A1087)
- 建立日期：1992.10.27
- 更新日期：無

## 螢幕規格
- 顯示大小：24x80
- 參考檔案：GLRF (總帳欄位定義檔)
- 訊息位置：第22行
- 列印功能：支援
- 條件指示器：CA03(03), CF18(18), CF04(04), CF05(05), CF12(12)

## 記錄格式
### DSPD1 - 主畫面
- 條件指示器：CA03(03), CF18(18)
- 錯誤訊息ID (ERRID)：7A
- 錯誤訊息檔案 (ERRF)：10A

### 主畫面欄位
1. 公司名稱 (CONAME)
   - 位置：1,25
   - 格式：32A
   - 訊息ID：US# 9001 S#MF

2. 日期 (DDATE)
   - 位置：1,72
   - 格式：6Y
   - 編輯碼：Y

3. 使用者 ($USERN)
   - 位置：2,2
   - 格式：10A

4. 公司代號 (DAF01)
   - 位置：4,14
   - 參考欄位：AF01
   - 條件指示器：60
   - 顯示屬性：PC, RI

5. 會計科目 (DAF02)
   - 位置：5,14
   - 參考欄位：AF02
   - 條件指示器：61
   - 顯示屬性：PC, RI

6. 公司代號格式 (DAF01C)
   - 位置：5,33
   - 參考欄位：AF01
   - 條件指示器：62
   - 顯示屬性：PC, RI

7. 會計科目格式 (DAF02C)
   - 位置：5,36
   - 參考欄位：AF02
   - 條件指示器：62
   - 顯示屬性：PC, RI

8. 處理選項 (DOPT)
   - 位置：6,14
   - 格式：1Y
   - 編輯碼：4
   - 值：1, 2, 4, 5
   - 說明：(1.新增 2.修改 4.刪除 5.查詢)

### DSPD2 - 明細畫面
- 條件指示器：CA03(03), CF12(12)
- 錯誤訊息ID (ERRID)：7A
- 錯誤訊息檔案 (ERRF)：10A

### 明細畫面欄位
1. 公司名稱 (CONAME)
   - 位置：1,25
   - 格式：32A
   - 訊息ID：US# 9001 S#MF

2. 日期 (DDATE)
   - 位置：1,72
   - 格式：6Y
   - 編輯碼：Y

3. 使用者 ($USERN)
   - 位置：2,2
   - 格式：10A

4. 公司代號 (DAF01)
   - 位置：4,14
   - 參考欄位：AF01

5. 公司名稱 (D#B02)
   - 位置：4,19
   - 格式：12A

6. 會計科目 (DAF02)
   - 位置：5,14
   - 參考欄位：AF02

7. 公司代號格式 (DAF01C)
   - 位置：5,33
   - 參考欄位：AF01

8. 會計科目格式 (DAF02C)
   - 位置：5,36
   - 參考欄位：AF02

9. 處理選項 (DOPT)
   - 位置：6,14
   - 格式：1Y
   - 編輯碼：4
   - 值：1, 2, 4, 5
   - 說明：(1.新增 2.修改 4.刪除 5.查詢)

10. 科目代號 (DAF03)
    - 位置：8,18
    - 參考欄位：AF03
    - 條件指示器：60, 31
    - 顯示屬性：PC, RI, UL, PR

11. 科目名稱 (DAF04)
    - 位置：10,18
    - 參考欄位：AF04
    - 條件指示器：31
    - 顯示屬性：UL, PR

12. 科目類別 (DAF05)
    - 位置：12,18
    - 參考欄位：AF05
    - 條件指示器：31
    - 顯示屬性：UL, PR
    - 值：1, 2
    - 說明：(1.借方 2.貸方)

13. 科目性質 (DAF06)
    - 位置：14,18
    - 參考欄位：AF06
    - 條件指示器：31
    - 顯示屬性：UL, PR
    - 值：1, 2
    - 說明：(1.資產 2.負債)

14. 科目狀態 (DAF08)
    - 位置：16,18
    - 參考欄位：AF08
    - 條件指示器：31
    - 顯示屬性：UL, PR
    - 值：1, 2
    - 說明：(1.啟用 2.停用)

15. 科目類型 (DAF09)
    - 位置：18,18
    - 參考欄位：AF09
    - 條件指示器：31
    - 顯示屬性：UL, PR
    - 值：1, 2, 3, 4
    - 說明：(1.一般 2.新增科目 3.年度新增 4.其他)

### DSPD3 - 明細處理畫面
- 條件指示器：CA03(03), CF04(04), CF05(05), CF12(12)
- 錯誤訊息ID (ERRID)：7A
- 錯誤訊息檔案 (ERRF)：10A

### 明細處理畫面欄位
1. 公司名稱 (CONAME)
   - 位置：1,25
   - 格式：32A
   - 訊息ID：US# 9001 S#MF

2. 日期 (DDATE)
   - 位置：1,72
   - 格式：6Y
   - 編輯碼：Y

3. 使用者 ($USERN)
   - 位置：2,2
   - 格式：10A

4. 公司代號 (DAF01)
   - 位置：4,14
   - 參考欄位：AF01

5. 公司名稱 (D#B02)
   - 位置：4,19
   - 格式：12

6. 會計科目 (DAF02)
   - 位置：5,14
   - 參考欄位：AF02

7. 公司代號格式 (DAF01C)
   - 位置：5,33
   - 參考欄位：AF01

8. 會計科目格式 (DAF02C)
   - 位置：5,36
   - 參考欄位：AF02

9. 處理選項 (DOPT)
   - 位置：6,14
   - 格式：1Y
   - 編輯碼：4
   - 值：1, 2, 4, 5
   - 說明：(1.新增 2.修改 4.刪除 5.查詢)

10. 科目代號 (DAF021)
    - 位置：8,14
    - 參考欄位：AF02

11. 科目名稱 (DAF03)
    - 位置：8,23
    - 參考欄位：AF03

12. 科目屬性 (DAF11-DAF17)
    - 位置：10-16行
    - 參考欄位：AF11-AF17
    - 條件指示器：80-86, 31, 99
    - 顯示屬性：PC, RI, UL, PR, HI

13. 科目代號 (DAA31-DAA37)
    - 位置：10-16行
    - 參考欄位：AA03
    - 條件指示器：80-86

14. 科目格式 (DAF181-DAF187)
    - 位置：10-16行
    - 值：' ', 'V'
    - 條件指示器：61-67, 31
    - 顯示屬性：PC, RI, UL, PR

15. 科目類型 (DAF191-DAF195)
    - 位置：10-14行
    - 編輯碼：4
    - 條件指示器：70-74, 31
    - 顯示屬性：PC, RI, UL, PR

16. 科目狀態 (DAF201-DAF205)
    - 位置：10-14行
    - 值：' ', 'V'
    - 條件指示器：75-79, 31
    - 顯示屬性：PC, RI, UL, PR

17. 科目說明 (DAF10)
    - 位置：18,26
    - 參考欄位：AF10
    - 條件指示器：87, 31, 99
    - 顯示屬性：PC, RI, UL, PR, HI

18. 科目代號 (DAE03)
    - 位置：18,29
    - 參考欄位：AE03

19. 科目說明 (DAF22)
    - 位置：19,26
    - 參考欄位：AF22
    - 條件指示器：88, 31, 99
    - 顯示屬性：PC, RI, UL, PR, HI

20. 科目代號 (DA303)
    - 位置：19,29
    - 參考欄位：A303

## 訊息顯示
1. 錯誤訊息 (ERRMSG)
   - 位置：22,2
   - 格式：70A
   - 條件指示器：99
   - 高亮度顯示

## 功能鍵說明
| 功能鍵 | 說明 |
|-------|------|
| PF3 | 返回前頁 |
| PF4 | 查詢資料 |
| PF5 | 開始處理 |
| PF12 | 返回前一頁 |
| PF18 | 批次查詢 |

## 輸入欄位驗證
1. 公司代號 (DAF01)
   - 必填欄位
   - 需為有效公司代號

2. 會計科目 (DAF02)
   - 必填欄位
   - 需為有效會計科目

3. 處理選項 (DOPT)
   - 必填欄位
   - 值需為 1, 2, 4, 5 其中之一

4. 科目代號 (DAF03)
   - 必填欄位
   - 需為有效科目代號

5. 科目名稱 (DAF04)
   - 必填欄位
   - 需為有效科目名稱

6. 科目類別 (DAF05)
   - 必填欄位
   - 值需為 1, 2 其中之一

7. 科目性質 (DAF06)
   - 必填欄位
   - 值需為 1, 2 其中之一

8. 科目狀態 (DAF08)
   - 必填欄位
   - 值需為 1, 2 其中之一

9. 科目類型 (DAF09)
   - 必填欄位
   - 值需為 1, 2, 3, 4 其中之一

## 錯誤處理
1. 錯誤訊息顯示位置：第22行
2. 錯誤訊息類型：
   - 必填欄位未填
   - 資料格式錯誤
   - 公司代號錯誤
   - 會計科目錯誤
   - 科目代號錯誤
   - 科目名稱錯誤
   - 科目類別錯誤
   - 科目性質錯誤
   - 科目狀態錯誤
   - 科目類型錯誤
   - 系統錯誤

## 使用說明
1. 查詢條件設定：
   - 需輸入公司代號
   - 需輸入會計科目
   - 需選擇處理選項

2. 科目格式維護：
   - 可新增科目格式
   - 可修改科目格式
   - 可刪除科目格式
   - 可查詢科目格式

3. 功能操作：
   - 可進行資料查詢
   - 可進行資料處理
   - 可返回前頁
   - 可進行批次查詢

4. 注意事項：
   - 公司代號為必填欄位
   - 會計科目為必填欄位
   - 處理選項需選擇 1, 2, 4, 5 其中之一
   - 科目代號需為有效代號
   - 科目名稱需為有效名稱
   - 科目類別需選擇 1, 2 其中之一
   - 科目性質需選擇 1, 2 其中之一
   - 科目狀態需選擇 1, 2 其中之一
   - 科目類型需選擇 1, 2, 3, 4 其中之一
   - 處理完成後會顯示處理結果 