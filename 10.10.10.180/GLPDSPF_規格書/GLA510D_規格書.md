# GLA510D 螢幕顯示檔規格書

## 一、基本資訊
- 檔案名稱：GLA510D
- 檔案類型：螢幕顯示檔
- 來源目錄：10.10.10.180/QDDSSRC_GLPLIB
- 程式說明：會計科目設定
- 系統：會計總帳系統
- 子系統：會計總帳系統
- 作者：A1150
- 建立日期：81/12/02
- 更新日期：

## 二、螢幕規格
- 顯示大小：24x80
- 參考檔案：GLRF
- 列印功能：支援
- 條件指示器：
  - CA03(03)：主畫面顯示控制
  - CF04(04)：列印控制
  - CF14(14)：批次處理控制

## 三、記錄格式

### 主畫面 (DSPD1)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| CONAME | 1,25 | 32 | A | O | 公司名稱 |
| DDATE | 1,72 | 6 | Y | O | 系統日期 |
| $USERN | 2,2 | 10 | A | O | 使用者代號 |
| DAC01 | 5,43 | - | R | B | 會計科目代號 |
| DFLD1 | 7,43 | 3 | Y | B | 會計年度 |
| DFLD2 | 8,43 | 2 | Y | B | 會計期間 |
| GLS1F | 8,53 | 7 | Y | O | 起始日期 |
| GLS1T | 8,65 | 7 | Y | O | 結束日期 |
| DFLD3 | 11,43 | 5 | A | O | 傳票號碼 |
| GLS2F | 11,53 | 7 | Y | O | 起始日期 |
| GLS2T | 11,65 | 7 | Y | O | 結束日期 |
| $CPY | 16,43 | 3 | Y | B | 公司代號 |
| $PRTCD | 17,43 | 2 | A | B | 列印代號 |
| ERRMSG | 22,2 | 70 | A | O | 錯誤訊息 |

## 四、功能鍵說明
- PF3：返回前頁
- PF4：列印資料
- PF14：批次處理

## 五、輸入欄位驗證
1. 必填欄位：
   - 會計科目代號 (DAC01)
   - 會計年度 (DFLD1)
   - 會計期間 (DFLD2)
   - 公司代號 ($CPY)
   - 列印代號 ($PRTCD)

2. 資料格式：
   - 會計年度：3位數字
   - 會計期間：2位數字
   - 公司代號：3位數字
   - 列印代號：2位英數字

## 六、錯誤處理
- 錯誤訊息顯示位置：第22行
- 錯誤訊息格式：MSGID(&ERRID &ERRF)
- 錯誤類型：
  - 必填欄位未輸入
  - 資料格式錯誤
  - 會計科目不存在
  - 公司代號無效
  - 列印代號無效

## 七、使用說明
1. 查詢條件設定：
   - 輸入會計科目代號
   - 輸入會計年度
   - 輸入會計期間
   - 輸入傳票號碼範圍
   - 輸入日期範圍
   - 選擇公司代號
   - 選擇列印代號

2. 功能操作說明：
   - 使用PF3返回前頁
   - 使用PF4列印資料
   - 使用PF14進行批次處理

3. 注意事項：
   - 會計科目必須為有效值
   - 會計年度和期間必須合理
   - 公司代號必須存在
   - 列印代號必須有效
   - 日期範圍必須合理 