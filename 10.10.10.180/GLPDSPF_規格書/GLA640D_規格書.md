# GLA640D 螢幕顯示檔規格書

## 一、基本資訊
- 檔案名稱：GLA640D
- 檔案類型：螢幕顯示檔
- 來源目錄：10.10.10.180/QDDSSRC_GLPLIB
- 程式說明：預算科目批次處理
- 系統：會計總帳系統
- 子系統：會計總帳系統
- 作者：A1150
- 建立日期：1992.12.09
- 更新日期：

## 二、螢幕規格
- 顯示大小：24x80
- 參考檔案：GLRF
- 螢幕代號：GLA640.1/GLA640.2
- 訊息位置：第22行
- 列印功能：支援
- 條件指示器：
  - CA03(03)：主畫面顯示控制
  - CF14(14)：批次處理控制

## 三、螢幕佈局

### 1. 主畫面 (GLA640.1)
```
<GLA640.1>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                預算科目批次處理                 時間: [時間]

來源公司代號: [   ]
年度      : [   ]
成長率    : [     ]%
科目範圍  : [   ] - [   ]
期間範圍  : [      ] - [      ]

目標公司代號: [   ]
年度      : [   ]
月份      : [   ]

處理選項: [ ] ( 1.預算科目批次處理
                2.預算科目批次處理允許通過檢查
                3.預算科目批次處理是否允許)

-----------------------------------------
[錯誤訊息顯示區域]
注意    PF3 =返回前頁    PF14=批次處理
                                                           【茂世資訊】
```

### 2. 明細畫面 (GLA640.2)
```
<GLA640.2>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                預算科目批次處理                 時間: [時間]

科目範圍  : [   ]
科目名稱  : [                              ]
期間範圍  : [      ]
科目名稱  : [                              ]
是否允許  : [ ] (Y/N)

[錯誤訊息顯示區域]
注意    PF3 =返回前頁    PF14=批次處理
                                                           【茂世資訊】
```

## 四、記錄格式

### 1. 主畫面 (DSPD1)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| CONAME | 1,25 | 32 | A | O | 公司名稱 |
| DDATE | 1,72 | 6 | Y | O | 系統日期 |
| $USERN | 2,2 | 10 | A | O | 使用者代號 |
| DAI01 | 4,18 | - | R | B | 來源公司代號 |
| DAI02 | 5,18 | 3 | Y | B | 來源年度 |
| DFLD1 | 6,18 | 7 | Y | B | 成長率 |
| DAI03F | 7,18 | - | R | B | 科目範圍開始 |
| DAI03T | 7,29 | - | R | B | 科目範圍結束 |
| DAI04F | 8,18 | 6 | - | B | 期間範圍開始 |
| DAI04T | 8,29 | 6 | - | B | 期間範圍結束 |
| DAU01 | 10,18 | - | R | B | 目標公司代號 |
| DAU02 | 11,18 | 3 | Y | B | 目標年度 |
| DAU03 | 12,18 | - | R | B | 目標月份 |
| DOPT | 15,18 | 1 | Y | B | 處理選項 |

### 2. 明細畫面 (DSPD2)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| DAU04 | 17,17 | - | R | O | 科目範圍 |
| AF03 | 17,26 | - | R | O | 科目名稱 |
| DAU05 | 18,17 | - | R | O | 期間範圍 |
| #A02 | 18,26 | - | R | O | 科目名稱 |
| COVE | 19,17 | 1 | A | B | 是否允許 |

## 五、功能鍵說明
- PF3：返回前頁
- PF14：批次處理

## 六、輸入欄位驗證
1. 必填欄位：
   - 來源公司代號 (DAI01)
   - 來源年度 (DAI02)
   - 成長率 (DFLD1)
   - 科目範圍 (DAI03F, DAI03T)
   - 期間範圍 (DAI04F, DAI04T)
   - 目標公司代號 (DAU01)
   - 目標年度 (DAU02)
   - 目標月份 (DAU03)
   - 處理選項 (DOPT)

2. 資料格式：
   - 公司代號：必須為有效公司代號
   - 年度：必須為有效年度
   - 成長率：必須為有效百分比
   - 科目範圍：必須為有效科目代號
   - 期間範圍：必須為有效期間
   - 月份：必須為1-12
   - 處理選項：必須為1,2,3
   - 是否允許：必須為Y或N

## 七、錯誤處理
- 錯誤訊息顯示位置：第22行
- 錯誤訊息格式：MSGID(&ERRID &ERRF)
- 錯誤類型：
  - 必填欄位未輸入
  - 資料格式錯誤
  - 公司代號不存在
  - 年度不合理
  - 成長率不合理
  - 科目範圍不存在
  - 期間範圍不合理
  - 月份不合理
  - 處理選項錯誤

## 八、使用說明
1. 查詢條件設定：
   - 輸入來源公司代號
   - 輸入來源年度
   - 輸入成長率
   - 輸入科目範圍
   - 輸入期間範圍
   - 輸入目標公司代號
   - 輸入目標年度
   - 輸入目標月份
   - 選擇處理選項

2. 功能操作說明：
   - 使用PF3返回前頁
   - 使用PF14進行批次處理

3. 注意事項：
   - 公司代號必須為有效值
   - 年度必須為有效年度
   - 成長率必須為有效百分比
   - 科目範圍必須存在
   - 期間範圍必須合理
   - 月份必須為1-12
   - 處理選項必須為1,2,3
   - 是否允許必須為Y或N 