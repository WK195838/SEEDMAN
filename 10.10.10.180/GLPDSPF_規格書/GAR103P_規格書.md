# GAR103P 列印檔案規格書

## 基本資訊
- 檔案名稱: GAR103P
- 檔案類型: 列印檔案 (PRTF)
- 來源目錄: QDDSSRC_GLPLIB
- 程式說明: 參數日曆系統管理測試報表
- 系統: 總帳系統

## 參考檔案
- 參考檔案: GAWF04 (工作檔參考欄位定義檔)

## 報表結構
報表包含四個記錄格式：
1. PH1: 報表標題與欄位標頭
2. PD1: 明細資料記錄
3. PT1: 合計線
4. PE9: 無資料訊息

## 報表佈局

### 標題區域 (PH1)
```
[公司名稱]
                                     (跳過2行)
參數日曆系統測試報表
                                     (跳過2行)
                                                  日期: [系統日期]
                                                  頁次: [頁碼]
                                                  時間: [時間]    <GAR103P>
========================================================
公司    參數日期     參數代碼數量        參數記錄數量
--------------------------------------------------------
```

### 明細區域 (PD1)
```
[公司代碼] [參數日期]      [參數代碼數量]         [參數記錄數量]
```

### 合計線 (PT1)
```
========================================================
```

### 無資料訊息 (PE9)
```
                無符合條件之資料
```

## 記錄格式詳細說明

### PH1 (標題與欄位標頭格式)
- 跳過前2行 (SKIPB(2))
- 每行間距設定使用SPACEA()控制

| 欄位名稱 | 參考欄位 | 說明 | 位置 | 編輯碼/格式 | 備註 |
|---------|---------|------|------|------------|------|
| #B03 | PTRF.#B03 | 公司名稱 | 1,1 | - | - |
| PDATE | - | 日期 | 1,54 | EDTCDE(Y) | 長度6,0 |
| PAGNBR | - | 頁碼 | 1,71 | EDTCDE(4) | 系統頁碼 |
| TIME | - | 時間 | 1,54 | EDTWRD('  :  :  ') | 系統時間 |

### PD1 (明細資料格式)
- 每筆資料間距設定使用SPACEA(1)控制

| 欄位名稱 | 參考欄位 | 說明 | 位置 | 編輯碼/格式 | 條件指示器 |
|---------|---------|------|------|------------|-----------|
| WF0401 | GAWF04.WF0401 | 公司代碼 | 1,2 | - | - |
| WF0402 | GAWF04.WF0402 | 參數日期 | 1,11 | EDTWRD('    /  /  ') | - |
| WF0403 | GAWF04.WF0403 | 參數代碼數量 | 1,35 | EDTCDE(1) | - |
| WF0404 | GAWF04.WF0404 | 參數記錄數量 | 1,65 | EDTCDE(1) | - |

### PT1 (合計線格式)
- 顯示報表的分隔線
- 跳行顯示 (SPACEA(1))

### PE9 (無資料訊息格式)
- 跳行顯示 (SPACEA(1))
- 顯示訊息: "無符合條件之資料"

## 編輯碼說明
| 編輯碼 | 說明 |
|-------|------|
| EDTCDE(Y) | 西元年月日格式 (YYMMDD) |
| EDTCDE(1) | 數值格式，含千位分隔符無小數點 |
| EDTCDE(4) | 無前導零、無千位分隔符的數值格式 |
| EDTWRD('    /  /  ') | 自訂日期格式，以斜線分隔 |
| EDTWRD('  :  :  ') | 自訂時間格式，以冒號分隔 |

## 資料流程
1. 報表首先印出標題區域 (PH1)，顯示報表名稱
2. 如有符合條件的資料，則印出資料明細 (PD1)，每筆資料占用一行
3. 資料尾端印出合計線 (PT1)
4. 如果沒有符合條件的資料，則印出無資料訊息 (PE9)

## 使用說明
1. 此報表用於顯示參數日曆系統狀態統計
2. 報表可由GAR103D螢幕程式產生
3. 報表顯示每個公司的參數代碼數量與參數記錄數量統計
4. 適合系統管理人員查看系統資料量與使用狀況

## 報表欄位說明
1. 公司代碼 (WF0401): 顯示公司別代碼
2. 參數日期 (WF0402): 顯示參數資料的日期
3. 參數代碼數量 (WF0403): 顯示該公司在指定參數日期下的參數代碼總數
4. 參數記錄數量 (WF0404): 顯示該公司在指定參數日期下的參數記錄總數

## 報表與螢幕的對應關係
- 此報表由GAR103D螢幕產生
- 提供系統管理者全面性的參數日曆系統統計報表
- 不同於GAR101P和GAR102P，此報表著重於系統層面的整體統計數據

## 備註
- 此報表主要用於系統管理與監控用途
- 報表中的數量欄位使用EDTCDE(1)格式，僅顯示整數部分
- 參數日期欄位使用標準格式化顯示，提高可讀性
- 此報表與整個參數日曆系統管理功能配合使用 