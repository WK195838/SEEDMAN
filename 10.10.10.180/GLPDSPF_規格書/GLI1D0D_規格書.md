# GLI1D0D 螢幕顯示檔規格書

## 一、基本資訊
- 檔案名稱：GLI1D0D
- 檔案類型：螢幕顯示檔
- 來源目錄：10.10.10.180/QDDSSRC_GLPLIB
- 程式說明：預算科目值查詢
- 系統：會計總帳系統
- 子系統：會計總帳系統
- 作者：A1150
- 建立日期：81/11/17
- 更新日期：

## 二、螢幕規格
- 顯示大小：24x80
- 參考檔案：GLFLIB/GLRF
- 螢幕代號：GLI1D0.1/GLI1D0.2
- 訊息位置：第22行
- 列印功能：支援
- 條件指示器：
  - CA03：畫面控制
  - CF05：畫面控制
  - CF12：畫面控制
  - 60：欄位顯示控制
  - 99：錯誤訊息控制

## 三、螢幕佈局

### 主畫面 (GLI1D0.1)
```
<GLI1D0.1>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                    預算科目值查詢                   時間: [時間]

公司代號: [    ]
---------------------------------------------------------
[錯誤訊息顯示區域]
注意    PF3 =返回前頁
                                                           【茂世資訊】
```

### 明細畫面 (GLI1D0.2)
```
<GLI1D0.2>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                    預算科目值查詢                   時間: [時間]

公司代號: [    ] [公司名稱]
---------------------------------------------------------
01. 是否為部門科目    : [    ] (Y/N)
02. 預算科目代號起   : [    ] [科目名稱]
03. 預算科目代號迄   : [    ] [科目名稱]
04. 預算年度起       : [    ] [年度名稱]
05. 預算年度迄       : [    ] [年度名稱]
06. 預算類別         : [    ] (1.部門預算 2.專案預算)
07. 預算期間類別     : [    ] (1.十二個月 2.十三個月)
08. 預算格式         : [    ] (1.月預算 2.季預算 3.年預算)
09. 預算科目日期     : [  /  /  ]
10. 預算科目期間     : [    -  ]
11. 預算科目月份     : [    ]
---------------------------------------------------------
[錯誤訊息顯示區域]
注意    PF3 =返回前頁    PF12=返回前頁
                                                           【茂世資訊】
```

## 四、記錄格式

### 主畫面 (DSPD1)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| CONAME | 1,25 | 32 | A | O | 公司名稱 |
| DDATE | 1,72 | 6 | Y | O | 系統日期 |
| $USERN | 2,2 | 10 | A | O | 使用者ID |
| DAK01 | 4,14 | - | R | B | 公司代號 |

### 明細畫面 (DSPD2)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| CONAME | 1,25 | 32 | A | O | 公司名稱 |
| DDATE | 1,72 | 6 | Y | O | 系統日期 |
| $USERN | 2,2 | 10 | A | O | 使用者ID |
| DAK01 | 4,14 | - | R | O | 公司代號 |
| D#B02 | 4,19 | 12 | A | O | 公司名稱 |
| DAK02 | 7,26 | - | R | O | 是否為部門科目 |
| DAK04 | 8,26 | - | R | O | 預算科目代號起 |
| DAF031 | 8,36 | - | R | O | 科目名稱起 |
| DAK05 | 9,26 | - | R | O | 預算科目代號迄 |
| DAF032 | 9,36 | - | R | O | 科目名稱迄 |
| DAK07 | 10,26 | - | R | O | 預算年度起 |
| DAD031 | 10,36 | - | R | O | 年度名稱起 |
| DAK08 | 11,26 | - | R | O | 預算年度迄 |
| DAD032 | 11,36 | - | R | O | 年度名稱迄 |
| DAK09 | 12,26 | - | R | O | 預算類別 |
| DAK10 | 13,26 | - | R | O | 預算期間類別 |
| DAK11 | 14,26 | - | R | O | 預算格式 |
| DAK12 | 16,26 | 7 | Y | O | 預算科目日期 |
| DAK14 | 17,26 | 6 | Y | O | 預算科目期間 |
| DAK13 | 18,26 | 4 | Y | O | 預算科目月份 |

## 五、功能鍵說明
- PF3：返回前頁
- PF12：返回前頁

## 六、輸入欄位驗證
1. 必填欄位：
   - 公司代號 (DAK01)

2. 資料格式：
   - 公司代號：必須為有效公司代號
   - 部門科目：必須為Y或N
   - 預算科目代號：必須為有效科目代號
   - 預算年度：必須為有效年度
   - 預算類別：必須為1或2
   - 預算期間類別：必須為1或2
   - 預算格式：必須為1-3
   - 日期格式：必須為有效日期格式 (YY/MM/DD)
   - 期間格式：必須為有效期間格式 (MM-MM)
   - 月份：必須為有效月份 (1-12)

## 七、錯誤處理
- 錯誤訊息顯示位置：第22行
- 錯誤訊息格式：
  - MSGID(&ERRID &ERRF)：動態錯誤訊息
- 錯誤類型：
  - 必填欄位未輸入
  - 資料格式錯誤
  - 公司代號不存在
  - 科目代號不存在
  - 年度不存在
  - 查詢條件不合理

## 八、使用說明
1. 查詢條件設定：
   - 輸入公司代號
   - 選擇是否為部門科目
   - 設定預算科目代號範圍
   - 設定預算年度範圍
   - 選擇預算類別
   - 選擇預算期間類別
   - 選擇預算格式
   - 設定預算科目日期
   - 設定預算科目期間
   - 設定預算科目月份

2. 功能操作說明：
   - 使用PF3返回前頁
   - 使用PF12返回前頁

3. 注意事項：
   - 公司代號必須為有效值
   - 部門科目必須為Y或N
   - 預算科目代號必須為有效值
   - 預算年度必須為有效值
   - 預算類別必須為1或2
   - 預算期間類別必須為1或2
   - 預算格式必須為1-3
   - 日期格式必須正確 (YY/MM/DD)
   - 期間格式必須正確 (MM-MM)
   - 月份必須為1-12 