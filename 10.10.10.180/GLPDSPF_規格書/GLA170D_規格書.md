# GLA170D 螢幕顯示檔案規格書

## 基本資訊
- 檔案名稱：GLA170D
- 檔案類型：螢幕顯示檔案 (DSPF)
- 來源目錄：QDDSSRC_GLPLIB
- 程式說明：部門餘額表
- 系統：茂世會計系統
- 子系統：總帳系統
- 作者：JOYCE (A1087)
- 建立日期：1992.11.06
- 更新日期：無

## 螢幕規格
- 顯示大小：24x80
- 參考檔案：GLRF (總帳欄位定義檔)
- 螢幕代號：GLA170.1
- 訊息位置：第22行
- 列印功能：支援
- 條件指示器：CA03(03), CF04(04), CF14(14), CF18(18)

## 螢幕佈局
```
<GLA170.1>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                部門餘額表                       時間: [時間]









                         部門代號: [  ] - [  ]

                         部門建立日期: [YYMMDD] (以前)

                         部門類別: [  ] (*ALL:全部)









                         預設餘額日期: [YYMMDD] (日)













                         列印份數: [   ]

                         列印代號: [  ]

[處理訊息顯示區域]

[部門資料清單]
序號  部門代號  部門名稱                          建立日期  結束日期  期初餘額  期末餘額
----  --------  ------------------------------  --------  --------  --------  --------
[1]   [  ]      [                              ]  [      ]  [      ]  [        ]  [        ]
[2]   [  ]      [                              ]  [      ]  [      ]  [        ]  [        ]
[3]   [  ]      [                              ]  [      ]  [      ]  [        ]  [        ]
[4]   [  ]      [                              ]  [      ]  [      ]  [        ]  [        ]
[5]   [  ]      [                              ]  [      ]  [      ]  [        ]  [        ]
[6]   [  ]      [                              ]  [      ]  [      ]  [        ]  [        ]
[7]   [  ]      [                              ]  [      ]  [      ]  [        ]  [        ]
[8]   [  ]      [                              ]  [      ]  [      ]  [        ]  [        ]
[9]   [  ]      [                              ]  [      ]  [      ]  [        ]  [        ]
[10]  [  ]      [                              ]  [      ]  [      ]  [        ]  [        ]

[錯誤訊息顯示區域]
注意    PF3 =返回前頁    PF4 =查詢資料    PF14=批次處理    PF18=部門查詢
                                                           【茂世資訊】
```

## 記錄格式
### DSPD1 - 主畫面
- 游標位置控制
- 條件指示器：CA03(03), CF04(04), CF14(14), CF18(18)
- 強制資料顯示
- 鎖定模式
- 標題：<GLA170.1>
- 公司名稱：CONAME (32A, 輸出)
- 日期：DDATE (6Y, 輸出, 日期格式)
- 使用者：$USERN (10A, 輸出)

### 輸入欄位
1. 部門代號 (DAH01)
   - 參考欄位：AH01
   - 位置：6,40
   - 條件指示器：60
   - 必填欄位

2. 部門建立日期 (DAH10)
   - 參考欄位：AH10
   - 位置：8,40
   - 格式：7位數字，日期格式
   - 條件指示器：61
   - 說明：8,50 (以前)

3. 部門類別 (DAH17)
   - 參考欄位：AH17
   - 位置：9,40
   - 條件指示器：62
   - 高亮度顯示
   - 備註：可輸入*ALL表示全部

4. 預設餘額日期 (DAK12)
   - 參考欄位：AK12
   - 位置：11,41
   - 格式：7位數字，日期格式
   - 說明：11,51 (日)

5. 列印設定
   - 列印份數 ($CPY)：16,39
     - 格式：3位數字
     - 必填欄位
   - 列印代號 ($PRTCD)：17,39
     - 格式：2位字元
     - 高亮度顯示

### 子檔案格式
1. SFLSRD/SFLCRD - 上層子檔案
   - 子檔案大小：60筆
   - 每頁顯示：10筆
   - 條件指示器：50,51,52
   - 欄位：
     - 序號 (RRND)
     - 部門代號 (DAH01D)
     - 部門相關欄位 (DAH04D 至 DAH16D)

2. SFLSRC/SFLCRC - 下層子檔案
   - 子檔案大小：60筆
   - 每頁顯示：10筆
   - 條件指示器：50,51,52
   - 欄位：同上層子檔案

## 訊息顯示
1. 錯誤訊息 (ERRMSG)
   - 位置：22,2
   - 格式：70A
   - 條件指示器：99
   - 高亮度顯示

2. 處理訊息
   - 位置：21,28
   - 條件指示器：27,28
   - 顯示處理狀態和進度

## 功能鍵說明
| 功能鍵 | 說明 |
|-------|------|
| PF3 | 返回前頁 |
| PF4 | 查詢資料 |
| PF14 | 批次處理 |
| PF18 | 部門查詢 |

## 輸入欄位驗證
1. 部門代號 (DAH01)
   - 必填欄位
   - 格式：需符合部門代碼表

2. 部門建立日期 (DAH10)
   - 格式：YYYY/MM/DD
   - 需為有效日期

3. 部門類別 (DAH17)
   - 格式：需符合部門類別代碼表
   - 可輸入*ALL表示全部

4. 預設餘額日期 (DAK12)
   - 格式：YYYY/MM/DD
   - 需為有效日期

5. 列印份數 ($CPY)
   - 必填欄位
   - 格式：3位數字
   - 範圍：1-999

## 錯誤處理
1. 錯誤訊息顯示位置：第22行
2. 錯誤訊息類型：
   - 必填欄位未填
   - 資料格式錯誤
   - 日期格式錯誤
   - 部門代號錯誤
   - 系統錯誤

## 使用說明
1. 查詢條件設定：
   - 可設定部門代號
   - 可設定部門建立日期
   - 可指定部門類別
   - 可設定預設餘額日期

2. 列印設定：
   - 可設定列印份數
   - 可選擇列印代號

3. 功能操作：
   - 可進行資料查詢
   - 可進行批次處理
   - 可進行部門查詢
   - 可返回前頁

4. 子檔案操作：
   - 上層子檔案顯示主要資料
   - 下層子檔案顯示明細資料
   - 每頁顯示10筆資料
   - 可上下捲動瀏覽 