# GAR302P 列印檔案規格書

## 基本資訊
- 檔案名稱: GAR302P
- 檔案類型: 列印檔案 (PRTF)
- 來源目錄: QDDSSRC_GLPLIB
- 程式說明: 部門資料列印
- 系統: 台塑三井精密化學
- 子系統: 總帳系統
- 作者: MERCURY
- 建立日期: 83/01/28

## 參考檔案
- 參考檔案: GLRF (引用總帳參考欄位定義檔)

## 報表結構
報表包含五個記錄格式：
1. PH1: 報表標題與欄位標頭
2. PD1: 部門資料明細記錄
3. PE1: 完成分隔線與訊息
4. PE2: 處理完成訊息
5. PE3: 無資料訊息

## 報表佈局

### 標題區域 (PH1)
```
                      [公司名稱]
                      部門資料列印
                                            日期: [系統日期]  頁次: [頁碼]
                                            時間: [時間]
部門號: [起始部門] - [結束部門]              USER : [使用者ID]  <GAR302>
===========================================================================
部門代號　　部門名稱                        部門代號　　部門名稱
---------------------------------------------------------------------------
```

### 明細資料區域 (PD1)
```
[部門代號]  [部門名稱]                      [部門代號]  [部門名稱]
```

### 完成訊息 (PE1)
```
===========================================================================
 ***完成***
```

### 處理完成訊息 (PE2)
```
===========================================================================
 <<GAR302>>--->產生完成
```

### 無資料訊息 (PE3)
```
   查詢此條件無任何資料
```

## 記錄格式詳細說明

### PH1 (標題與欄位標頭格式)
- 跳過前2行 (SKIPB(2))
- 每行間距設定使用SPACEA()控制

| 欄位名稱 | 參考欄位 | 說明 | 位置 | 編輯碼/格式 | 備註 |
|---------|---------|------|------|------------|------|
| - | - | 公司名稱 | 22 | MSGCON(030 URE9999 REMF) | - |
| - | - | 部門資料列印 | 29 | - | 報表標題 |
| $EGMDY | - | 系統日期 | 52 | EDTCDE(Y) | 長度6,0 |
| PAGNBR | - | 頁碼 | 68 | EDTCDE(Z) | 系統頁碼 |
| - | - | 時間 | 52 | TIME | 系統時間 |
| DAW01S | AW01 | 起始部門號 | 11 | - | 參考欄位AW01 |
| DAW01E | AW01 | 結束部門號 | 17 | - | 參考欄位AW01 |
| $USER | - | 使用者ID | 52 | - | 長度10 |

### PD1 (明細資料格式)
- 每筆資料間距設定使用SPACEA(1)控制
- 指示器20控制空行輸出
- 指示器30控制欄位顯示

| 欄位名稱 | 參考欄位 | 說明 | 位置 | 編輯碼/格式 | 條件 | 備註 |
|---------|---------|------|------|------------|------|------|
| AW01 | AW01 | 部門代號 | 2 | - | N30 | 左側部門代號 |
| #B02A | PTRF.#B02 | 部門名稱 | 12 | - | N30 | 左側部門名稱 |
| AX02 | AX02 | 部門代號 | 39 | - | - | 右側部門代號 |
| #B02B | PTRF.#B02 | 部門名稱 | 48 | - | - | 右側部門名稱 |

### PE1, PE2, PE3 (訊息格式)
- 顯示報表的分隔線與完成訊息
- PE3在無符合條件資料時顯示

## 編輯碼說明
| 編輯碼 | 說明 |
|-------|------|
| EDTCDE(Y) | 西元年月日格式 (YYMMDD) |
| EDTCDE(Z) | 數值格式，不帶前導零 |

## 指示器說明
| 指示器 | 說明 | 用途 |
|-------|------|------|
| 20 | 空行控制 | 在明細記錄中控制是否輸出空行 |
| 30 | 左欄顯示控制 | 控制左側部門資料的顯示與否 |

## 資料流程
1. 報表首先印出標題區域 (PH1)，顯示報表名稱與查詢條件
2. 如有符合條件的資料，則印出部門明細資料 (PD1)
   - 採用雙欄並列格式，提高資料密度
   - 使用指示器控制左右欄資料的顯示邏輯
3. 處理完成後印出完成訊息 (PE1)
4. 最後印出處理完成訊息 (PE2)
5. 如果沒有符合條件的資料，則印出無資料訊息 (PE3)

## 與螢幕程式的關聯
- 此報表由GAR302D螢幕程式產生
- 報表的部門範圍與螢幕設定的DAW01S及DAW01E欄位相對應
- 依據螢幕的輸出裝置設定($PENV)決定輸出方式
- 根據螢幕的列印份數($CPY)與印表機台號($PRTCD)控制列印參數

## 報表特性
1. 報表採用雙欄並列布局，增加資料密度與閱讀效率
2. 透過指示器20控制空行的輸出，使報表格式更加美觀
3. 透過指示器30控制雙欄布局的資料流向，確保資料正確展示
4. 部門資料包含部門代號與名稱兩項主要資訊
5. 參考PTRF檔案獲取部門名稱資訊

## 備註
- 此報表為台塑三井精密化學總帳系統的標準報表
- 部門資料來自相關部門主檔
- 雙欄並列布局允許在一頁中展示更多部門資訊
- 使用標準的報表結構與格式，便於閱讀與資料查找 