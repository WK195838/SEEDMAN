# GLA340D 螢幕顯示檔案規格書

## 基本資訊
- 檔案名稱：GLA340D
- 檔案類型：螢幕顯示檔案 (DSPF)
- 來源目錄：QDDSSRC_GLPLIB
- 程式說明：會計科目設定處理畫面
- 系統：茂世會計系統
- 子系統：總帳系統
- 作者：JOYCE (A1087)
- 建立日期：1992.11.05
- 更新日期：無

## 螢幕規格
- 顯示大小：24x80
- 參考檔案：GLRF (總帳欄位定義檔)
- 訊息位置：第22行
- 列印功能：支援
- 條件指示器：CA03(03), CF18(18)

## 記錄格式
### DSPD1 - 主畫面
- 條件指示器：CA03(03), CF18(18)
- 標題：<GLA340.1>
- 公司名稱：CONAME (32A, 輸出)
- 日期：DDATE (6Y, 輸出, 日期格式)
- 使用者：$USERN (10A, 輸出)

### 輸入欄位
1. 公司代號 (DAP01)
   - 位置：3,16
   - 參考欄位：AP01
   - 條件指示器：67
   - 顯示屬性：PC, RI

2. 會計科目 (DAP02)
   - 位置：4,16
   - 參考欄位：AP02
   - 條件指示器：68
   - 顯示屬性：PC, RI

3. 會計科目名稱 (DAF031)
   - 位置：4,25
   - 參考欄位：AF03

4. 會計科目類別 (DAP04)
   - 位置：5,16
   - 參考欄位：AP04
   - 條件指示器：69
   - 顯示屬性：PC, RI

5. 會計科目說明 (DAP03)
   - 位置：5,63
   - 參考欄位：AP03
   - 條件指示器：70
   - 顯示屬性：PC, RI

6. 會計科目類型 (DAP05)
   - 位置：6,16
   - 參考欄位：AP05
   - 值：'1'/'2'
   - 條件指示器：71
   - 顯示屬性：PC, RI

7. 會計科目日期 (DAP06)
   - 位置：6,63
   - 參考欄位：AP06
   - 編輯碼：日期格式
   - 條件指示器：72
   - 顯示屬性：PC, RI

8. 會計科目編號 (DAP07)
   - 位置：7,16
   - 參考欄位：AP07

### SFLSR - 子檔案記錄
- 選項 (DOPT)：1A, 值：' ', '1', '2', '4', '5'
- 記錄編號 (RRN)：3Y
- 會計科目資料欄位：
  - DAQ031-DAQ161 (會計科目相關資料)
  - DAQ121 (會計科目比率)

### SFLCR - 子檔案控制
- 子檔案大小：120筆
- 每頁顯示：4筆
- 條件指示器：CA03(03), CF06(06), CF12(12), CF13(13)
- 覆蓋顯示
- 保護模式
- 訊息ID：CPF5203

### DSPD3 - 會計科目資料畫面
- 游標位置控制：#LIN, #COL
- 條件指示器：CA03(03), CF04(04), CF05(05), CF12(12)
- 覆蓋顯示

### 會計科目資料欄位
1. 會計科目代號 (DAQ03)
   - 位置：9,16
   - 參考欄位：AQ03
   - 編輯碼：4

2. 會計科目名稱 (DAQ04)
   - 位置：10,16
   - 參考欄位：AQ04
   - 條件指示器：73, 99
   - 顯示屬性：HI, PC, RI

3. 會計科目比率 (DAQ12)
   - 位置：11,16
   - 參考欄位：AQ12
   - 編輯碼：比率格式
   - 顯示屬性：CS
   - 檢查：RB

### DSPD4 - 會計科目明細畫面
- 游標位置控制：#LIN, #COL
- 條件指示器：CA03(03), CF04(04), CF05(05), CF12(12)
- 覆蓋顯示
- 保護模式
- 強制資料顯示
- 鎖定模式

### 會計科目明細欄位
1. 會計科目代號 (DAA031-DAA037)
   - 位置：13-19,8
   - 參考欄位：AA03
   - 條件指示器：55-59

2. 會計科目名稱 (DAQ05-DAQ15)
   - 位置：13-19,31
   - 參考欄位：AQ05-AQ15
   - 條件指示器：60-66

3. 會計科目說明 (DAQ051-DAQ151)
   - 位置：13-19,53
   - 格式：20A

4. 會計科目類別 (DAQ22)
   - 位置：20,31
   - 參考欄位：AQ22
   - 條件指示器：99, 31
   - 顯示屬性：HI, PR

5. 備註 (DAQ16)
   - 位置：21,31
   - 參考欄位：AQ16
   - 條件指示器：31
   - 顯示屬性：PR

## 訊息顯示
1. 錯誤訊息 (ERRMSG)
   - 位置：22,2
   - 格式：70A
   - 條件指示器：99
   - 高亮度顯示

2. 處理訊息 (DMSG)
   - 位置：22,2
   - 格式：78A
   - 條件指示器：98
   - 高亮度顯示

## 功能鍵說明
| 功能鍵 | 說明 |
|-------|------|
| PF2 | 開始處理 |
| PF3 | 返回前頁 |
| PF4 | 查詢資料 |
| PF5 | 開始處理 |
| PF6 | 會計科目設定處理 |
| PF12 | 返回前一頁 |
| PF13 | 會計科目設定刪除 |
| PF18 | 開始查詢資料 |

## 輸入欄位驗證
1. 公司代號 (DAP01)
   - 必填欄位
   - 需為有效公司代號

2. 會計科目 (DAP02)
   - 必填欄位
   - 需為有效會計科目

3. 會計科目類別 (DAP04)
   - 必填欄位
   - 需為有效會計科目類別

4. 會計科目類型 (DAP05)
   - 必填欄位
   - 值需為 '1' 或 '2'

5. 會計科目日期 (DAP06)
   - 必填欄位
   - 需為有效日期格式

## 錯誤處理
1. 錯誤訊息顯示位置：第22行
2. 錯誤訊息類型：
   - 必填欄位未填
   - 資料格式錯誤
   - 公司代號錯誤
   - 會計科目錯誤
   - 系統錯誤

## 使用說明
1. 查詢條件設定：
   - 需輸入公司代號
   - 需輸入會計科目
   - 需輸入會計科目類別
   - 需輸入會計科目類型
   - 需輸入會計科目日期

2. 會計科目資料維護：
   - 可輸入會計科目基本資料
   - 可設定會計科目比率
   - 可設定會計科目說明

3. 功能操作：
   - 可進行資料查詢
   - 可進行資料處理
   - 可進行會計科目設定
   - 可進行會計科目刪除
   - 可返回前頁

4. 注意事項：
   - 公司代號、會計科目和會計科目類別為必填欄位
   - 會計科目類型需設定為 1 或 2
   - 會計科目日期需為有效日期
   - 處理完成後會顯示處理結果 