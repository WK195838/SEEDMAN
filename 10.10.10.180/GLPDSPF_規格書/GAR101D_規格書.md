# GAR101D 螢幕顯示檔案規格書

## 基本資訊
- 檔案名稱: GAR101D
- 檔案類型: 顯示檔案 (DSPF)
- 來源目錄: QDDSSRC_GLPLIB
- 程式說明: 參數日曆檔案列印作業
- 系統: 總帳系統

## 螢幕規格
- 顯示大小: 24行 x 80列
- 參考檔案: *LIBL/GLRF (引用總帳參考欄位定義檔)
- 螢幕代號: GAR101.1

## 記錄格式
- 記錄格式名稱: DSPD1
- 功能鍵設定: 
  - CA03(03) - 返回主畫面
  - CF04(04) - 查詢
  - CF14(14) - 處理
- 游標位置: CSRLOC(#LIN #COL)

## 螢幕佈局
```
<GAR101.1>                     [公司名稱]                        [日期]
[使用者ID]                   參數日曆產生報表輸出

                         公司別  : [   ]

                         建檔日期: [  /  /  ] - [  /  /  ]

                         參數日期: [  /  /  ] - [  /  /  ]

                         參數代碼: [      ] - [      ]

                         建檔人  : [          ] (可空白代表*ALL )

                         參數來源: [  ] (可空白代表*ALL )

                         顯示內容: [  ] 1.英文版
                                       2.中文版
                                       3.全部

                         輸出裝置: [ ] (0-螢幕 1-印表 2-檔案)

                         列印份數: [   ]

                         列印機台: [  ]


[錯誤訊息顯示區域]
注意    PF3 =回主畫面    PF4 =重新查詢    PF14 =處理作業
                                                           【茂世資訊】
```

## 欄位規格
| 欄位名稱 | 參考欄位 | 說明 | 資料型態 | 長度 | 輸入/輸出 | 屬性 | 編輯碼/格式 |
|---------|---------|------|---------|------|---------|------|------------|
| #LIN | - | 游標行位置 | 數值 | 3,0 | H | - | - |
| #COL | - | 游標列位置 | 數值 | 3,0 | H | - | - |
| CONAME | - | 公司名稱 | 字元 | 32 | O | - | 訊息ID: US# 9001 S#MF |
| DDATE | - | 系統日期 | 數值 | 6,0 | O | - | EDTCDE(Y) |
| $USERN | - | 使用者ID | 字元 | 10 | O | - | - |
| DAH01 | AH01 | 公司別 | 字元 | - | B | 條件PC,RI(61) | - |
| D25F | AH25 | 建檔日期(起) | 數值 | - | B | 條件PC,RI(62) | EDTWRD('   /  /  ') |
| D25T | AH25 | 建檔日期(迄) | 數值 | - | B | 條件PC,RI(63) | EDTWRD('   /  /  ') |
| D10F | AH10 | 參數日期(起) | 數值 | - | B | 條件PC,RI(64) | EDTWRD('   /  /  ') |
| D10T | AH10 | 參數日期(迄) | 數值 | - | B | 條件PC,RI(65) | EDTWRD('   /  /  ') |
| DAH02F | AH02 | 參數代碼(起) | 字元 | - | B | 條件PC,RI(66) | - |
| DAH02T | AH02 | 參數代碼(迄) | 字元 | - | B | 條件PC,RI(66) | - |
| DAH26 | AH26 | 建檔人 | 字元 | - | B | - | - |
| DAH17 | AH17 | 參數來源 | 字元 | - | B | 條件HI(非99) | - |
| DAH19 | AH19 | 顯示內容 | 字元 | - | B | 條件PC,RI(67) | - |
| $PENV | - | 輸出裝置 | 字元 | 1 | B | - | VALUES('0', '1', '2') |
| $CPY | - | 列印份數 | 數值 | 3,0 | B | - | EDTCDE(3), CHECK(RB) |
| $PRTCD | - | 列印機台 | 字元 | 2 | B | 條件HI(非99) | - |
| ERRID | - | 錯誤訊息ID | 字元 | 7 | H | - | - |
| ERRF | - | 錯誤訊息檔案 | 字元 | 10 | H | - | - |
| ERRMSG | - | 錯誤訊息內容 | 字元 | 70 | O | HI | MSGID(&ERRID &ERRF) |

## 條件指示器
| 指示器 | 說明 | 用途 |
|-------|------|------|
| 28 | 強制資料輸入指示 | 控制FRCDTA與LOCK屬性 |
| 27 | 錯誤訊息顯示指示 | 控制「請正確輸入各欄位資料」訊息 |
| 61-67 | 欄位錯誤指示 | 控制特定欄位的PC與RI屬性 |
| 99 | 隱藏條件指示 | 控制特定欄位的高亮顯示 |

## 功能鍵
| 功能鍵 | 說明 | 作用 |
|-------|------|------|
| PF3 (CA03) | 回主畫面 | 返回上一層主選單 |
| PF4 (CF04) | 重新查詢 | 清除已輸入的條件 |
| PF14 (CF14) | 處理作業 | 執行報表產生 |

## 輸入欄位檢核
1. 公司別(DAH01): 必要時由指示器61控制高亮顯示
2. 日期欄位(D25F、D25T、D10F、D10T): 使用格式化編輯字(EDTWRD)控制輸入格式
3. 參數代碼(DAH02F、DAH02T): 必要時由指示器66控制高亮顯示
4. 顯示內容(DAH19): 必要時由指示器67控制高亮顯示
5. 輸出裝置($PENV): 限制只能輸入0、1或2
6. 列印份數($CPY): 使用CHECK(RB)只允許數字，使用EDTCDE(3)添加千位分隔符

## 錯誤處理
- 欄位錯誤時使用對應的指示器(61-67)控制欄位高亮顯示
- 整體錯誤透過指示器27顯示「請正確輸入各欄位資料」訊息
- 處理中使用指示器28顯示「正在處理中，請等待」訊息
- 特定錯誤訊息通過ERRMSG欄位與MSGID功能顯示

## 使用說明
1. 此螢幕用於設定參數日曆檔案列印的條件
2. 使用者可輸入各種查詢條件篩選需要列印的資料
3. 可選擇輸出至螢幕、印表機或檔案
4. 按PF3返回主選單，按PF4重新設定查詢條件，按PF14執行處理

## 備註
- 本螢幕採用DS3設備規格
- 部分欄位允許空白，表示查詢全部資料(*ALL)
- 使用指示器28控制處理中的畫面鎖定
- 日期欄位採用標準格式化顯示
- 畫面右下角顯示系統開發公司名稱【茂世資訊】 