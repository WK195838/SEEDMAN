# GLR2A0D 螢幕規格書

## 一、基本資訊
- 檔案名稱：GLR2A0D
- 檔案類型：螢幕顯示檔
- 來源目錄：10.10.10.180/QDDSSRC_GLPLIB
- 程式說明：結帳處理
- 系統：會計系統
- 子系統：總帳系統
- 作者：A1149 MAY
- 建立日期：1992.11.11
- 更新日期：
- 備註：結帳處理螢幕

## 二、螢幕規格
- 顯示大小：24x80
- 參考檔案：*LIBL/GLRF
- 列印功能：支援
- 游標位置：變數(#LIN, #COL)
- 功能鍵設定：
  - PF3：返回
  - PF4：查詢
  - PF14：處理年度

## 三、螢幕佈局

### 主畫面 (GLR2A0.1)
```
<GLR2A0.1>                                                                 [公司名稱] [系統日期]
                                                                        結帳處理
                                                                        [使用者代號]

公司代號: [    ]                                                         
處理選擇: [ ] (1-總帳結帳處理)                                             
         (2-結帳處理)                                                     

會計年度: [   ]                                                          
會計期間: [  ] - [  /  /  ]                                             

處理方式: [ ] (0-查詢 1-結帳 2-反結)                                      
結帳年度: [   ]                                                          
結帳代號: [  ]                                                           

**請輸入結帳處理條件**                                                    
處理中請稍候...                                                          

[錯誤訊息]                                                               
注意                                                                     
PF3 =返回前頁  PF4 =重新查詢  PF14 =處理年度                             
                                                                        茂世科技
```

### 明細畫面 (GLR2A0.2)
```
<GLR2A0.2>                                                                 [公司名稱] [系統日期]
                                                                        結帳處理
                                                                        [使用者代號]

公司代號: [    ] [公司名稱]                                               
會計科目: [    ] [科目名稱]                                               

會計年度: [   ]                                                          
會計期間: [  ] - [  /  /  ]                                             

--------------------   ------------   ---------   --------------------
輸入代號           :    下    上
--------------------   ------------   ---------   --------------------

[科目代號1]: [    ] - [    ]
[科目代號2]: [    ] - [    ]
[科目代號3]: [    ] - [    ]
[科目代號4]: [    ] - [    ]
[科目代號5]: [    ] - [    ]

--------------------   ------------   ---------   --------------------

[錯誤訊息]                                                               
注意                                                                     
PF3 =返回前頁  PF4 =重新查詢  PF12 =返回前頁  PF14 =處理年度             
                                                                        茂世科技
```

## 四、紀錄格式

### 主畫面 (DSPD1)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| CONAME | 1,25 | 32 | A | O | 公司名稱 |
| DDATE | 1,69 | 6 | 0 | O | 系統日期 |
| $USERN | 2,2 | 10 | A | O | 使用者代號 |
| DAH01 | 5,40 | 4 | A | B | 公司代號 |
| DOPT | 7,40 | 1 | A | B | 處理選擇 |
| DYEAR | 9,40 | 3 | 0 | B | 會計年度 |
| DYY | 10,40 | 2 | 0 | B | 會計期間 |
| DYMD | 10,51 | 7 | 0 | B | 會計日期 |
| DSEL | 12,40 | 1 | A | B | 處理方式 |
| $PENV | 15,40 | 1 | A | B | 處理方式 |
| $CPY | 16,40 | 3 | 0 | B | 結帳年度 |
| $PRTCD | 17,40 | 2 | A | B | 結帳代號 |
| ERRMSG | 22,2 | 70 | A | O | 錯誤訊息 |

### 明細畫面 (DSPD2)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| CONAME | 1,25 | 32 | A | O | 公司名稱 |
| DDATE | 1,69 | 6 | 0 | O | 系統日期 |
| $USERN | 2,2 | 10 | A | O | 使用者代號 |
| DAH01 | 4,13 | 4 | A | O | 公司代號 |
| #B02 | 4,14 | 20 | A | O | 公司名稱 |
| DAH04 | 5,13 | 4 | A | O | 會計科目 |
| DAF03 | 5,14 | 20 | A | O | 科目名稱 |
| DYEAR | 4,63 | 3 | 0 | O | 會計年度 |
| DYY | 5,63 | 2 | 0 | O | 會計期間 |
| DYMD | 5,68 | 7 | 0 | O | 會計日期 |
| DAA031 | 9,1 | 4 | A | O | 科目代號1 |
| DAH05S | 9,24 | 4 | A | B | 科目代號1(起) |
| DAH05E | 9,47 | 4 | A | B | 科目代號1(迄) |
| DAA032 | 10,1 | 4 | A | O | 科目代號2 |
| DAH06S | 10,24 | 4 | A | B | 科目代號2(起) |
| DAH06E | 10,47 | 4 | A | B | 科目代號2(迄) |
| DAA033 | 11,1 | 4 | A | O | 科目代號3 |
| DAH07S | 11,24 | 4 | A | B | 科目代號3(起) |
| DAH07E | 11,47 | 4 | A | B | 科目代號3(迄) |
| DAA034 | 12,1 | 4 | A | O | 科目代號4 |
| DAH08S | 12,24 | 4 | A | B | 科目代號4(起) |
| DAH08E | 12,47 | 4 | A | B | 科目代號4(迄) |
| DAA035 | 13,1 | 4 | A | O | 科目代號5 |
| DAH09S | 13,24 | 4 | A | B | 科目代號5(起) |
| DAH09E | 13,47 | 4 | A | B | 科目代號5(迄) |
| ERRMSG | 22,2 | 70 | A | O | 錯誤訊息 |

## 五、功能鍵說明
1. PF3：返回前頁
2. PF4：重新查詢
3. PF12：返回前頁（僅明細畫面）
4. PF14：處理年度

## 六、輸入欄位驗證
1. 必填欄位：
   - 公司代號 (DAH01)
   - 處理選擇 (DOPT)
   - 會計年度 (DYEAR)
   - 會計期間 (DYY, DYMD)
   - 處理方式 ($PENV)
   - 結帳年度 ($CPY)
   - 結帳代號 ($PRTCD)

2. 資料格式：
   - 公司代號：4位字元
   - 處理選擇：1位字元(1/2)
   - 會計年度：3位數值
   - 會計期間：2位數值
   - 會計日期：7位數值(YY/MM/DD)
   - 處理方式：1位字元(0/1/2)
   - 結帳年度：3位數值
   - 結帳代號：2位字元

## 七、錯誤處理
1. 錯誤訊息顯示位置：第22行
2. 錯誤訊息格式：70位字元
3. 錯誤類型：
   - 必填欄位未輸入
   - 資料格式錯誤
   - 處理失敗

## 八、使用說明
1. 操作步驟：
   - 輸入公司代號
   - 選擇處理方式
   - 輸入會計年度和期間
   - 選擇處理方式
   - 輸入結帳年度和代號
   - 按PF4執行查詢或PF14執行處理

2. 注意事項：
   - 處理選擇：1-總帳結帳處理、2-結帳處理
   - 處理方式：0-查詢、1-結帳、2-反結
   - 會計年度必須為有效年度
   - 會計期間必須為有效期間
   - 結帳年度必須為有效年度
   - 結帳代號必須為有效代號 