# GLA120D 螢幕顯示檔案規格書

## 基本資訊
- 檔案名稱：GLA120D
- 檔案類型：螢幕顯示檔案 (DSPF)
- 來源目錄：QDDSSRC_GLPLIB
- 程式說明：總帳部門資料維護
- 系統：茂世會計系統
- 子系統：總帳系統
- 作者：JOYCE (A1087)
- 建立日期：1992.11.19
- 更新日期：無

## 螢幕規格
- 顯示大小：24x80
- 參考檔案：GLRF (總帳欄位定義檔)
- 螢幕代號：GLA120.1
- 訊息位置：第22行
- 列印功能：支援

## 螢幕佈局
```
<GLA120.1>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                總帳部門資料維護                 時間: [時間]









                         部門代號: [  ] - [  ]

                         部門名稱: [                              ]

                         部門代號範圍: [  ] - [  ]

                         部門建立日期: [YYMMDD]

                         部門結束日期: [YYMMDD]

                         處理選項: [ ]
                          2: 修改
                          6: 批次處理
                          9: 批次處理且列印







[部門資料清單]
序號  部門代號  部門名稱                          建立日期  結束日期  處理選項
----  --------  ------------------------------  --------  --------  --------
[1]   [  ]      [                              ]  [      ]  [      ]  [ ]
[2]   [  ]      [                              ]  [      ]  [      ]  [ ]
[3]   [  ]      [                              ]  [      ]  [      ]  [ ]
[4]   [  ]      [                              ]  [      ]  [      ]  [ ]
[5]   [  ]      [                              ]  [      ]  [      ]  [ ]
[6]   [  ]      [                              ]  [      ]  [      ]  [ ]
[7]   [  ]      [                              ]  [      ]  [      ]  [ ]
[8]   [  ]      [                              ]  [      ]  [      ]  [ ]
[9]   [  ]      [                              ]  [      ]  [      ]  [ ]
[10]  [  ]      [                              ]  [      ]  [      ]  [ ]
[11]  [  ]      [                              ]  [      ]  [      ]  [ ]

[錯誤訊息顯示區域]
注意    PF3 =返回前頁    PF4 =查詢資料    PF12=返回前一頁    PF13=列印設定
                                                           【茂世資訊】
```

## 記錄格式
### DSPD1 - 主畫面
- 游標位置控制
- 條件指示器：CA03(03), CF04(04)
- 標題：<GLA120.1>
- 公司名稱：CONAME (32A, 輸出)
- 日期：DDATE (6Y, 輸出, 日期格式)
- 使用者：$USERN (10A, 輸出)
- 部門代號：DAN01 (參考AN01)
- 部門名稱：#B02 (參考PTRF)
- 部門代號範圍：DAN02B/DAN02E (參考AN02)
- 部門建立日期：DAH10 (參考AH10)
- 部門結束日期：DAH21 (參考AH21)
- 處理選項：SNO (1A, 輸入)
  - 2: 修改
  - 6: 批次處理
  - 9: 批次處理且列印

### SFLSR/SFLCR - 子檔案
- 子檔案大小：110筆
- 每頁顯示：11筆
- 條件指示器：CA03(03), CF12(12), CF13(13)
- 覆蓋顯示
- 包含部門資料清單
- 處理選項：DOPT (1A, 輸入)
  - 2: 修改
  - 6: 批次處理
  - 9: 批次處理且列印

### DSPD9 - 列印設定畫面
- 條件指示器：CF04(04)
- 覆蓋顯示
- 保護模式
- 不自動清除
- 列印份數：$CPY (3Y, 輸入)
- 列印代號：$PRTCD (2A, 輸入)

### SFLSRD/SFLCRD - 部門資料子檔案
- 子檔案大小：60筆
- 每頁顯示：10筆
- 覆蓋顯示
- 包含部門詳細資料

### SFLSRC/SFLCRC - 部門資料子檔案(複製用)
- 子檔案大小：60筆
- 每頁顯示：10筆
- 覆蓋顯示
- 包含部門詳細資料

## 欄位規格
| 欄位名稱 | 參考欄位 | 位置 | 格式 | 條件指示器 | 說明 |
|---------|---------|------|------|------------|------|
| CONAME | - | 1,25 | 32A | - | 公司名稱 |
| DDATE | - | 1,72 | 6Y | - | 系統日期 |
| $USERN | - | 2,2 | 10A | - | 使用者代號 |
| DAN01 | AN01 | 4,16 | - | 60 | 部門代號 |
| #B02 | PTRF | 4,19 | - | - | 部門名稱 |
| DAN02B | AN02 | 5,16 | - | 61 | 部門代號(起) |
| DAN02E | AN02 | 5,27 | - | 62 | 部門代號(至) |
| DAH10 | AH10 | 7,16 | - | 63 | 部門建立日期 |
| DAH21 | AH21 | 8,16 | - | 64 | 部門結束日期 |
| SNO | - | 9,16 | 1A | - | 處理選項 |
| ERRMSG | - | 22,2 | 70A | 99 | 錯誤訊息 |
| DMSG | - | 22,2 | 78A | 98 | 一般訊息 |

## 功能鍵說明
| 功能鍵 | 說明 |
|-------|------|
| PF3 | 返回前頁 |
| PF4 | 查詢資料 |
| PF12 | 返回前一頁 |
| PF13 | 列印設定 |

## 輸入欄位驗證
1. 部門代號 (DAN01)
   - 必填欄位
   - 格式：需符合部門代碼表

2. 部門代號範圍 (DAN02B/DAN02E)
   - 必填欄位
   - 格式：需符合部門代碼表
   - 起始代號需小於等於結束代號

3. 處理選項 (SNO)
   - 必填欄位
   - 值域：2,6,9

4. 列印份數 ($CPY)
   - 必填欄位
   - 格式：3位數字
   - 範圍：1-999

## 錯誤處理
1. 錯誤訊息顯示位置：第22行
2. 錯誤訊息類型：
   - 必填欄位未填
   - 資料格式錯誤
   - 資料不存在
   - 系統錯誤

## 使用說明
1. 主畫面功能：
   - 可輸入部門代號範圍進行查詢
   - 可選擇不同的處理選項
   - 支援分頁顯示

2. 子檔案功能：
   - 顯示部門資料清單
   - 支援分頁瀏覽
   - 可進行資料選擇

3. 列印設定：
   - 可設定列印份數
   - 可選擇列印代號
   - 支援批次列印功能 