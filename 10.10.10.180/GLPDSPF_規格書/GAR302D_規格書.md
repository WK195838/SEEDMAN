# GAR302D 螢幕顯示檔案規格書

## 基本資訊
- 檔案名稱: GAR302D
- 檔案類型: 顯示檔案 (DSPF)
- 來源目錄: QDDSSRC_GLPLIB
- 程式說明: 部門資料列印功能
- 系統: 台塑三井精密化學
- 子系統: 總帳系統
- 作者: MERCURY
- 建立日期: 83/01/28

## 螢幕規格
- 顯示大小: 24行 x 80列
- 參考檔案: *LIBL/GLRF (引用總帳參考欄位定義檔)
- 螢幕代號: GAR302.1
- 輸出功能: PRINT (允許螢幕列印)

## 記錄格式
- 記錄格式名稱: DSPD1
- 功能鍵設定: 
  - CA03(03) - 返回主畫面
  - CF04(04) - 重新查詢
  - CF14(14) - 處理作業
- 游標位置: CSRLOC(#LIN #COL)

## 螢幕佈局
```
<GAR302.1>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                部門資料列印                     時間: [時間]







                         部門號　: [   ] - [   ] (部門號碼四位數部門號)






                         輸出裝置: [ ] ( 0-螢幕 1-印表 2-檔案)

                         列印份數: [   ]

                         列印機台: [  ]


[錯誤訊息顯示區域]
注意    PF3 =回主畫面    PF4 =重新查詢    PF14 =處理作業
                                                           【茂世資訊】
```

## 欄位規格
| 欄位名稱 | 參考欄位 | 說明 | 資料型態 | 長度 | 輸入/輸出 | 屬性 | 編輯碼/格式 |
|---------|---------|------|---------|------|---------|------|------------|
| #LIN | - | 游標行位置 | 數值 | 3,0 | H | - | - |
| #COL | - | 游標列位置 | 數值 | 3,0 | H | - | - |
| DDATE | - | 系統日期 | 數值 | 6Y,0 | O | - | EDTCDE(Y) |
| $USERN | - | 使用者ID | 字元 | 10A | O | - | - |
| DAW01S | AW01 | 部門號(起) | 字元 | - | B | 條件PC,RI(62) | - |
| DAW01E | AW01 | 部門號(迄) | 字元 | - | B | 條件PC,RI(63) | - |
| $PENV | - | 輸出裝置 | 字元 | 1 | B | - | VALUES('0', '1', '2') |
| $CPY | - | 列印份數 | 數值 | 3Y,0 | B | - | EDTCDE(3), CHECK(RB) |
| $PRTCD | - | 列印機台 | 字元 | 2 | B | HI | - |
| ERRID | - | 錯誤訊息ID | 字元 | 7 | H | - | - |
| ERRF | - | 錯誤訊息檔案 | 字元 | 10 | H | - | - |
| ERRMSG | - | 錯誤訊息內容 | 字元 | 70A | O | HI | MSGID(&ERRID &ERRF) |

## 條件指示器
| 指示器 | 說明 | 用途 |
|-------|------|------|
| 28 | 強制資料輸入指示 | 控制FRCDTA與LOCK屬性 |
| 27 | 錯誤訊息顯示指示 | 控制「請正確輸入各欄位資料」訊息 |
| 62-63 | 欄位錯誤指示 | 控制部門號欄位的PC與RI屬性 |
| 99 | 隱藏條件指示 | 控制錯誤訊息顯示 |

## 功能鍵
| 功能鍵 | 說明 | 作用 |
|-------|------|------|
| PF3 (CA03) | 回主畫面 | 返回上一層主選單 |
| PF4 (CF04) | 重新查詢 | 清除已輸入的條件 |
| PF14 (CF14) | 處理作業 | 執行部門資料列印 |

## 輸入欄位檢核
1. 部門號(DAW01S、DAW01E): 必要時由指示器62和63控制高亮顯示，須輸入有效部門代碼
2. 輸出裝置($PENV): 限制只能輸入0、1或2
   - 0: 螢幕
   - 1: 印表
   - 2: 檔案
3. 列印份數($CPY): 使用CHECK(RB)只允許數字，使用EDTCDE(3)添加千位分隔符
4. 列印機台($PRTCD): 高亮顯示，供使用者輸入印表機代號

## 錯誤處理
- 欄位錯誤時使用對應的指示器(62-63)控制欄位高亮顯示
- 整體錯誤透過指示器27顯示「請正確輸入各欄位資料」訊息
- 處理中使用指示器28顯示「正在處理中，請等待」訊息
- 特定錯誤訊息通過ERRMSG欄位與MSGID功能顯示

## 使用說明
1. 此螢幕用於設定部門資料列印的條件
2. 使用者必須指定部門號範圍
3. 可選擇輸出方式、列印份數及印表機
4. 按PF3返回主選單，按PF4重新設定查詢條件，按PF14執行處理

## 程式功能
1. 程式主要用於列印特定條件下的部門資料
2. 根據指定的部門號範圍，篩選部門資料
3. 可透過不同輸出裝置檢視處理結果

## 備註
- 本程式為台塑三井精密化學設計的部門資料列印功能
- 公司名稱通過訊息檔案(MSGCON 030 URE9999 *LIBL/REMF)取得
- 部門號為四位數編碼系統
- 使用指示器28控制處理中的畫面鎖定
- 畫面右下角顯示系統開發公司名稱【茂世資訊】 