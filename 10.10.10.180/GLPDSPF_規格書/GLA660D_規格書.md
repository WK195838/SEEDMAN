# GLA660D 螢幕顯示檔規格書

## 一、基本資訊
- 檔案名稱：GLA660D
- 檔案類型：螢幕顯示檔
- 來源目錄：10.10.10.180/QDDSSRC_GLPLIB
- 程式說明：預算科目比率設定
- 系統：會計總帳系統
- 子系統：會計總帳系統
- 作者：A1139 JANE
- 建立日期：1992.12.07
- 更新日期：

## 二、螢幕規格
- 顯示大小：24x80
- 參考檔案：GLRF
- 螢幕代號：GLA660.1/GLA660.2
- 訊息位置：第22行
- 列印功能：支援
- 條件指示器：
  - CA03(03)：主畫面顯示控制
  - CF18(18)：批次處理控制
  - CF05(05)：明細畫面顯示控制
  - CF12(12)：明細畫面顯示控制

## 三、螢幕佈局

### 1. 主畫面 (GLA660.1)
```
<GLA660.1>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                預算科目比率設定                 時間: [時間]

公司代號    : [   ]
預算科目代號: [   ] (公司: [   ] [   ])
處理選項    : [ ] ( 1.新增
                   2.修改
                   4.刪除
                   5.查詢)

-----------------------------------------
[錯誤訊息顯示區域]
注意    F3 =返回前頁    PF18=批次處理查詢
                                                           【茂世資訊】
```

### 2. 明細畫面 (GLA660.2)
```
<GLA660.2>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                預算科目比率設定                 時間: [時間]

公司代號    : [   ] [公司名稱]
預算科目代號: [   ] (公司: [   ] [   ])
處理選項    : [ ] ( 1.新增
                   2.修改
                   4.刪除
                   5.查詢)

-----------------------------------------
科目代號    : [   ]

計算比率    比率%    計算比率    比率%    計算比率    比率%
01    [   .    ]    02    [   .    ]    03    [   .    ]
04    [   .    ]    05    [   .    ]    06    [   .    ]
07    [   .    ]    08    [   .    ]    09    [   .    ]
10    [   .    ]    11    [   .    ]    12    [   .    ]
13    [   .    ]                    合計    [   .    ]%

[錯誤訊息顯示區域]
注意    PF3 =返回前頁    PF5 =資料查詢    PF12=返回前頁
                                                           【茂世資訊】
```

## 四、記錄格式

### 1. 主畫面 (DSPD1)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| CONAME | 1,25 | 32 | A | O | 公司名稱 |
| DDATE | 1,72 | 6 | Y | O | 系統日期 |
| $USERN | 2,2 | 10 | A | O | 使用者代號 |
| DA601 | 4,16 | - | R | B | 公司代號 |
| DA602 | 5,16 | - | R | B | 預算科目代號 |
| DA601C | 5,29 | - | R | B | 公司代號(參考) |
| DA602C | 5,32 | - | R | B | 預算科目代號(參考) |
| DOPT | 6,16 | 1 | Y | B | 處理選項 |

### 2. 明細畫面 (DSPD2)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| DA601 | 4,16 | - | R | O | 公司代號 |
| #B02 | 4,20 | - | R | O | 公司名稱 |
| DA602 | 5,16 | - | R | O | 預算科目代號 |
| DA601C | 5,29 | - | R | O | 公司代號(參考) |
| DA602C | 5,32 | - | R | O | 預算科目代號(參考) |
| DOPT | 6,16 | 1 | Y | O | 處理選項 |
| DA603 | 8,16 | - | R | B | 科目代號 |
| DA6041-DA604D | 11-19,14 | - | R | B | 計算比率(1-13) |
| TOTAL | 19,69 | 7 | 4 | O | 合計比率 |

## 五、功能鍵說明
- PF3：返回前頁
- PF5：資料查詢
- PF12：返回前頁
- PF18：批次處理查詢

## 六、輸入欄位驗證
1. 必填欄位：
   - 公司代號 (DA601)
   - 預算科目代號 (DA602)
   - 處理選項 (DOPT)
   - 科目代號 (DA603)
   - 計算比率 (DA6041-DA604D)

2. 資料格式：
   - 公司代號：必須為有效公司代號
   - 預算科目代號：必須為有效科目代號
   - 處理選項：必須為1,2,4,5
   - 科目代號：必須為有效科目代號
   - 計算比率：必須為有效百分比
   - 合計比率：必須為100%

## 七、錯誤處理
- 錯誤訊息顯示位置：第22行
- 錯誤訊息格式：MSGID(&ERRID &ERRF)
- 錯誤類型：
  - 必填欄位未輸入
  - 資料格式錯誤
  - 公司代號不存在
  - 預算科目代號不存在
  - 科目代號不存在
  - 計算比率不合理
  - 合計比率不為100%
  - 處理選項錯誤

## 八、使用說明
1. 查詢條件設定：
   - 輸入公司代號
   - 輸入預算科目代號
   - 選擇處理選項

2. 功能操作說明：
   - 使用PF3返回前頁
   - 使用PF5進行資料查詢
   - 使用PF12返回前頁
   - 使用PF18進行批次處理查詢

3. 注意事項：
   - 公司代號必須為有效值
   - 預算科目代號必須存在
   - 科目代號必須存在
   - 計算比率必須為有效百分比
   - 合計比率必須為100%
   - 處理選項必須為1,2,4,5 