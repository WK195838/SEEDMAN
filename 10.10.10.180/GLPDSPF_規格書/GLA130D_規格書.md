# GLA130D 螢幕顯示檔案規格書

## 基本資訊
- 檔案名稱：GLA130D
- 檔案類型：螢幕顯示檔案 (DSPF)
- 來源目錄：QDDSSRC_GLPLIB
- 程式說明：部門查詢
- 系統：茂世會計系統
- 子系統：總帳系統
- 作者：JOYCE (A1087)
- 建立日期：1992.11.18
- 更新日期：無

## 螢幕規格
- 顯示大小：24x80
- 參考檔案：GLRF (總帳欄位定義檔)
- 訊息位置：第22行
- 列印功能：支援

## 記錄格式
### DSPD1 - 主畫面
- 條件指示器：CA03(03), CF13(13)
- 標題：<GLA130.1>
- 公司名稱：CONAME (32A, 輸出)
- 日期：DDATE (6Y, 輸出, 日期格式)
- 使用者：$USERN (10A, 輸出)
- 部門代號：DAH01 (參考AH01)
- 部門名稱：#B02 (參考PTRF)
- 部門代號：DAH02 (參考AH02)

### SFLSR/SFLCR - 子檔案
- 子檔案大小：120筆
- 每頁顯示：5筆
- 條件指示器：CA03(03), CF06(06), CF09(09), CF12(12), CF13(13)
- 覆蓋顯示
- 保護模式
- 處理選項：DOPT (1A, 輸入)
  - 1: 新增
  - 2: 修改
  - 4: 刪除
  - 5: 查詢

### DSPD3 - 部門資料維護畫面
- 游標位置控制
- 條件指示器：CA03(03), CF04(04), CF05(05), CF12(12)
- 覆蓋顯示
- 部門代號：DAH03 (參考AH03)
- 部門名稱：DAH04 (參考AH04)
- 部門簡稱：DAF03 (參考AF03)
- 上級部門：DAH12 (參考AH12)
- 下級部門：DAH13 (參考AH13)
- 是否有效：DAH11 (1, 輸入, Y/N)

### DSPD4 - 部門詳細資料畫面
- 游標位置控制
- 條件指示器：CA03(03), CF04(04), CF05(05), CF12(12)
- 覆蓋顯示
- 保護模式
- 強制資料顯示
- 鎖定模式
- 包含多個部門相關欄位：
  - 部門代號 (DAH03)
  - 部門名稱 (DAH04)
  - 上級部門 (DAH12)
  - 下級部門 (DAH13)
  - 是否有效 (DAH11)
  - 其他相關欄位 (DAH05-DAH09, DAH14-DAH16, DAH22, DAH24)

### DSPD9 - 列印設定畫面
- 條件指示器：CF04(04)
- 覆蓋顯示
- 保護模式
- 不自動清除
- 列印份數：$CPY (3Y, 輸入)
- 列印代號：$PRTCD (2A, 輸入)

### SFLSRD/SFLCRD - 部門資料子檔案
- 子檔案大小：60筆
- 每頁顯示：10筆
- 覆蓋顯示
- 包含部門詳細資料

### SFLSRC/SFLCRC - 部門資料子檔案(複製用)
- 子檔案大小：60筆
- 每頁顯示：10筆
- 覆蓋顯示
- 包含部門詳細資料

## 欄位規格
| 欄位名稱 | 參考欄位 | 位置 | 格式 | 條件指示器 | 說明 |
|---------|---------|------|------|------------|------|
| CONAME | - | 1,25 | 32A | - | 公司名稱 |
| DDATE | - | 1,72 | 6Y | - | 系統日期 |
| $USERN | - | 2,2 | 10A | - | 使用者代號 |
| DAH01 | AH01 | 3,16 | - | 67 | 部門代號 |
| #B02 | PTRF | 3,19 | - | - | 部門名稱 |
| DAH02 | AH02 | 4,16 | - | 68 | 部門代號 |
| DAH21 | AH21 | 3,47 | - | 69 | 部門結束日期 |
| DAH10 | AH10 | 4,47 | - | - | 部門建立日期 |
| DAH26 | AH26 | 3,71 | - | - | 部門建立人 |
| DAH25 | AH25 | 4,71 | - | - | 部門建立日期 |
| ERRMSG | - | 22,2 | 70A | 99 | 錯誤訊息 |
| DMSG | - | 22,2 | 78A | 98 | 一般訊息 |

## 功能鍵說明
| 功能鍵 | 說明 |
|-------|------|
| PF2 | 列印資料 |
| PF3 | 返回前頁 |
| PF4 | 查詢資料 |
| PF6 | 批次處理 |
| PF9 | 批次列印 |
| PF12 | 返回前一頁 |
| PF13 | 列印設定 |

## 輸入欄位驗證
1. 部門代號 (DAH01/DAH02)
   - 必填欄位
   - 格式：需符合部門代碼表

2. 部門名稱 (DAH04)
   - 必填欄位
   - 格式：中英文

3. 上級部門 (DAH12)
   - 格式：需符合部門代碼表
   - 需存在於部門資料中

4. 下級部門 (DAH13)
   - 格式：需符合部門代碼表
   - 需存在於部門資料中

5. 是否有效 (DAH11)
   - 必填欄位
   - 值域：Y/N

6. 列印份數 ($CPY)
   - 必填欄位
   - 格式：3位數字
   - 範圍：1-999

## 錯誤處理
1. 錯誤訊息顯示位置：第22行
2. 錯誤訊息類型：
   - 必填欄位未填
   - 資料格式錯誤
   - 資料重複
   - 資料不存在
   - 系統錯誤

## 使用說明
1. 主畫面功能：
   - 可輸入部門代號進行查詢
   - 可選擇不同的處理選項
   - 支援分頁顯示

2. 詳細資料畫面：
   - 顯示部門完整資訊
   - 可進行資料維護
   - 提供資料驗證功能

3. 列印設定：
   - 可設定列印份數
   - 可選擇列印代號
   - 支援批次列印功能

4. 子檔案功能：
   - 顯示部門資料清單
   - 支援分頁瀏覽
   - 可進行資料選擇 