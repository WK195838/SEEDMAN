# GAR303D 螢幕顯示檔案規格書

## 基本資訊
- 檔案名稱: GAR303D
- 檔案類型: 顯示檔案 (DSPF)
- 來源目錄: QDDSSRC_GLPLIB
- 程式說明: 會計科目明細列印功能
- 系統: 台塑三井精密化學
- 子系統: 總帳系統
- 作者: MERCURY
- 建立日期: 83/01/24

## 螢幕規格
- 顯示大小: 24行 x 80列
- 參考檔案: *LIBL/GLRF (引用總帳參考欄位定義檔)
- 螢幕代號: GAR303.1
- 輸出功能: PRINT (允許螢幕列印)

## 記錄格式
- 記錄格式名稱: DSPD1
- 功能鍵設定: 
  - CA03(03) - 返回主畫面
  - CF04(04) - 重新查詢
  - CF14(14) - 處理作業
- 游標位置: CSRLOC(#LIN #COL)

## 螢幕佈局
```
<GAR303.1>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                會計科目明細列印                 時間: [時間]







                         科目代號: [   ] - [   ]

                         明細序號: [   ] - [   ]






                         輸出裝置: [ ] ( 0-螢幕 1-印表 2-檔案)

                         列印份數: [   ]

                         列印機台: [  ]


[錯誤訊息顯示區域]
注意    PF3 =回主畫面    PF4 =重新查詢    PF14 =處理作業
                                                           【茂世資訊】
```

## 欄位規格
| 欄位名稱 | 參考欄位 | 說明 | 資料型態 | 長度 | 輸入/輸出 | 屬性 | 編輯碼/格式 |
|---------|---------|------|---------|------|---------|------|------------|
| #LIN | - | 游標行位置 | 數值 | 3,0 | H | - | - |
| #COL | - | 游標列位置 | 數值 | 3,0 | H | - | - |
| DDATE | - | 系統日期 | 數值 | 6Y,0 | O | - | EDTCDE(Y) |
| $USERN | - | 使用者ID | 字元 | 10A | O | - | - |
| DAY01S | AY01 | 科目代號(起) | 字元 | - | B | 條件PC,RI(62) | - |
| DAY01E | AY01 | 科目代號(迄) | 字元 | - | B | 條件PC,RI(63) | - |
| DAY02S | AY02 | 明細序號(起) | 字元 | - | B | 條件PC,RI(64),HI(N64) | - |
| DAY02E | AY02 | 明細序號(迄) | 字元 | - | B | 條件PC,RI(65),HI(N65) | - |
| $PENV | - | 輸出裝置 | 字元 | 1 | B | - | VALUES('0', '1', '2') |
| $CPY | - | 列印份數 | 數值 | 3Y,0 | B | - | EDTCDE(3), CHECK(RB) |
| $PRTCD | - | 列印機台 | 字元 | 2 | B | HI | - |
| ERRID | - | 錯誤訊息ID | 字元 | 7 | H | - | - |
| ERRF | - | 錯誤訊息檔案 | 字元 | 10 | H | - | - |
| ERRMSG | - | 錯誤訊息內容 | 字元 | 70A | O | HI | MSGID(&ERRID &ERRF) |

## 條件指示器
| 指示器 | 說明 | 用途 |
|-------|------|------|
| 28 | 強制資料輸入指示 | 控制FRCDTA與LOCK屬性 |
| 27 | 錯誤訊息顯示指示 | 控制「請正確輸入各欄位資料」訊息 |
| 62-63 | 科目代號欄位錯誤指示 | 控制科目代號欄位的PC與RI屬性 |
| 64-65 | 明細序號欄位錯誤指示 | 控制明細序號欄位的PC與RI屬性 |
| N64-N65 | 明細序號欄位高亮指示 | 控制明細序號欄位的HI屬性 |
| 99 | 隱藏條件指示 | 控制錯誤訊息顯示 |

## 功能鍵
| 功能鍵 | 說明 | 作用 |
|-------|------|------|
| PF3 (CA03) | 回主畫面 | 返回上一層主選單 |
| PF4 (CF04) | 重新查詢 | 清除已輸入的條件 |
| PF14 (CF14) | 處理作業 | 執行會計科目明細列印 |

## 輸入欄位檢核
1. 科目代號(DAY01S、DAY01E): 必要時由指示器62和63控制高亮顯示，須輸入有效科目代號
2. 明細序號(DAY02S、DAY02E): 由指示器64和65控制高亮顯示，非錯誤時有高亮屬性(N64、N65)
3. 輸出裝置($PENV): 限制只能輸入0、1或2
   - 0: 螢幕
   - 1: 印表
   - 2: 檔案
4. 列印份數($CPY): 使用CHECK(RB)只允許數字，使用EDTCDE(3)添加千位分隔符
5. 列印機台($PRTCD): 高亮顯示，供使用者輸入印表機代號

## 錯誤處理
- 欄位錯誤時使用對應的指示器(62-65)控制欄位高亮顯示
- 整體錯誤透過指示器27顯示「請正確輸入各欄位資料」訊息
- 處理中使用指示器28顯示「正在處理中，請等待」訊息
- 特定錯誤訊息通過ERRMSG欄位與MSGID功能顯示

## 使用說明
1. 此螢幕用於設定會計科目明細列印的條件
2. 使用者必須指定科目代號範圍
3. 可選擇性指定明細序號範圍進行細部篩選
4. 可選擇輸出方式、列印份數及印表機
5. 按PF3返回主選單，按PF4重新設定查詢條件，按PF14執行處理

## 程式功能
1. 程式主要用於列印特定條件下的會計科目明細資料
2. 根據指定的科目代號範圍，篩選會計科目明細
3. 可透過明細序號進一步細化資料篩選條件
4. 可透過不同輸出裝置檢視處理結果

## 備註
- 本程式為台塑三井精密化學設計的會計科目明細列印功能
- 公司名稱通過訊息檔案(MSGCON 030 URE9999 *LIBL/REMF)取得
- 明細序號欄位具有條件性高亮顯示功能，有助於用戶清楚辨識
- 使用指示器28控制處理中的畫面鎖定
- 畫面右下角顯示系統開發公司名稱【茂世資訊】 