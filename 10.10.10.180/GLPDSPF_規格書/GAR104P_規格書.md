# GAR104P 列印檔案規格書

## 基本資訊
- 檔案名稱: GAR104P
- 檔案類型: 列印檔案 (PRTF)
- 來源目錄: QDDSSRC_GLPLIB
- 程式說明: 參數代碼產生作業報表
- 系統: 總帳系統

## 參考檔案
- 參考檔案: GLRF (引用總帳參考欄位定義檔)

## 報表結構
報表包含五個記錄格式：
1. PH1: 報表標題與欄位標頭
2. PD1: 明細資料記錄
3. PE1: 分隔線與尾註標記
4. PE2: 分隔線與結束訊息
5. PE9: 無資料訊息

## 報表佈局

### 標題區域 (PH1)
```
[公司名稱]
                                     (跳過2行)
參數代碼產生
                                     (跳過1行)
                                                  日期: [系統日期]
                                                  頁次: [頁碼]
                                                  時間: [時間]    <GAR104P>
參數日期: [起始日期] - [結束日期]                 USER : [使用者ID]
===============================================================
參數代碼  建檔人    有效 版本 排序             狀態
===============================================================
```

### 明細資料區域 (PD1)
```
[空行]
[參數代碼] [建檔人] [使用者ID] [有效] [版本] [排序] [狀態欄位]
```

### 分隔線與尾註 (PE1)
```
===============================================================
   ***完成***
```

### 結束區域 (PE2)
```
===============================================================
   <<GAR104P>>--->產生完成
```

### 無資料訊息 (PE9)
```
                無符合條件之資料
```

## 記錄格式詳細說明

### PH1 (標題與欄位標頭格式)
- 跳過前2行 (SKIPB(2))
- 每行間距設定使用SPACEA()控制

| 欄位名稱 | 參考欄位 | 說明 | 位置 | 編輯碼/格式 | 備註 |
|---------|---------|------|------|------------|------|
| #B03 | PTRF.#B03 | 公司名稱 | 1,1 | - | - |
| PDATE | - | 日期 | 1,54 | EDTCDE(Y) | 長度6,0 |
| PAGNBR | - | 頁碼 | 1,71 | EDTCDE(4) | 系統頁碼 |
| TIME | - | 時間 | 1,54 | EDTWRD('  :  :  ') | 系統時間 |
| D10F | AH10 | 起始參數日期 | 1,13 | EDTWRD('   /  /  ') | - |
| D10T | AH10 | 結束參數日期 | 1,25 | EDTWRD('   /  /  ') | - |
| $USER | - | 使用者ID | 1,54 | - | 長度10 |

### PD1 (明細資料格式)
- 含指示器20控制
- 每筆資料間距設定使用SPACEA(1)控制

| 欄位名稱 | 參考欄位 | 說明 | 位置 | 編輯碼/格式 | 條件指示器 |
|---------|---------|------|------|------------|-----------|
| AH02 | AH02 | 參數代碼 | 1,2 | - | - |
| AH26 | AH26 | 建檔人 | 1,12 | - | - |
| PSU02 | - | 使用者ID | 1,22 | - | 長度10 |
| AH18 | AH18 | 有效 | 1,35 | - | - |
| AH19 | AH19 | 版本 | 1,41 | - | - |
| AH20 | AH20 | 排序 | 1,47 | - | - |
| FLD | - | 狀態欄位 | 1,61 | UNDERLINE | 長度20 |

### PE1 (尾註格式)
- 顯示報表的分隔線與完成訊息
- 跳行顯示 (SPACEA(1))

### PE2 (結束訊息格式)
- 顯示報表的分隔線與結束訊息
- 跳行顯示 (SPACEA(1))

### PE9 (無資料訊息格式)
- 跳行顯示 (SPACEA(1))
- 顯示訊息: "無符合條件之資料"

## 編輯碼說明
| 編輯碼 | 說明 |
|-------|------|
| EDTCDE(Y) | 西元年月日格式 (YYMMDD) |
| EDTCDE(4) | 無前導零、無千位分隔符的數值格式 |
| EDTWRD('   /  /  ') | 自訂日期格式，以斜線分隔 |
| EDTWRD('  :  :  ') | 自訂時間格式，以冒號分隔 |
| UNDERLINE | 顯示帶有底線的字段 |

## 條件指示器
| 指示器 | 說明 | 用途 |
|-------|------|------|
| 20 | 空行控制 | 控制PD1記錄中的空行顯示 |

## 資料流程
1. 報表首先印出標題區域 (PH1)，顯示報表名稱與查詢條件
2. 如有符合條件的資料，則印出資料明細 (PD1)，每筆資料各占一行
3. 處理完成後印出尾註 (PE1)，顯示「完成」訊息
4. 最後印出結束訊息 (PE2)，顯示「產生完成」訊息
5. 如果沒有符合條件的資料，則印出無資料訊息 (PE9)

## 使用說明
1. 此報表用於顯示參數代碼產生作業的處理結果
2. 報表由GAR104D螢幕程式產生，根據使用者指定的條件篩選資料
3. 報表顯示參數代碼、建檔人及相關狀態資訊
4. 報表結尾會顯示完成訊息，確認處理已成功完成

## 報表欄位說明
1. 參數代碼 (AH02): 顯示系統中的參數代碼
2. 建檔人 (AH26): 顯示創建該參數代碼的人員
3. 使用者ID (PSU02): 顯示目前操作使用者的ID
4. 有效 (AH18): 顯示參數代碼的有效狀態
5. 版本 (AH19): 顯示參數代碼的版本
6. 排序 (AH20): 顯示參數代碼的排序順序
7. 狀態欄位 (FLD): 顯示參數代碼的處理狀態，以底線強調

## 報表與螢幕的對應關係
- 此報表由GAR104D螢幕產生，顯示參數代碼產生的結果
- 報表頂部顯示與查詢條件相同的參數日期範圍
- 報表用於確認參數代碼產生後的狀態與結果

## 備註
- 報表使用底線強調狀態欄位，便於快速識別處理結果
- 完成與結束訊息分別使用兩個不同的記錄格式，便於區分處理階段
- 使用標準的日期與時間格式，提高可讀性
- 此報表主要供系統管理人員確認參數代碼產生結果 