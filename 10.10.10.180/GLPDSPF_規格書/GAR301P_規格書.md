# GAR301P 列印檔案規格書

## 基本資訊
- 檔案名稱: GAR301P
- 檔案類型: 列印檔案 (PRTF)
- 來源目錄: QDDSSRC_GLPLIB
- 程式說明: 會計科目列印
- 系統: 台塑三井精密化學
- 子系統: 總帳系統
- 作者: MERCURY
- 建立日期: 83/01/19

## 參考檔案
- 參考檔案: GLRF (引用總帳參考欄位定義檔)

## 報表結構
報表包含四個記錄格式：
1. PH1: 報表標題與欄位標頭
2. PD1: 會計科目明細資料記錄
3. PE1: 完成訊息
4. PE2: 處理完成訊息
5. PE3: 無資料訊息

## 報表佈局

### 標題區域 (PH1)
```
                          [公司名稱]
                          會計科目列印
公司別: [起始公司] - [結束公司]                      日期: [系統日期]   頁次: [頁碼]
年度  : [起始年度] - [結束年度]                      時間: [時間]
公司別: [目前公司] [公司名稱]                        USER : [使用者ID]  <GAR301>
====================================================================
年度         開始日期  結束日期      年度         開始日期  結束日期
          科目名稱    (Y/  )        科目名稱      (Y/  )
--------------------------------------------------------------------
```

### 明細資料區域 (PD1)
```
[科目代碼]  01 [開始日期] [結束日期]  [科目代碼]  02 [開始日期] [結束日期]  [科目代碼]
           03 [開始日期] [結束日期]  [科目代碼]  04 [開始日期] [結束日期]  [科目代碼]
           05 [開始日期] [結束日期]  [科目代碼]  06 [開始日期] [結束日期]  [科目代碼]
           07 [開始日期] [結束日期]  [科目代碼]  08 [開始日期] [結束日期]  [科目代碼]
           09 [開始日期] [結束日期]  [科目代碼]  10 [開始日期] [結束日期]  [科目代碼]
           11 [開始日期] [結束日期]  [科目代碼]  12 [開始日期] [結束日期]  [科目代碼]

```

### 完成訊息 (PE1)
```
====================================================================
   ***完成***
```

### 處理完成訊息 (PE2)
```
====================================================================
   <<GAR301>>--->產生完成
```

### 無資料訊息 (PE3)
```
   查詢此條件無資料
```

## 記錄格式詳細說明

### PH1 (標題與欄位標頭格式)
- 跳過前2行 (SKIPB(2))
- 每行間距設定使用SPACEA()控制

| 欄位名稱 | 參考欄位 | 說明 | 位置 | 編輯碼/格式 | 備註 |
|---------|---------|------|------|------------|------|
| - | - | 公司名稱 | 1,26 | MSGCON(030 URE9999 REMF) | - |
| DAC01S | AC01 | 起始公司別 | 1,13 | - | - |
| DAC01E | AC01 | 結束公司別 | 1,19 | - | - |
| $EGMDY | - | 系統日期 | 1,62 | EDTCDE(Y) | 長度6,0 |
| PAGNBR | - | 頁碼 | 1,78 | EDTCDE(Z) | 系統頁碼 |
| DAC02S | - | 起始年度 | 1,13 | - | 長度4 |
| DAC02E | - | 結束年度 | 1,21 | - | 長度4 |
| TIME | - | 時間 | 1,62 | - | 系統時間 |
| AC01 | AC01 | 目前公司別 | 1,13 | - | - |
| #B02 | PTRF.#B02 | 公司名稱 | 1,20 | - | 參考PTRF檔 |
| $USER | - | 使用者ID | 1,62 | - | 長度10 |

### PD1 (明細資料格式)
- 每筆資料間距設定使用SPACEA(1)控制
- 每頁顯示一個科目的12個月資料

| 欄位名稱 | 參考欄位 | 說明 | 位置 | 編輯碼/格式 | 備註 |
|---------|---------|------|------|------------|------|
| AC02 | AC02 | 科目代碼 | 1,2 | - | - |
| D01S | - | 1月開始日期 | 1,13 | EDTWRD('  /  /  ') | 長度6,0 |
| D01E | - | 1月結束日期 | 1,25 | EDTWRD('  /  /  ') | 長度6,0 |
| AC03 | AC03 | 科目代碼 | 1,39 | - | - |
| D02S | - | 2月開始日期 | 1,53 | EDTWRD('  /  /  ') | 長度6,0 |
| D02E | - | 2月結束日期 | 1,65 | EDTWRD('  /  /  ') | 長度6,0 |
| AC04 | AC04 | 科目代碼 | 1,79 | - | - |
| D03S | - | 3月開始日期 | 1,13 | EDTWRD('  /  /  ') | 長度6,0 |
| D03E | - | 3月結束日期 | 1,25 | EDTWRD('  /  /  ') | 長度6,0 |
| AC05 | AC05 | 科目代碼 | 1,39 | - | - |
| D04S | - | 4月開始日期 | 1,53 | EDTWRD('  /  /  ') | 長度6,0 |
| D04E | - | 4月結束日期 | 1,65 | EDTWRD('  /  /  ') | 長度6,0 |
| AC06 | AC06 | 科目代碼 | 1,79 | - | - |
| D05S | - | 5月開始日期 | 1,13 | EDTWRD('  /  /  ') | 長度6,0 |
| D05E | - | 5月結束日期 | 1,25 | EDTWRD('  /  /  ') | 長度6,0 |
| AC07 | AC07 | 科目代碼 | 1,39 | - | - |
| D06S | - | 6月開始日期 | 1,53 | EDTWRD('  /  /  ') | 長度6,0 |
| D06E | - | 6月結束日期 | 1,65 | EDTWRD('  /  /  ') | 長度6,0 |
| AC08 | AC08 | 科目代碼 | 1,79 | - | - |
| D07S | - | 7月開始日期 | 1,13 | EDTWRD('  /  /  ') | 長度6,0 |
| D07E | - | 7月結束日期 | 1,25 | EDTWRD('  /  /  ') | 長度6,0 |
| AC09 | AC09 | 科目代碼 | 1,39 | - | - |
| D08S | - | 8月開始日期 | 1,53 | EDTWRD('  /  /  ') | 長度6,0 |
| D08E | - | 8月結束日期 | 1,65 | EDTWRD('  /  /  ') | 長度6,0 |
| AC10 | AC10 | 科目代碼 | 1,79 | - | - |
| D09S | - | 9月開始日期 | 1,13 | EDTWRD('  /  /  ') | 長度6,0 |
| D09E | - | 9月結束日期 | 1,25 | EDTWRD('  /  /  ') | 長度6,0 |
| AC11 | AC11 | 科目代碼 | 1,39 | - | - |
| D10S | - | 10月開始日期 | 1,53 | EDTWRD('  /  /  ') | 長度6,0 |
| D10E | - | 10月結束日期 | 1,65 | EDTWRD('  /  /  ') | 長度6,0 |
| AC12 | AC12 | 科目代碼 | 1,79 | - | - |
| D11S | - | 11月開始日期 | 1,13 | EDTWRD('  /  /  ') | 長度6,0 |
| D11E | - | 11月結束日期 | 1,25 | EDTWRD('  /  /  ') | 長度6,0 |
| AC13 | AC13 | 科目代碼 | 1,39 | - | - |
| D12S | - | 12月開始日期 | 1,53 | EDTWRD('  /  /  ') | 長度6,0 |
| D12E | - | 12月結束日期 | 1,65 | EDTWRD('  /  /  ') | 長度6,0 |
| AC14 | AC14 | 科目代碼 | 1,79 | - | - |

### PE1, PE2, PE3 (訊息格式)
- 顯示報表的分隔線與完成訊息

## 編輯碼說明
| 編輯碼 | 說明 |
|-------|------|
| EDTCDE(Y) | 西元年月日格式 (YYMMDD) |
| EDTCDE(Z) | 數值格式，不帶前導零 |
| EDTWRD('  /  /  ') | 自訂日期格式，以斜線分隔 |

## 資料流程
1. 報表首先印出標題區域 (PH1)，顯示報表名稱與查詢條件
2. 如有符合條件的資料，則印出每個科目的月份資料 (PD1)
3. 處理完成後印出完成訊息 (PE1)
4. 最後印出處理完成訊息 (PE2)
5. 如果沒有符合條件的資料，則印出無資料訊息 (PE3)

## 使用說明
1. 此報表列印特定條件下的會計科目資料
2. 報表由GAR301D螢幕程式產生，根據使用者指定的條件篩選資料
3. 報表顯示每個會計科目的12個月開始與結束日期
4. 報表採用兩欄並列布局，便於查看多個月份資料

## 報表欄位說明
1. 科目代碼: 顯示會計科目代碼
2. 各月開始日期: 顯示每個月的會計期間開始日期
3. 各月結束日期: 顯示每個月的會計期間結束日期
4. 每行顯示兩個月份資料，共六行顯示全部12個月

## 報表與螢幕的對應關係
- 此報表由GAR301D螢幕產生，使用相同的公司別與年度條件
- 報表顯示詳細的會計科目與各月份的期間設定

## 備註
- 此報表採用兩欄布局，一頁可完整展示一個科目的全年12個月資料
- 日期欄位使用標準格式化顯示，提高可讀性
- 系統在台塑三井精密化學開發並使用
- 此報表主要用於會計系統的科目期間設定參考 