# GLA310D 螢幕顯示檔案規格書

## 基本資訊
- 檔案名稱：GLA310D
- 檔案類型：螢幕顯示檔案 (DSPF)
- 來源目錄：QDDSSRC_GLPLIB
- 程式說明：總帳科目設定畫面
- 系統：茂世會計系統
- 子系統：總帳系統
- 作者：JOYCE (A1087)
- 建立日期：1992.10.29
- 更新日期：無

## 螢幕規格
- 顯示大小：24x80
- 參考檔案：GLRF (總帳欄位定義檔)
- 螢幕代號：GLA310.1
- 訊息位置：第22行
- 列印功能：支援
- 條件指示器：CA03(03), CF18(18)

## 螢幕佈局
```
<GLA310.1>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                總帳科目設定畫面                  時間: [時間]









          公司代號: [  ] - [  ]

          科目代號: [        ]  科目名稱: [                              ]

          上層科目: [  ]  下層科目: [  ]  是否列印: [ ]

[處理訊息顯示區域]

[科目資料清單]
選項  序號  科目代號  科目名稱                          上層科目  下層科目  是否列印
----  ----  --------  ------------------------------  --------  --------  --------
[ ]   [001] [        ]  [                              ]  [      ]  [      ]  [    ]
[ ]   [002] [        ]  [                              ]  [      ]  [      ]  [    ]
[ ]   [003] [        ]  [                              ]  [      ]  [      ]  [    ]
[ ]   [004] [        ]  [                              ]  [      ]  [      ]  [    ]
[ ]   [005] [        ]  [                              ]  [      ]  [      ]  [    ]

[錯誤訊息顯示區域]
注意    PF3 =返回前頁    PF4 =查詢資料    PF5 =開始處理    PF6 =科目設定處理
注意    PF12=返回前一頁    PF18=開始查詢資料
                                                           【茂世資訊】
```

## 記錄格式
### DSPD1 - 主畫面
- 條件指示器：CA03(03), CF18(18)
- 標題：<GLA310.1>
- 公司名稱：CONAME (32A, 輸出)
- 日期：DDATE (6Y, 輸出, 日期格式)
- 使用者：$USERN (10A, 輸出)

### 輸入欄位
1. 公司代號 (DAN01)
   - 位置：3,14
   - 參考欄位：AN01
   - 條件指示器：67
   - 顯示屬性：PC, RI

2. 科目代號 (DAN02)
   - 位置：4,14
   - 參考欄位：AN02
   - 條件指示器：68
   - 顯示屬性：PC, RI

3. 科目名稱 (DAN03)
   - 位置：4,31
   - 參考欄位：AN03

### DSPD2 - 科目資料畫面
- 游標位置控制：#LIN, #COL
- 條件指示器：CA03(03), CF04(04), CF05(05), CF06(06), CF12(12), CF18(18)
- 保護模式
- 覆蓋顯示

### 科目資料欄位
1. 科目代號 (DAO03)
   - 位置：6,14
   - 參考欄位：AO03
   - 編輯碼：4

2. 科目名稱 (DAO04)
   - 位置：7,14
   - 參考欄位：AO04
   - 條件指示器：69, 99
   - 顯示屬性：HI, PC, RI

3. 上層科目 (DAO12)
   - 位置：8,14
   - 參考欄位：AO12
   - 編輯碼：2
   - 顯示屬性：CS
   - 檢查：RB

4. 下層科目 (DAO13)
   - 位置：9,14
   - 參考欄位：AO13
   - 編輯碼：2
   - 顯示屬性：CS
   - 檢查：RB

5. 是否列印 (DAO11)
   - 位置：9,70
   - 參考欄位：AO11
   - 值：'Y'/'N'
   - 條件指示器：71
   - 顯示屬性：PC, RI

### SFLSR - 子檔案記錄
- 選項 (DOPT)：1A, 值：' ', '2', '4', '5'
- 記錄編號 (RRN)：3Y
- 科目資料欄位：
  - DAO031-DAO161 (科目相關資料)
  - DAO111 (列印選項)

### SFLCR - 子檔案控制
- 子檔案大小：120筆
- 每頁顯示：5筆
- 條件指示器：CA03(03), CF12(12)
- 覆蓋顯示
- 保護模式
- 訊息ID：CPF5203

## 訊息顯示
1. 錯誤訊息 (ERRMSG)
   - 位置：22,2
   - 格式：70A
   - 條件指示器：99
   - 高亮度顯示

## 功能鍵說明
| 功能鍵 | 說明 |
|-------|------|
| PF3 | 返回前頁 |
| PF4 | 查詢資料 |
| PF5 | 開始處理 |
| PF6 | 科目設定處理 |
| PF12 | 返回前一頁 |
| PF18 | 開始查詢資料 |

## 輸入欄位驗證
1. 公司代號 (DAN01)
   - 必填欄位
   - 需為有效公司代號

2. 科目代號 (DAN02)
   - 必填欄位
   - 需為有效科目代號

3. 科目名稱 (DAN03)
   - 必填欄位
   - 需為有效科目名稱

## 錯誤處理
1. 錯誤訊息顯示位置：第22行
2. 錯誤訊息類型：
   - 必填欄位未填
   - 資料格式錯誤
   - 公司代號錯誤
   - 科目代號錯誤
   - 系統錯誤

## 使用說明
1. 查詢條件設定：
   - 需輸入公司代號
   - 需輸入科目代號
   - 需輸入科目名稱

2. 科目資料維護：
   - 可輸入科目基本資料
   - 可設定上層科目
   - 可設定下層科目
   - 可設定列印選項

3. 功能操作：
   - 可進行資料查詢
   - 可進行資料處理
   - 可進行科目設定
   - 可返回前頁

4. 注意事項：
   - 公司代號、科目代號和科目名稱為必填欄位
   - 上層科目和下層科目需為有效科目
   - 列印選項需設定為 Y 或 N
   - 處理完成後會顯示處理結果 