# GLA110D 螢幕顯示檔案規格書

## 基本資訊
- 檔案名稱：GLA110D
- 檔案類型：螢幕顯示檔案 (DSPF)
- 來源目錄：QDDSSRC_GLPLIB
- 程式說明：部門資料維護
- 系統：茂世會計系統
- 子系統：總帳系統
- 作者：JOYCE (A1087)
- 建立日期：1992.11.16
- 更新日期：無

## 螢幕規格
- 顯示大小：24x80
- 參考檔案：GLRF (總帳欄位定義檔)
- 螢幕代號：GLA110.1
- 訊息位置：第22行
- 列印功能：支援

## 螢幕佈局
```
<GLA110.1>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                部門資料維護                     時間: [時間]









                         部門代號: [  ] - [  ]

                         部門名稱: [                              ]

                         部門類別: [ ]

                         部門建立日期: [YYMMDD]

                         部門結束日期: [YYMMDD]









[部門資料清單]
序號  部門代號  部門名稱                          部門類別  建立日期  結束日期
----  --------  ------------------------------  --------  --------  --------
[1]   [  ]      [                              ]  [ ]      [      ]  [      ]
[2]   [  ]      [                              ]  [ ]      [      ]  [      ]
[3]   [  ]      [                              ]  [ ]      [      ]  [      ]
[4]   [  ]      [                              ]  [ ]      [      ]  [      ]
[5]   [  ]      [                              ]  [ ]      [      ]  [      ]

[錯誤訊息顯示區域]
注意    PF2 =列印資料    PF3 =返回前頁    PF4 =查詢資料    PF5 =新增資料
       PF6 =修改資料    PF9 =新增列印    PF12=返回前一頁    PF13=列印設定
       PF18=查詢上級資料
                                                           【茂世資訊】
```

## 記錄格式
### DSPD1 - 主畫面
- 條件指示器：CA03(03), CF13(13)
- 標題：<GLA110.1>
- 公司名稱：CONAME (32A, 輸出)
- 日期：DDATE (6Y, 輸出, 日期格式)
- 使用者：$USERN (10A, 輸出)
- 部門代號：DAH01 (參考AH01)
- 部門名稱：#B02 (參考PTRF)
- 部門類別：DAH02 (參考AH02)
- 部門建立日期：DAH10 (參考AH10)
- 部門結束日期：DAH21 (參考AH21)

### DSPD2 - 詳細資料畫面
- 游標位置控制
- 條件指示器：CA03(03), CF04(04), CF05(05), CF06(06), CF09(09), CF12(12), CF18(18)
- 覆蓋顯示
- 保護模式
- 部門代號：DAH03 (參考AH03)
- 部門名稱：DAH04 (參考AH04)
- 部門簡稱：DAF03 (參考AF03)
- 上級部門：DAH12 (參考AH12)
- 下級部門：DAH13 (參考AH13)
- 部門比例：DPERS (7,4, 輸入)
- 是否有效：DAH11 (1, 輸入, Y/N)

### DSPD3 - 部門資料畫面
- 游標位置控制
- 條件指示器：CA03(03), CF04(04), CF05(05), CF12(12)
- 覆蓋顯示
- 保護模式
- 強制資料顯示
- 鎖定模式
- 包含多個部門相關欄位：
  - 部門代號 (DAH03)
  - 部門名稱 (DAH04)
  - 上級部門 (DAH12)
  - 下級部門 (DAH13)
  - 部門比例 (DPERS)
  - 是否有效 (DAH11)

### SFLSR/SFLCR - 子檔案
- 子檔案大小：120筆
- 每頁顯示：5筆
- 條件指示器：CA03(03), CF12(12)
- 覆蓋顯示
- 保護模式
- 包含部門資料清單

### SFLSRD/SFLCRD - 部門資料子檔案
- 子檔案大小：60筆
- 每頁顯示：10筆
- 覆蓋顯示
- 包含部門詳細資料

### SFLSRC/SFLCRC - 部門資料子檔案(複製用)
- 子檔案大小：60筆
- 每頁顯示：10筆
- 覆蓋顯示
- 包含部門詳細資料

## 欄位規格
| 欄位名稱 | 參考欄位 | 位置 | 格式 | 條件指示器 | 說明 |
|---------|---------|------|------|------------|------|
| CONAME | - | 1,25 | 32A | - | 公司名稱 |
| DDATE | - | 1,72 | 6Y | - | 系統日期 |
| $USERN | - | 2,2 | 10A | - | 使用者代號 |
| DAH01 | AH01 | 3,16 | - | 67 | 部門代號 |
| #B02 | PTRF | 3,19 | - | - | 部門名稱 |
| DAH02 | AH02 | 3,71 | - | - | 部門類別 |
| DAH10 | AH10 | 4,16 | - | 68 | 部門建立日期 |
| DAH21 | AH21 | 4,71 | - | 69 | 部門結束日期 |
| ERRMSG | - | 22,2 | 70A | 99 | 錯誤訊息 |

## 功能鍵說明
| 功能鍵 | 說明 |
|-------|------|
| PF2 | 列印資料 |
| PF3 | 返回前頁 |
| PF4 | 查詢資料 |
| PF5 | 新增資料 |
| PF6 | 修改資料 |
| PF9 | 新增列印 |
| PF12 | 返回前一頁 |
| PF13 | 列印設定 |
| PF18 | 查詢上級資料 |

## 輸入欄位驗證
1. 部門代號 (DAH01)
   - 必填欄位
   - 長度：2位
   - 格式：英數字

2. 部門名稱 (DAH04)
   - 必填欄位
   - 長度：30位
   - 格式：中英文

3. 部門類別 (DAH02)
   - 必填欄位
   - 長度：1位
   - 格式：英數字
   - 值域：需符合部門類別代碼表

4. 部門比例 (DPERS)
   - 必填欄位
   - 格式：7,4
   - 範圍：0-100%

## 錯誤處理
1. 錯誤訊息顯示位置：第22行
2. 錯誤訊息類型：
   - 必填欄位未填
   - 資料格式錯誤
   - 資料重複
   - 資料不存在
   - 系統錯誤

## 使用說明
1. 主畫面功能：
   - 可進行部門資料的查詢、新增、修改、刪除等作業
   - 支援分頁顯示
   - 提供多種查詢條件設定

2. 詳細資料畫面：
   - 顯示部門完整資訊
   - 可進行資料維護
   - 提供資料驗證功能

3. 子檔案功能：
   - 顯示部門資料清單
   - 支援分頁瀏覽
   - 可進行資料選擇 