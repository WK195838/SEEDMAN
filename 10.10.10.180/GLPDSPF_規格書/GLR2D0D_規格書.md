# GLR2D0D 螢幕規格書

## 一、基本資訊
- 檔案名稱：GLR2D0D
- 檔案類型：螢幕顯示檔
- 來源目錄：10.10.10.180/QDDSSRC_GLPLIB
- 程式說明：結帳處理
- 系統：會計系統
- 子系統：總帳系統
- 作者：A1149 MAY
- 建立日期：1992.11.26
- 更新日期：
- 備註：結帳處理螢幕顯示檔

## 二、螢幕規格
1. 顯示大小：24x80
2. 參考檔案：*LIBL/GLRF
3. 列印功能：支援
4. 游標位置：變數 #LIN, #COL
5. 功能鍵設定：
   - PF3：返回前頁
   - PF4：重新查詢
   - PF14：處理一筆

## 三、螢幕佈局

### 主畫面 (GLR2D0.1)
```
<GLR2D0.1>                                    [公司名稱]    [系統日期]
[使用者代號]    結帳處理

公司代號: [    ]
會計科目: [    ] (科目名稱*ALL)
會計年度: [    ]
會計期間: [  ]-[  /  /  ]
處理方式: [    ]
處理環境: [ ] (0-查詢 1-列印 2-批次)
公司代號: [   ]
處理代號: [  ]

***處理中請稍候***
***處理完成請按PF14***

錯誤訊息顯示區

說明
PF3 =返回前頁
PF4 =重新查詢
PF14=處理一筆
```

## 四、紀錄格式

### 主畫面欄位規格
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| #LIN | 1 | 3 | S | 0 | 游標行位置 |
| #COL | 1 | 3 | S | 0 | 游標列位置 |
| CONAME | 1 | 32 | A | O | 公司名稱 |
| DDATE | 1 | 6 | Y | 0 | 系統日期 |
| $USERN | 2 | 10 | A | O | 使用者代號 |
| DAI01 | 5 | 4 | B | R | 公司代號 |
| D#A01 | 7 | 4 | B | R | 會計科目 |
| DYEAR | 8 | 3 | Y | 0 | 會計年度 |
| DMMS | 9 | 2 | Y | 0 | 會計期間(起) |
| DAY#E | 9 | 7 | Y | 0 | 會計期間(迄) |
| DAR03 | 10 | 4 | B | R | 處理方式 |
| $PENV | 15 | 1 | A | B | 處理環境 |
| $CPY | 16 | 3 | Y | 0 | 公司代號 |
| $PRTCD | 17 | 2 | A | B | 處理代號 |
| ERRID | 22 | 7 | A | H | 錯誤訊息ID |
| ERRF | 22 | 10 | A | H | 錯誤訊息檔案 |
| ERRMSG | 22 | 70 | A | O | 錯誤訊息 |

## 五、功能鍵說明
1. PF3：返回前頁
2. PF4：重新查詢
3. PF14：處理一筆

## 六、輸入欄位驗證
1. 公司代號：必填欄位
2. 會計科目：必填欄位
3. 會計年度：必填欄位
4. 會計期間：必填欄位
5. 處理方式：必填欄位
6. 處理環境：必填欄位，值域為0-2
7. 公司代號：必填欄位
8. 處理代號：必填欄位

## 七、錯誤處理
1. 錯誤訊息顯示位置：第22行
2. 錯誤訊息格式：錯誤訊息ID + 錯誤訊息檔案 + 錯誤訊息內容
3. 錯誤訊息屬性：高亮度顯示

## 八、使用說明
1. 螢幕用途：
   - 用於結帳處理作業
   - 提供查詢、列印和批次處理功能
   - 顯示處理狀態和錯誤訊息

2. 操作流程：
   - 輸入必要欄位資料
   - 選擇處理環境
   - 按PF14開始處理
   - 等待處理完成
   - 查看處理結果

3. 注意事項：
   - 所有必填欄位必須輸入
   - 處理環境選擇要正確
   - 處理中請勿中斷
   - 錯誤訊息會顯示在螢幕下方 