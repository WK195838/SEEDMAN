# GLA1501D 螢幕顯示檔規格書

## 一、基本資訊
- 檔案名稱：GLA1501D
- 檔案類型：螢幕顯示檔
- 來源目錄：10.10.10.180/QDDSSRC_GLPLIB
- 程式說明：部門會計科目查詢
- 系統：會計總帳系統
- 子系統：會計總帳系統
- 作者：A1152 ANGY
- 建立日期：1992.11.09
- 更新日期：

## 二、螢幕規格
- 顯示大小：24x80
- 參考檔案：GLRF
- 螢幕代號：GLA140.2
- 訊息位置：第22行
- 列印功能：支援
- 條件指示器：
  - CA03(03)：主畫面顯示控制
  - CF12(12)：返回前頁控制
  - CF13(13)：查詢控制

## 三、螢幕佈局

### 主畫面 (GLA140.2)
```
<GLA140.2>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                    部門會計科目查詢               時間: [時間]

公司代號    : [   ]-[  ]
---------------------------------------------------------
S (=查詢) : 5-科目資料查詢
          6-部門會計科目

S NO 科目代號  科目名稱          科目日期    起用日期    停用日期
---------------------------------------------------------
[明細資料顯示區域]
---------------------------------------------------------
[錯誤訊息顯示區域]
注意    PF3 =返回前頁    PF12=返回前頁    PF13=查詢資料
                                                           【茂世資訊】
```

## 四、記錄格式

### 主畫面 (DSPC1)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| CONAME | 1,25 | 32 | A | O | 公司名稱 |
| DDATE | 1,72 | 6 | Y | O | 系統日期 |
| $USERN | 2,2 | 10 | A | O | 使用者代號 |
| DAH01 | 4,16 | - | R | O | 公司代號 |
| D#B02 | 4,19 | - | R | O | 公司名稱 |

### 明細畫面 (SFLSR)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| DOPT | 9,2 | 1 | - | B | 選項(5/6/空白) |
| RRN | 9,5 | 3 | Y | O | 記錄編號 |
| DAH02 | 9,10 | - | R | O | 科目代號 |
| AH26 | 9,21 | - | R | O | 科目名稱 |
| DSU02 | 9,32 | 10 | - | O | 科目說明 |
| DAH25 | 9,45 | 7 | - | O | 科目日期 |
| DAH10 | 9,57 | 7 | - | O | 起用日期 |
| DAH21 | 9,69 | 7 | - | O | 停用日期 |

## 五、功能鍵說明
- PF3：返回前頁
- PF12：返回前頁
- PF13：查詢資料

## 六、輸入欄位驗證
1. 必填欄位：
   - 公司代號 (DAH01)
   - 選項 (DOPT)

2. 資料格式：
   - 公司代號：必須為有效公司代號
   - 選項：必須為5或6
   - 科目代號：必須為有效科目代號
   - 日期格式：必須為有效日期格式

## 七、錯誤處理
- 錯誤訊息顯示位置：第22行
- 錯誤訊息格式：
  - MSGID(&ERRID &ERRF)：動態錯誤訊息
- 錯誤類型：
  - 必填欄位未輸入
  - 資料格式錯誤
  - 公司代號不存在
  - 科目代號不存在
  - 查詢條件不合理

## 八、使用說明
1. 查詢條件設定：
   - 輸入公司代號
   - 選擇查詢選項(5-科目資料查詢/6-部門會計科目)

2. 功能操作說明：
   - 使用PF3返回前頁
   - 使用PF12返回前頁
   - 使用PF13查詢資料

3. 注意事項：
   - 公司代號必須為有效值
   - 查詢選項必須為5或6
   - 科目代號必須為有效值
   - 日期格式必須正確 