# GLR1I0D 螢幕顯示檔規格書

## 一、基本資訊
- 檔案名稱：GLR1I0D
- 檔案類型：螢幕顯示檔
- 來源目錄：10.10.10.180/QDDSSRC_GLPLIB
- 程式說明：結帳處理查詢
- 系統：會計系統
- 子系統：總帳系統
- 作者：A1150
- 建立日期：81/11/05
- 更新日期：
- 備註：結帳處理查詢畫面

## 二、螢幕規格
- 顯示大小：24x80
- 參考檔案：*LIBL/GLRF
- 列印功能：支援
- 游標位置：可變動 (#LIN, #COL)
- 功能鍵設定：
  - PF3：返回
  - PF4：查詢
  - PF14：處理年度

## 三、螢幕佈局

### 主畫面 (GLR1I0.1)
```
<GLR1I0.1>                [公司名稱]                       日期: [YYMMDD]
[使用者ID]                    結帳處理查詢                   時間: [時間]

公司代號: [   ]
系統日期: [  /  /  ] - [  /  /  ]
結帳日期: [  /  /  ] - [  /  /  ]
結帳說明: [          ] - [          ]
系統類別: [   ] (可輸入*ALL )
結帳月份: [   ] (可輸入*ALL )
科目類別: [ ] 
1.未結算
2.已結算
3.全部

處理方式: [ ] (0-查詢 1-列印 2-處理)
每頁筆數: [   ]
處理代號: [  ]

**請確認處理條件正確**
處理條件設定完成

說明
PF3 =返回前頁
PF4 =執行查詢
PF14=處理年度

                                                           【茂世資訊】
```

## 四、記錄格式

### 主畫面 (DSPD1)
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|---------|------|------|------|------|------|
| CONAME | 1,25 | 32 | A | O | 公司名稱 |
| DDATE | 1,72 | 6 | Y | O | 系統日期 |
| $USERN | 2,2 | 10 | A | O | 使用者ID |
| DAH01 | 5,39 | 3 | A | B | 公司代號 |
| D25F | 7,39 | 6 | Y | B | 系統日期起日 |
| D25T | 7,51 | 6 | Y | B | 系統日期迄日 |
| D10F | 8,39 | 6 | Y | B | 結帳日期起日 |
| D10T | 8,51 | 6 | Y | B | 結帳日期迄日 |
| DAH02F | 9,39 | 10 | A | B | 結帳說明起 |
| DAH02T | 9,51 | 10 | A | B | 結帳說明迄 |
| DAH26 | 10,39 | 3 | A | B | 系統類別 |
| DAH17 | 11,39 | 3 | A | B | 結帳月份 |
| DAH19 | 12,39 | 1 | A | B | 科目類別 |
| $PENV | 15,39 | 1 | A | B | 處理方式 |
| $CPY | 16,39 | 3 | Y | B | 每頁筆數 |
| $PRTCD | 17,39 | 2 | A | B | 處理代號 |

## 五、功能鍵說明
- PF3：返回前頁
- PF4：執行查詢
- PF14：處理年度

## 六、輸入欄位驗證
1. 必填欄位：
   - 公司代號 (DAH01)
   - 系統日期起訖 (D25F, D25T)
   - 結帳日期起訖 (D10F, D10T)
   - 結帳說明起訖 (DAH02F, DAH02T)
   - 科目類別 (DAH19)
   - 處理方式 ($PENV)
   - 每頁筆數 ($CPY)
   - 處理代號 ($PRTCD)

2. 資料格式：
   - 公司代號：3位數字
   - 系統日期：日期格式 (YY/MM/DD)
   - 結帳日期：日期格式 (YY/MM/DD)
   - 結帳說明：10位字元
   - 系統類別：3位字元 (*ALL)
   - 結帳月份：3位字元 (*ALL)
   - 科目類別：1-3
   - 處理方式：0-2
   - 每頁筆數：3位數字
   - 處理代號：2位字元

## 七、錯誤處理
- 錯誤訊息顯示位置：第22行
- 錯誤訊息格式：
  - MSGID(&ERRID &ERRF)：動態錯誤訊息
- 錯誤類型：
  - 必填欄位未輸入
  - 資料格式錯誤
  - 處理條件設定錯誤

## 八、使用說明
1. 操作步驟：
   - 輸入公司代號
   - 設定系統日期範圍
   - 設定結帳日期範圍
   - 設定結帳說明範圍
   - 選擇系統類別
   - 選擇結帳月份
   - 選擇科目類別
   - 選擇處理方式
   - 設定每頁筆數
   - 輸入處理代號
   - 按PF4執行查詢或PF14處理年度

2. 注意事項：
   - 請確認所有輸入欄位正確無誤
   - 處理前請先確認處理條件
   - 可隨時按PF3返回前頁
   - 處理方式分為查詢、列印、處理三種
   - 系統類別和結帳月份可輸入*ALL表示全部 