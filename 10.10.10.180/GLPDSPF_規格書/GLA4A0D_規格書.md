# GLA4A0D 螢幕顯示檔案規格書

## 基本資訊
- 檔案名稱：GLA4A0D
- 檔案類型：螢幕顯示檔案 (DSPF)
- 來源目錄：QDDSSRC_GLPLIB
- 程式說明：會計科目查詢
- 系統：茂世會計系統
- 子系統：總帳系統
- 作者：ANGY (A1152)
- 建立日期：1992.10.30
- 更新日期：無

## 螢幕規格
- 顯示大小：24x80
- 參考檔案：GLRF (總帳欄位定義檔)
- 訊息位置：第22行
- 列印功能：支援

## 記錄格式
### DSPD1 - 主畫面
- 條件指示器：CA03(03), CF14(14)
- 標題：<GLA4A0.1>
- 公司名稱：CONAME (32A, 輸出)
- 日期：DDATE (6Y, 輸出, 日期格式)
- 使用者：$USERN (10A, 輸出)
- 會計科目代號：DAD01F (參考AD01)
- 會計科目名稱：DAD02F (參考AD02)
- 會計科目名稱(至)：DAD02T (參考AD02)
- 會計科目代號(至)：DAD01T (參考AD01)
- 查詢選項：DOPT (1Y, 輸入)
  - 1: 已設定科目
  - 2: 已設定科目且允許沖轉
  - 3: 已設定科目且沖轉科目是否允許

### DSPD2 - 詳細資料畫面
- 覆蓋顯示
- 不自動清除
- 會計科目代號：DAD02 (參考AD02)
- 會計科目名稱：DAD03 (參考AD03)
- 是否允許沖轉：COVE (1, 輸入)
  - 值域：Y/N

## 欄位規格
| 欄位名稱 | 參考欄位 | 位置 | 格式 | 條件指示器 | 說明 |
|---------|---------|------|------|------------|------|
| CONAME | - | 1,25 | 32A | - | 公司名稱 |
| DDATE | - | 1,72 | 6Y | - | 系統日期 |
| $USERN | - | 2,2 | 10A | - | 使用者代號 |
| DAD01F | AD01 | 4,19 | - | 60 | 會計科目代號(起) |
| DAD02F | AD02 | 5,19 | - | 61 | 會計科目名稱(起) |
| DAD02T | AD02 | 5,30 | - | 61 | 會計科目名稱(至) |
| DAD01T | AD01 | 7,19 | - | 62 | 會計科目代號(至) |
| DOPT | - | 9,19 | 1Y | - | 查詢選項 |
| ERRMSG | - | 22,2 | 70A | 99 | 錯誤訊息 |

## 功能鍵說明
| 功能鍵 | 說明 |
|-------|------|
| PF3 | 返回前頁 |
| PF14 | 處理一筆 |

## 輸入欄位驗證
1. 會計科目代號 (DAD01F/DAD01T)
   - 必填欄位
   - 格式：需符合會計科目代碼表

2. 會計科目名稱 (DAD02F/DAD02T)
   - 必填欄位
   - 格式：中英文

3. 查詢選項 (DOPT)
   - 必填欄位
   - 值域：1-3

4. 是否允許沖轉 (COVE)
   - 必填欄位
   - 值域：Y/N

## 錯誤處理
1. 錯誤訊息顯示位置：第22行
2. 錯誤訊息類型：
   - 必填欄位未填
   - 資料格式錯誤
   - 資料不存在
   - 系統錯誤

## 使用說明
1. 主畫面功能：
   - 可輸入會計科目範圍進行查詢
   - 可選擇不同的查詢選項
   - 支援分頁顯示

2. 詳細資料畫面：
   - 顯示會計科目完整資訊
   - 可設定是否允許沖轉
   - 提供資料驗證功能 