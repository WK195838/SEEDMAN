# 新增客戶資料與修改通路的具體步驟指引

## 一、新增客戶資料的步驟

### 步驟一：進入客戶主檔維護程式

1. 登入系統後，選擇「主選單」
2. 進入「基本資料」或「系統設定」模組
3. 選擇「客戶主檔維護」選項

### 步驟二：開始新增客戶

1. 在客戶主檔維護畫面中，按下「F6」功能鍵或選擇「新增」選項
2. 系統會顯示一個空白的客戶資料輸入畫面

### 步驟三：輸入客戶基本資料

1. 輸入「客戶編號」(BU01)：依照公司編號規則，通常為6位字元
2. 輸入「客戶名稱」(BU02)：完整的客戶公司名稱，最多40個字元
3. 輸入「客戶簡稱」(BU03)：用於報表顯示，最多20個字元
4. 輸入「統一編號」(BU04)：8位數字的公司統一編號
5. 輸入「聯絡人」(BU05)：客戶聯絡窗口姓名
6. 輸入「電話」(BU06)和「傳真」(BU07)：包含區碼的完整號碼
7. 輸入「地址」(BU08)：客戶公司地址

### 步驟四：設定客戶通路資訊

1. 在相關欄位中選擇或輸入「通路代碼」：
   - 按下F4或相應的查詢鍵查看系統中現有的通路代碼清單
   - 從清單中選擇適合的通路代碼（這些代碼來自PA#2PF參數檔中的S類參數）
   - 如果沒有適合的通路代碼，請先完成客戶其他資料，稍後再新增通路代碼

2. 輸入客戶的「信用額度」(BU09)：設定此客戶的最大交易額度
3. 選擇「付款條件」(BU10)：如月結30天、即期付款等
4. 選擇「幣別」(BU11)：如TWD、USD等
5. 設定「狀態」(BU12)：通常新客戶設為「A」(正常)
6. 輸入「備註」(BU13)：任何需要補充的客戶資訊

### 步驟五：儲存客戶資料

1. 完成所有資料輸入後，按下「Enter」鍵或「儲存」按鈕
2. 系統會進行資料檢核，如有錯誤會顯示提示訊息
3. 如資料無誤，系統會儲存新客戶資料並自動記錄更新日期、時間和操作人員
4. 儲存成功後，系統會顯示確認訊息

## 二、修改客戶通路的步驟

### 步驟一：確認通路代碼定義

1. 進入「參數設定」模組
2. 選擇「參數維護」功能
3. 在查詢條件欄位輸入參數類別「S」（銷貨客戶相關參數）
4. 按下「查詢」按鈕，系統會顯示所有S類參數（現有通路代碼）
5. 檢查是否已有所需的通路代碼：
   - 如已存在，記下參數代碼(#202)和參數名稱(#203)
   - 如不存在，需要先新增通路代碼（參見下方「新增通路代碼」的步驟）

### 步驟二：新增通路代碼（如需要）

1. 在參數維護畫面中，按下「F6」或選擇「新增」選項
2. 輸入以下資料：
   - 參數類別(#201)：輸入「S」（代表銷貨客戶相關參數）
   - 參數代碼(#202)：輸入新的通路代碼（如「S01」、「S02」等）
   - 參數名稱(#203)：輸入通路的中文描述（如「直營門市」、「經銷商」等）
   - 顯示旗標(#204)：輸入「Y」使此參數在查詢時可見
   - 連結參數(#205)：如果需要與其他參數連結，輸入相關參數代碼
   - 帳款參數(#206)：如通路涉及帳款處理，輸入「Y」
   - 帳款連結客戶檔(#207)：如需連結客戶檔，輸入「Y」
   - 其他相關參數：根據業務需求設定其他欄位

3. 輸入完成後，按下「Enter」鍵或「儲存」按鈕
4. 系統會儲存新通路代碼，可以在參數查詢中確認

### 步驟三：查詢要修改的客戶

1. 進入「客戶主檔維護」程式
2. 在查詢欄位輸入客戶編號或其他查詢條件
3. 按下「查詢」按鈕
4. 從查詢結果清單中，選擇要修改通路的客戶記錄
5. 按下「選擇」或對應的功能鍵進入客戶資料修改畫面

### 步驟四：修改客戶通路

1. 在客戶資料修改畫面中，找到通路代碼欄位
2. 修改為新的通路代碼：
   - 直接輸入已知的通路代碼
   - 或按下F4查詢鍵開啟通路代碼清單，從中選擇
3. 如需要，同時更新其他相關欄位：
   - 如果通路變更影響付款條件，一併調整「付款條件」欄位
   - 如果通路變更影響信用額度，一併調整「信用額度」欄位

4. 修改完成後，按下「Enter」鍵或「儲存」按鈕
5. 系統會檢核修改後的資料，並更新客戶記錄

### 步驟五：更新相關帳款設定

1. 進入「客戶帳款設定」程式(ARA002)
2. 在查詢畫面輸入客戶編號
3. 按下「查詢」按鈕，系統會顯示該客戶的帳款設定記錄
4. 如需調整帳款設定：
   - 選擇要修改的帳款記錄，按「修改」或對應功能鍵
   - 更新「帳款類型」(AB04)以符合新通路的需求
   - 如需要，一併調整「幣別」(AB06)和「帳款金額」(AB05)
   - 輸入完成後按「儲存」

### 步驟六：驗證修改結果

1. 重新查詢剛才修改的客戶記錄，確認通路代碼已正確更新
2. 進入「客戶查詢」功能，輸入新的通路代碼作為查詢條件
3. 確認修改的客戶出現在查詢結果中
4. 如有相關報表：
   - 執行「客戶通路分析報表」
   - 檢查修改的客戶是否已歸類到正確的通路群組

### 步驟七：同步通知相關部門

1. 通知業務部門客戶通路已變更，可能影響銷售策略和條件
2. 通知財務部門客戶通路已變更，可能影響帳款處理方式
3. 通知物流部門（如適用），可能影響配送方式或優先順序
4. 記錄變更理由和日期，以便後續追蹤

## 三、客戶資料新增及修改通路處理方案

### 1. 系統分析

根據查看到的系統檔案結構，客戶通路資訊主要儲存在以下幾個位置：

1. **系統主檔 (W2BUPF)**：包含客戶基本資訊
2. **參數設定檔 (PA#2PF)**：其中S類參數用於定義銷貨客戶相關的通路參數
3. **客戶帳款設定 (ARABPF)**：管理客戶的帳款和交易類型設定

### 2. 通路修改方案

#### 2.1 客戶基本資料新增/修改通路

客戶基本資料的通路管理可以通過以下步驟進行：

##### 2.1.1 新增客戶時設定通路

1. 進入客戶主檔維護程式
2. 使用新增功能，填寫必要的客戶基本資訊（客戶編號、名稱、統一編號等）
3. 在相關欄位中設定客戶通路代碼，這個代碼應參考系統中已定義的參數設定檔(PA#2PF)中的S類參數

##### 2.1.2 修改現有客戶的通路

1. 進入客戶主檔維護程式
2. 查詢需要修改的客戶記錄
3. 使用修改功能，更新客戶通路代碼
4. 系統會自動記錄更新日期、時間和操作人員

#### 2.2 參數設定檔中的通路代碼管理

如果需要新增或修改通路代碼本身，需要操作參數設定檔(PA#2PF)：

1. 進入參數設定維護程式
2. 對於新增通路代碼：
   - 設定參數類別(#201)為"S"（銷貨客戶相關參數）
   - 設定參數代碼(#202)為新的通路代碼值
   - 填寫參數名稱(#203)為通路描述
   - 設定顯示旗標(#204)為"Y"使其在查詢中顯示
   - 根據需要設定其他相關參數，如連結參數、帳款參數等

3. 對於修改通路代碼：
   - 查詢現有通路代碼
   - 修改相關參數，但不要更改參數類別和參數代碼（這是組合主鍵）
   - 儲存更改

#### 2.3 客戶帳款與通路關聯設定

如果通路變更會影響客戶的帳款設定，需要通過ARA002程式進行相應調整：

1. 進入客戶帳款設定程式(ARA002)
2. 查詢相關客戶記錄
3. 根據新的通路代碼，調整帳款類型(AB04)
4. 系統會自動同步更新相關的財務處理邏輯

### 3. 系統影響分析

修改客戶通路代碼可能影響以下系統功能：

1. **財務報表**：不同通路的客戶在報表中可能有不同的歸類
2. **帳款處理**：通路代碼可能影響帳款處理邏輯和權限
3. **稅務處理**：不同通路可能有不同的稅務處理方式
4. **庫存連結**：部分通路可能影響庫存連結帳款設定

### 4. 修改前的注意事項

1. **資料備份**：進行任何修改前，建議先備份相關資料
2. **權限檢查**：確保操作人員有足夠權限進行通路設定修改
3. **系統測試**：在非生產環境中測試通路修改後的系統行為
4. **影響評估**：確認通路修改不會對現有業務流程產生負面影響
5. **跨部門協調**：如果通路修改涉及多個部門，需要進行跨部門協調 