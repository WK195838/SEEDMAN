我將為您製作採購管理系統的檔案規格書。

# 採購管理系統檔案規格書

## 一、採購單主檔 (W2BQPF)
- **檔案說明**：採購單主檔
- **主鍵**：BQ01+BQ02 (採購日期+採購單號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BQ01 | 採購日期 | 8 | 數值 | 主鍵1 |
| BQ02 | 採購單號 | 12 | 文字 | 主鍵2 |
| BQ03 | 供應商編號 | 6 | 文字 | - |
| BQ04 | 總金額 | 11 | 數值(2位小數) | - |
| BQ05 | 幣別 | 2 | 文字 | - |
| BQ06 | 交貨日期 | 8 | 數值 | - |
| BQ07 | 付款條件 | 3 | 文字 | - |
| BQ08 | 狀態 | 1 | 文字 | P=待審、A=已審、C=已結案 |
| BQ09 | 備註 | 128 | 文字 | - |
| BQ10 | 審核人員 | 10 | 文字 | - |
| BQ11 | 審核日期 | 8 | 數值 | - |
| BQ12 | 結案日期 | 8 | 數值 | - |
| BQXX | 更新日期 | 8 | 數值 | - |
| BQYY | 更新時間 | 6 | 數值 | - |
| BQZZ | 更新人員 | 10 | 文字 | - |

## 二、採購單明細檔 (W2BRPF)
- **檔案說明**：採購單明細檔
- **主鍵**：BR01+BR02+BR03 (採購單號+項次+產品編號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BR01 | 採購單號 | 12 | 文字 | 主鍵1 |
| BR02 | 項次 | 4 | 數值 | 主鍵2 |
| BR03 | 產品編號 | 9 | 文字 | 主鍵3 |
| BR04 | 產品規格 | 40 | 文字 | - |
| BR05 | 採購數量 | 8 | 數值 | - |
| BR06 | 已收數量 | 8 | 數值 | - |
| BR07 | 未收數量 | 8 | 數值 | - |
| BR08 | 單價 | 11 | 數值(2位小數) | - |
| BR09 | 金額 | 11 | 數值(2位小數) | - |
| BR10 | 交貨日期 | 8 | 數值 | - |
| BR11 | 倉庫代號 | 5 | 文字 | - |
| BR12 | 狀態 | 1 | 文字 | P=待收、R=部分收、C=已收完 |
| BR13 | 備註 | 128 | 文字 | - |
| BRXX | 更新日期 | 8 | 數值 | - |
| BRYY | 更新時間 | 6 | 數值 | - |
| BRZZ | 更新人員 | 10 | 文字 | - |

## 三、採購單主檔邏輯檔

### 1. W2BQLF01
- **檔案說明**：採購單主檔邏輯檔(日期+單號排序)
- **實體檔**：W2BQPF
- **主鍵**：BQ01, BQ02
- **用途**：基本採購單查詢

### 2. W2BQLF02
- **檔案說明**：採購單主檔邏輯檔(供應商+日期排序)
- **實體檔**：W2BQPF
- **主鍵**：BQ03, BQ01(降序)
- **用途**：供應商採購查詢

### 3. W2BQLF03
- **檔案說明**：採購單主檔邏輯檔(狀態+日期排序)
- **實體檔**：W2BQPF
- **主鍵**：BQ08, BQ01(降序)
- **用途**：採購單狀態查詢

## 四、採購單明細邏輯檔

### 1. W2BRLF01
- **檔案說明**：採購單明細邏輯檔(採購單+項次排序)
- **實體檔**：W2BRPF
- **主鍵**：BR01, BR02, BR03
- **用途**：基本明細查詢

### 2. W2BRLF02
- **檔案說明**：採購單明細邏輯檔(產品+日期排序)
- **實體檔**：W2BRPF
- **主鍵**：BR03, BR10(降序), BR01
- **用途**：產品採購查詢

### 3. W2BRLF03
- **檔案說明**：採購單明細邏輯檔(倉庫+日期排序)
- **實體檔**：W2BRPF
- **主鍵**：BR11, BR10(降序), BR01
- **用途**：倉庫採購查詢

## 五、採購單歷史檔 (W2BSPF)
- **檔案說明**：採購單歷史檔
- **主鍵**：BS01+BS02 (採購日期+採購單號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BS01 | 採購日期 | 8 | 數值 | 主鍵1 |
| BS02 | 採購單號 | 12 | 文字 | 主鍵2 |
| BS03 | 供應商編號 | 6 | 文字 | - |
| BS04 | 總金額 | 11 | 數值(2位小數) | - |
| BS05 | 幣別 | 2 | 文字 | - |
| BS06 | 交貨日期 | 8 | 數值 | - |
| BS07 | 付款條件 | 3 | 文字 | - |
| BS08 | 狀態 | 1 | 文字 | C=已結案 |
| BS09 | 備註 | 128 | 文字 | - |
| BS10 | 結案日期 | 8 | 數值 | - |
| BSXX | 更新日期 | 8 | 數值 | - |
| BSYY | 更新時間 | 6 | 數值 | - |
| BSZZ | 更新人員 | 10 | 文字 | - |

## 六、採購單明細歷史檔 (W2BTPF)
- **檔案說明**：採購單明細歷史檔
- **主鍵**：BT01+BT02+BT03 (採購單號+項次+產品編號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BT01 | 採購單號 | 12 | 文字 | 主鍵1 |
| BT02 | 項次 | 4 | 數值 | 主鍵2 |
| BT03 | 產品編號 | 9 | 文字 | 主鍵3 |
| BT04 | 產品規格 | 40 | 文字 | - |
| BT05 | 採購數量 | 8 | 數值 | - |
| BT06 | 已收數量 | 8 | 數值 | - |
| BT07 | 未收數量 | 8 | 數值 | - |
| BT08 | 單價 | 11 | 數值(2位小數) | - |
| BT09 | 金額 | 11 | 數值(2位小數) | - |
| BT10 | 交貨日期 | 8 | 數值 | - |
| BT11 | 倉庫代號 | 5 | 文字 | - |
| BT12 | 狀態 | 1 | 文字 | C=已收完 |
| BT13 | 備註 | 128 | 文字 | - |
| BTXX | 更新日期 | 8 | 數值 | - |
| BTYY | 更新時間 | 6 | 數值 | - |
| BTZZ | 更新人員 | 10 | 文字 | - |

## 七、檔案關聯說明

1. **主要關聯**
   - W2BQPF (採購單主檔) ←→ W2BRPF (明細檔)
   - W2BSPF (歷史主檔) ←→ W2BTPF (歷史明細檔)

2. **邏輯檔關聯**
   - W2BQLF01~03 關聯 W2BQPF
   - W2BRLF01~03 關聯 W2BRPF

## 八、特殊說明

1. **狀態代碼**
   - 採購單狀態：
     - 'P' = 待審
     - 'A' = 已審
     - 'C' = 已結案
   - 明細狀態：
     - 'P' = 待收
     - 'R' = 部分收
     - 'C' = 已收完

2. **金額欄位**
   - 總金額：11位數，2位小數
   - 單價：11位數，2位小數
   - 金額：11位數，2位小數

3. **數量欄位**
   - 採購數量：8位數
   - 已收數量：8位數
   - 未收數量：8位數

4. **採購流程**
   - 採購單審核：待審→已審→已結案
   - 收貨處理：待收→部分收→已收完
   - 付款條件：記錄付款條件代碼

5. **資料維護**
   - 所有檔案都包含更新日期、時間和人員
   - 採購單主檔記錄審核和結案資訊
   - 歷史檔用於保存歷史記錄

這份規格書詳細說明了採購管理系統的檔案結構、關聯和特殊說明，包括採購單主檔、明細檔、歷史檔及其相關邏輯檔的完整規格。每個檔案都經過精心設計，以支援特定的業務需求。
