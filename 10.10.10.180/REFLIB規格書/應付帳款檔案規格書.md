我將為您製作應付帳款系統的檔案規格書。

# 應付帳款系統檔案規格書

## 一、應付帳款主檔 (W2BUPF)
- **檔案說明**：應付帳款主檔
- **主鍵**：BU01+BU02 (供應商編號+幣別)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BU01 | 供應商編號 | 6 | 文字 | 主鍵1 |
| BU02 | 幣別 | 2 | 文字 | 主鍵2 |
| BU03 | 期初餘額 | 11 | 數值(2位小數) | - |
| BU04 | 本期借方 | 11 | 數值(2位小數) | - |
| BU05 | 本期貸方 | 11 | 數值(2位小數) | - |
| BU06 | 期末餘額 | 11 | 數值(2位小數) | - |
| BU07 | 信用額度 | 11 | 數值(2位小數) | - |
| BU08 | 已用額度 | 11 | 數值(2位小數) | - |
| BU09 | 可用額度 | 11 | 數值(2位小數) | - |
| BU10 | 帳齡分析1 | 11 | 數值(2位小數) | - |
| BU11 | 帳齡分析2 | 11 | 數值(2位小數) | - |
| BU12 | 帳齡分析3 | 11 | 數值(2位小數) | - |
| BU13 | 帳齡分析4 | 11 | 數值(2位小數) | - |
| BU14 | 最後交易日期 | 8 | 數值 | - |
| BU15 | 狀態 | 1 | 文字 | A=正常、I=停用 |
| BU16 | 備註 | 128 | 文字 | - |
| BUX | 更新日期 | 8 | 數值 | - |
| BUYY | 更新時間 | 6 | 數值 | - |
| BUZZ | 更新人員 | 10 | 文字 | - |

## 二、應付帳款明細檔 (W2BVPF)
- **檔案說明**：應付帳款明細檔
- **主鍵**：BV01+BV02+BV03 (供應商編號+交易日期+交易單號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BV01 | 供應商編號 | 6 | 文字 | 主鍵1 |
| BV02 | 交易日期 | 8 | 數值 | 主鍵2 |
| BV03 | 交易單號 | 12 | 文字 | 主鍵3 |
| BV04 | 交易類型 | 1 | 文字 | I=發票、P=付款、A=調整 |
| BV05 | 交易金額 | 11 | 數值(2位小數) | - |
| BV06 | 幣別 | 2 | 文字 | - |
| BV07 | 到期日期 | 8 | 數值 | - |
| BV08 | 沖銷單號 | 12 | 文字 | - |
| BV09 | 沖銷日期 | 8 | 數值 | - |
| BV10 | 備註 | 128 | 文字 | - |
| BVXX | 更新日期 | 8 | 數值 | - |
| BVYY | 更新時間 | 6 | 數值 | - |
| BVZZ | 更新人員 | 10 | 文字 | - |

## 三、應付帳款主檔邏輯檔

### 1. W2BULF01
- **檔案說明**：應付帳款主檔邏輯檔(供應商+幣別排序)
- **實體檔**：W2BUPF
- **主鍵**：BU01, BU02
- **用途**：基本應付帳款查詢

### 2. W2BULF02
- **檔案說明**：應付帳款主檔邏輯檔(期末餘額排序)
- **實體檔**：W2BUPF
- **主鍵**：BU06(降序), BU01, BU02
- **選擇條件**：BU15 = 'A'
- **用途**：應付帳款餘額查詢

### 3. W2BULF03
- **檔案說明**：應付帳款主檔邏輯檔(可用額度排序)
- **實體檔**：W2BUPF
- **主鍵**：BU09(降序), BU01, BU02
- **選擇條件**：BU15 = 'A'
- **用途**：信用額度查詢

## 四、應付帳款明細邏輯檔

### 1. W2BVLF01
- **檔案說明**：應付帳款明細邏輯檔(供應商+日期+單號排序)
- **實體檔**：W2BVPF
- **主鍵**：BV01, BV02, BV03
- **用途**：基本交易查詢

### 2. W2BVLF02
- **檔案說明**：應付帳款明細邏輯檔(到期日期排序)
- **實體檔**：W2BVPF
- **主鍵**：BV07, BV01, BV02
- **選擇條件**：BV04 = 'I' 且 BV08 = 空白
- **用途**：到期帳款查詢

### 3. W2BVLF03
- **檔案說明**：應付帳款明細邏輯檔(交易類型+日期排序)
- **實體檔**：W2BVPF
- **主鍵**：BV04, BV02(降序), BV01
- **用途**：交易類型分析

## 五、應付帳款歷史檔 (W2BWPF)
- **檔案說明**：應付帳款歷史檔
- **主鍵**：BW01+BW02+BW03 (供應商編號+年度+月份)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BW01 | 供應商編號 | 6 | 文字 | 主鍵1 |
| BW02 | 年度 | 4 | 數值 | 主鍵2 |
| BW03 | 月份 | 2 | 數值 | 主鍵3 |
| BW04 | 期初餘額 | 11 | 數值(2位小數) | - |
| BW05 | 本期借方 | 11 | 數值(2位小數) | - |
| BW06 | 本期貸方 | 11 | 數值(2位小數) | - |
| BW07 | 期末餘額 | 11 | 數值(2位小數) | - |
| BW08 | 帳齡分析1 | 11 | 數值(2位小數) | - |
| BW09 | 帳齡分析2 | 11 | 數值(2位小數) | - |
| BW10 | 帳齡分析3 | 11 | 數值(2位小數) | - |
| BW11 | 帳齡分析4 | 11 | 數值(2位小數) | - |
| BWXX | 更新日期 | 8 | 數值 | - |
| BWYY | 更新時間 | 6 | 數值 | - |
| BWZZ | 更新人員 | 10 | 文字 | - |

## 六、檔案關聯說明

1. **主要關聯**
   - W2BUPF (應付帳款主檔) ←→ W2BVPF (明細檔)
   - W2BUPF (應付帳款主檔) ←→ W2BWPF (歷史檔)

2. **邏輯檔關聯**
   - W2BULF01~03 關聯 W2BUPF
   - W2BVLF01~03 關聯 W2BVPF

## 七、特殊說明

1. **狀態代碼**
   - 供應商狀態：
     - 'A' = 正常
     - 'I' = 停用
   - 交易類型：
     - 'I' = 發票
     - 'P' = 付款
     - 'A' = 調整

2. **金額欄位**
   - 所有金額欄位：11位數，2位小數
   - 包含期初餘額、本期借貸、期末餘額等

3. **帳齡分析**
   - 帳齡分析1：1-30天
   - 帳齡分析2：31-60天
   - 帳齡分析3：61-90天
   - 帳齡分析4：90天以上

4. **信用管理**
   - 信用額度
   - 已用額度
   - 可用額度

5. **資料維護**
   - 所有檔案都包含更新日期、時間和人員
   - 明細檔記錄所有交易
   - 歷史檔用於保存歷史記錄

這份規格書詳細說明了應付帳款系統的檔案結構、關聯和特殊說明，包括應付帳款主檔、明細檔、歷史檔及其相關邏輯檔的完整規格。每個檔案都經過精心設計，以支援特定的業務需求。
