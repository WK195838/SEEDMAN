我將為您製作銷售訂單系統的檔案規格書。

# 銷售訂單系統檔案規格書

## 一、銷售訂單主檔 (W2BAPF)
- **檔案說明**：銷售訂單主檔
- **主鍵**：BA01+BA02+BA03 (訂單日期+訂單地點+訂單編號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BA01 | 訂單日期 | 8 | 數值 | 主鍵1 |
| BA02 | 訂單地點 | 5 | 文字 | 主鍵2 |
| BA03 | 訂單編號 | 12 | 文字 | 主鍵3 |
| BA04 | 總金額 | 11 | 數值(2位小數) | - |
| BA05 | 狀態 | 1 | 文字 | O=開放、P=處理中、E=結案 |
| BA06 | 幣別 | 2 | 文字 | - |
| BA07 | 備註 | 128 | 文字 | - |
| BA08 | 未出數量 | 2 | 文字 | - |
| BA09 | 區號人員 | 10 | 文字 | - |
| BA10 | 刪除標記 | 1 | 文字 | - |
| BA11 | VIP客戶-區號 | 15 | 文字 | - |
| BA12 | VIP客戶-代號 | 5 | 文字 | - |
| BAXX | 更新日期 | 8 | 數值 | - |
| BAYY | 更新時間 | 6 | 數值 | - |
| BAZZ | 更新人員 | 10 | 文字 | - |

## 二、銷售訂單明細檔 (W2BBPF)
- **檔案說明**：銷售訂單明細檔
- **主鍵**：BB01+BB02 (訂單編號+訂單項次)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BB01 | 訂單編號 | 12 | 文字 | 主鍵1 |
| BB02 | 訂單項次 | 6 | 數值 | 主鍵2 |
| BB03 | 產品編號 | 9 | 文字 | - |
| BB04 | 訂單數量 | 8 | 數值 | - |
| BB05 | 出貨數量 | 8 | 數值 | - |
| BB06 | 未出數量 | 8 | 數值 | - |
| BB07 | 單價 | 11 | 數值(2位小數) | - |
| BB08 | F.O.B.-UNIT | 9 | 數值(2位小數) | - |
| BB08A | FHI-UNIT | 9 | 數值(2位小數) | - |
| BB08B | DUTY-UNIT | 9 | 數值(2位小數) | - |
| BB09 | 狀態 | 1 | 文字 | O=開放、B=批次處理中 |
| BB10 | 備註 | 128 | 文字 | - |
| BB11 | 刪除標記 | 1 | 文字 | - |
| BBXX | 更新日期 | 8 | 數值 | - |
| BBYY | 更新時間 | 6 | 數值 | - |
| BBZZ | 更新人員 | 10 | 文字 | - |

## 三、銷售訂單主檔邏輯檔

### 1. W2BALF04
- **檔案說明**：銷售訂單主檔邏輯檔(訂單地點+日期降序+訂單編號排序)
- **實體檔**：W2BAPF
- **主鍵**：BA02, BA01(降序), BA03
- **選擇條件**：BA05 = 'E'
- **用途**：查詢已結案的訂單

### 2. W2BALF05
- **檔案說明**：銷售訂單主檔邏輯檔(VIP客戶+日期降序+地點+訂單編號排序)
- **實體檔**：W2BAPF
- **主鍵**：BA11, BA12, BA01(降序), BA02, BA03
- **選擇條件**：BA05 = 'O' 或 BA05 = 'P'
- **用途**：查詢VIP客戶的進行中訂單

## 四、銷售訂單明細邏輯檔

### 1. W2BBLF01
- **檔案說明**：銷售訂單明細邏輯檔(訂單編號+產品編號排序)
- **實體檔**：W2BBPF
- **主鍵**：BB01, BB03
- **用途**：依產品編號查詢訂單明細

### 2. W2BBLF02
- **檔案說明**：銷售訂單明細邏輯檔(訂單編號+項次排序，狀態篩選)
- **實體檔**：W2BBPF
- **主鍵**：BB01, BB02
- **選擇條件**：BB09 = 'O' 或 BB09 = 'B'
- **用途**：查詢待處理的訂單項次

### 3. W2BBLF03
- **檔案說明**：銷售訂單明細邏輯檔(訂單編號+項次+產品編號排序)
- **實體檔**：W2BBPF
- **主鍵**：BB01, BB02, BB03
- **用途**：完整訂單明細查詢

### 4. W2BBLF04
- **檔案說明**：銷售訂單明細邏輯檔(產品編號+訂單編號降序排序)
- **實體檔**：W2BBPF
- **主鍵**：BB03, BB01(降序)
- **用途**：依產品查詢訂單歷史

## 五、銷售訂單歷史檔

### 1. 銷售訂單歷史主檔 (W2BEPF)
- **檔案說明**：銷售訂單歷史主檔
- **主鍵**：BE01+BE02+BE03 (訂單日期+訂單地點+訂單編號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BE01 | 訂單日期 | 8 | 數值 | 主鍵1 |
| BE02 | 訂單地點 | 5 | 文字 | 主鍵2 |
| BE03 | 訂單編號 | 12 | 文字 | 主鍵3 |
| BE04 | 總金額 | 11 | 數值(2位小數) | - |
| BE05 | 區號人員 | 10 | 文字 | - |
| BE06 | 幣別 | 5 | 文字 | - |
| BEX | 更新日期 | 8 | 數值 | - |
| BEYY | 更新時間 | 6 | 數值 | - |
| BEZZ | 更新人員 | 10 | 文字 | - |

### 2. 銷售訂單明細歷史檔 (W2BFPF)
- **檔案說明**：銷售訂單明細歷史檔
- **主鍵**：BF01+BF02 (訂單編號+產品編號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BF01 | 訂單編號 | 12 | 文字 | 主鍵1 |
| BF02 | 產品編號 | 9 | 文字 | 主鍵2 |
| BF03 | 數量 | 8 | 數值 | - |
| BF04 | 單價 | 9 | 數值(2位小數) | - |
| BF05 | 金額 | 11 | 數值(2位小數) | - |
| BF06 | 訂單編號 | 12 | 文字 | - |
| BFXX | 更新日期 | 8 | 數值 | - |
| BFYY | 更新時間 | 6 | 數值 | - |
| BFZZ | 更新人員 | 10 | 文字 | - |

## 六、檔案關聯說明

1. **主要關聯**
   - W2BAPF (主檔) ←→ W2BBPF (明細檔)
   - W2BEPF (歷史主檔) ←→ W2BFPF (歷史明細檔)

2. **邏輯檔關聯**
   - W2BALF04, W2BALF05 關聯 W2BAPF
   - W2BBLF01~04 關聯 W2BBPF

## 七、特殊說明

1. **狀態代碼**
   - 訂單狀態：
     - 'O' = 開放
     - 'P' = 處理中
     - 'E' = 結案
   - 明細狀態：
     - 'O' = 開放
     - 'B' = 批次處理中

2. **資料維護**
   - 所有檔案都包含更新日期、時間和人員
   - 主檔和明細檔都包含刪除標記
   - 歷史檔用於保存歷史記錄

3. **邏輯檔用途**
   - 提供不同的資料存取路徑
   - 支援特定的業務查詢需求
   - 提高系統效能

4. **金額欄位**
   - 總金額：11位數，2位小數
   - 單價：9-11位數，2位小數
   - 幣別：2位文字代碼

5. **數量欄位**
   - 訂單數量：8位數
   - 出貨數量：8位數
   - 未出數量：8位數

這份規格書詳細說明了銷售訂單系統的檔案結構、關聯和特殊說明，包括主檔、明細檔、邏輯檔和歷史檔的完整規格。每個檔案都經過精心設計，以支援特定的業務需求。
