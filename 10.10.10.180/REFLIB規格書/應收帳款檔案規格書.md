我將為您製作應收帳款系統的檔案規格書。

# 應收帳款系統檔案規格書

## 一、應收帳款主檔 (W2BJPF)
- **檔案說明**：應收帳款主檔
- **主鍵**：BJ01+BJ02 (客戶編號+幣別)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BJ01 | 客戶編號 | 6 | 文字 | 主鍵1 |
| BJ02 | 幣別 | 2 | 文字 | 主鍵2 |
| BJ03 | 期初餘額 | 11 | 數值(2位小數) | - |
| BJ04 | 本期借方 | 11 | 數值(2位小數) | - |
| BJ05 | 本期貸方 | 11 | 數值(2位小數) | - |
| BJ06 | 期末餘額 | 11 | 數值(2位小數) | - |
| BJ07 | 信用額度 | 11 | 數值(2位小數) | - |
| BJ08 | 已用額度 | 11 | 數值(2位小數) | - |
| BJ09 | 可用額度 | 11 | 數值(2位小數) | - |
| BJ10 | 帳齡分析1 | 11 | 數值(2位小數) | - |
| BJ11 | 帳齡分析2 | 11 | 數值(2位小數) | - |
| BJ12 | 帳齡分析3 | 11 | 數值(2位小數) | - |
| BJ13 | 帳齡分析4 | 11 | 數值(2位小數) | - |
| BJ14 | 最後交易日期 | 8 | 數值 | - |
| BJ15 | 狀態 | 1 | 文字 | A=正常、I=停用 |
| BJ16 | 備註 | 128 | 文字 | - |
| BJXX | 更新日期 | 8 | 數值 | - |
| BJYY | 更新時間 | 6 | 數值 | - |
| BJZZ | 更新人員 | 10 | 文字 | - |

## 二、應收帳款明細檔 (W2BKPF)
- **檔案說明**：應收帳款明細檔
- **主鍵**：BK01+BK02+BK03 (客戶編號+交易日期+交易單號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BK01 | 客戶編號 | 6 | 文字 | 主鍵1 |
| BK02 | 交易日期 | 8 | 數值 | 主鍵2 |
| BK03 | 交易單號 | 12 | 文字 | 主鍵3 |
| BK04 | 交易類型 | 1 | 文字 | I=發票、P=付款、A=調整 |
| BK05 | 交易金額 | 11 | 數值(2位小數) | - |
| BK06 | 幣別 | 2 | 文字 | - |
| BK07 | 到期日期 | 8 | 數值 | - |
| BK08 | 沖銷單號 | 12 | 文字 | - |
| BK09 | 沖銷日期 | 8 | 數值 | - |
| BK10 | 備註 | 128 | 文字 | - |
| BKXX | 更新日期 | 8 | 數值 | - |
| BKYY | 更新時間 | 6 | 數值 | - |
| BKZZ | 更新人員 | 10 | 文字 | - |

## 三、應收帳款主檔邏輯檔

### 1. W2BJLF01
- **檔案說明**：應收帳款主檔邏輯檔(客戶+幣別排序)
- **實體檔**：W2BJPF
- **主鍵**：BJ01, BJ02
- **用途**：基本應收帳款查詢

### 2. W2BJLF02
- **檔案說明**：應收帳款主檔邏輯檔(期末餘額排序)
- **實體檔**：W2BJPF
- **主鍵**：BJ06(降序), BJ01, BJ02
- **選擇條件**：BJ15 = 'A'
- **用途**：應收帳款餘額查詢

### 3. W2BJLF03
- **檔案說明**：應收帳款主檔邏輯檔(可用額度排序)
- **實體檔**：W2BJPF
- **主鍵**：BJ09(降序), BJ01, BJ02
- **選擇條件**：BJ15 = 'A'
- **用途**：信用額度查詢

## 四、應收帳款明細邏輯檔

### 1. W2BKLF01
- **檔案說明**：應收帳款明細邏輯檔(客戶+日期+單號排序)
- **實體檔**：W2BKPF
- **主鍵**：BK01, BK02, BK03
- **用途**：基本交易查詢

### 2. W2BKLF02
- **檔案說明**：應收帳款明細邏輯檔(到期日期排序)
- **實體檔**：W2BKPF
- **主鍵**：BK07, BK01, BK02
- **選擇條件**：BK04 = 'I' 且 BK08 = 空白
- **用途**：到期帳款查詢

### 3. W2BKLF03
- **檔案說明**：應收帳款明細邏輯檔(交易類型+日期排序)
- **實體檔**：W2BKPF
- **主鍵**：BK04, BK02(降序), BK01
- **用途**：交易類型分析

## 五、應收帳款歷史檔 (W2BLPF)
- **檔案說明**：應收帳款歷史檔
- **主鍵**：BL01+BL02+BL03 (客戶編號+年度+月份)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BL01 | 客戶編號 | 6 | 文字 | 主鍵1 |
| BL02 | 年度 | 4 | 數值 | 主鍵2 |
| BL03 | 月份 | 2 | 數值 | 主鍵3 |
| BL04 | 期初餘額 | 11 | 數值(2位小數) | - |
| BL05 | 本期借方 | 11 | 數值(2位小數) | - |
| BL06 | 本期貸方 | 11 | 數值(2位小數) | - |
| BL07 | 期末餘額 | 11 | 數值(2位小數) | - |
| BL08 | 帳齡分析1 | 11 | 數值(2位小數) | - |
| BL09 | 帳齡分析2 | 11 | 數值(2位小數) | - |
| BL10 | 帳齡分析3 | 11 | 數值(2位小數) | - |
| BL11 | 帳齡分析4 | 11 | 數值(2位小數) | - |
| BLXX | 更新日期 | 8 | 數值 | - |
| BLYY | 更新時間 | 6 | 數值 | - |
| BLZZ | 更新人員 | 10 | 文字 | - |

## 六、檔案關聯說明

1. **主要關聯**
   - W2BJPF (應收帳款主檔) ←→ W2BKPF (明細檔)
   - W2BJPF (應收帳款主檔) ←→ W2BLPF (歷史檔)

2. **邏輯檔關聯**
   - W2BJLF01~03 關聯 W2BJPF
   - W2BKLF01~03 關聯 W2BKPF

## 七、特殊說明

1. **狀態代碼**
   - 客戶狀態：
     - 'A' = 正常
     - 'I' = 停用
   - 交易類型：
     - 'I' = 發票
     - 'P' = 付款
     - 'A' = 調整

2. **金額欄位**
   - 所有金額欄位：11位數，2位小數
   - 包含期初餘額、本期借貸、期末餘額等

3. **帳齡分析**
   - 帳齡分析1：1-30天
   - 帳齡分析2：31-60天
   - 帳齡分析3：61-90天
   - 帳齡分析4：90天以上

4. **信用管理**
   - 信用額度
   - 已用額度
   - 可用額度

5. **資料維護**
   - 所有檔案都包含更新日期、時間和人員
   - 明細檔記錄所有交易
   - 歷史檔用於保存歷史記錄

這份規格書詳細說明了應收帳款系統的檔案結構、關聯和特殊說明，包括應收帳款主檔、明細檔、歷史檔及其相關邏輯檔的完整規格。每個檔案都經過精心設計，以支援特定的業務需求。
