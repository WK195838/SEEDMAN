我將為您製作總帳會計系統的檔案規格書。

# 總帳會計系統檔案規格書

## 一、會計科目主檔 (W2BMPF)
- **檔案說明**：會計科目主檔
- **主鍵**：BM01 (科目代號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BM01 | 科目代號 | 12 | 文字 | 主鍵 |
| BM02 | 科目名稱 | 40 | 文字 | - |
| BM03 | 科目類別 | 1 | 文字 | A=資產、L=負債、E=權益、R=收入、X=費用 |
| BM04 | 科目性質 | 1 | 文字 | D=借、C=貸 |
| BM05 | 科目層級 | 1 | 文字 | 1=總帳、2=明細帳 |
| BM06 | 上層科目 | 12 | 文字 | - |
| BM07 | 期初餘額 | 11 | 數值(2位小數) | - |
| BM08 | 本期借方 | 11 | 數值(2位小數) | - |
| BM09 | 本期貸方 | 11 | 數值(2位小數) | - |
| BM10 | 期末餘額 | 11 | 數值(2位小數) | - |
| BM11 | 幣別 | 2 | 文字 | - |
| BM12 | 狀態 | 1 | 文字 | A=正常、I=停用 |
| BM13 | 備註 | 128 | 文字 | - |
| BMXX | 更新日期 | 8 | 數值 | - |
| BMYY | 更新時間 | 6 | 數值 | - |
| BMZZ | 更新人員 | 10 | 文字 | - |

## 二、會計傳票主檔 (W2BNPF)
- **檔案說明**：會計傳票主檔
- **主鍵**：BN01+BN02 (傳票日期+傳票號碼)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BN01 | 傳票日期 | 8 | 數值 | 主鍵1 |
| BN02 | 傳票號碼 | 8 | 文字 | 主鍵2 |
| BN03 | 傳票類型 | 1 | 文字 | G=一般、A=調整、C=結帳 |
| BN04 | 總金額 | 11 | 數值(2位小數) | - |
| BN05 | 幣別 | 2 | 文字 | - |
| BN06 | 來源系統 | 2 | 文字 | - |
| BN07 | 來源單號 | 12 | 文字 | - |
| BN08 | 狀態 | 1 | 文字 | P=待審、A=已審、V=已過帳 |
| BN09 | 備註 | 128 | 文字 | - |
| BN10 | 審核人員 | 10 | 文字 | - |
| BN11 | 審核日期 | 8 | 數值 | - |
| BN12 | 過帳日期 | 8 | 數值 | - |
| BNXX | 更新日期 | 8 | 數值 | - |
| BNYY | 更新時間 | 6 | 數值 | - |
| BNZZ | 更新人員 | 10 | 文字 | - |

## 三、會計傳票明細檔 (W2BOPF)
- **檔案說明**：會計傳票明細檔
- **主鍵**：BO01+BO02+BO03 (傳票日期+傳票號碼+項次)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BO01 | 傳票日期 | 8 | 數值 | 主鍵1 |
| BO02 | 傳票號碼 | 8 | 文字 | 主鍵2 |
| BO03 | 項次 | 4 | 數值 | 主鍵3 |
| BO04 | 科目代號 | 12 | 文字 | - |
| BO05 | 摘要 | 40 | 文字 | - |
| BO06 | 借方金額 | 11 | 數值(2位小數) | - |
| BO07 | 貸方金額 | 11 | 數值(2位小數) | - |
| BO08 | 部門代號 | 4 | 文字 | - |
| BO09 | 成本中心 | 4 | 文字 | - |
| BO10 | 專案代號 | 8 | 文字 | - |
| BO11 | 備註 | 128 | 文字 | - |
| BOXX | 更新日期 | 8 | 數值 | - |
| BOYY | 更新時間 | 6 | 數值 | - |
| BOZZ | 更新人員 | 10 | 文字 | - |

## 四、會計科目主檔邏輯檔

### 1. W2BMLF01
- **檔案說明**：會計科目主檔邏輯檔(科目代號排序)
- **實體檔**：W2BMPF
- **主鍵**：BM01
- **用途**：基本科目查詢

### 2. W2BMLF02
- **檔案說明**：會計科目主檔邏輯檔(科目類別+科目代號排序)
- **實體檔**：W2BMPF
- **主鍵**：BM03, BM01
- **用途**：科目類別查詢

### 3. W2BMLF03
- **檔案說明**：會計科目主檔邏輯檔(上層科目+科目代號排序)
- **實體檔**：W2BMPF
- **主鍵**：BM06, BM01
- **用途**：科目層級查詢

## 五、會計傳票邏輯檔

### 1. W2BNLF01
- **檔案說明**：會計傳票主檔邏輯檔(日期+號碼排序)
- **實體檔**：W2BNPF
- **主鍵**：BN01, BN02
- **用途**：基本傳票查詢

### 2. W2BNLF02
- **檔案說明**：會計傳票主檔邏輯檔(來源系統+單號排序)
- **實體檔**：W2BNPF
- **主鍵**：BN06, BN07
- **用途**：來源單據查詢

### 3. W2BNLF03
- **檔案說明**：會計傳票主檔邏輯檔(狀態+日期排序)
- **實體檔**：W2BNPF
- **主鍵**：BN08, BN01(降序)
- **用途**：傳票狀態查詢

## 六、會計傳票明細邏輯檔

### 1. W2BOLF01
- **檔案說明**：會計傳票明細邏輯檔(傳票+項次排序)
- **實體檔**：W2BOPF
- **主鍵**：BO01, BO02, BO03
- **用途**：基本明細查詢

### 2. W2BOLF02
- **檔案說明**：會計傳票明細邏輯檔(科目+日期排序)
- **實體檔**：W2BOPF
- **主鍵**：BO04, BO01(降序), BO02
- **用途**：科目交易查詢

### 3. W2BOLF03
- **檔案說明**：會計傳票明細邏輯檔(部門+日期排序)
- **實體檔**：W2BOPF
- **主鍵**：BO08, BO01(降序), BO02
- **用途**：部門交易查詢

## 七、檔案關聯說明

1. **主要關聯**
   - W2BMPF (科目主檔) ←→ W2BOPF (傳票明細檔)
   - W2BNPF (傳票主檔) ←→ W2BOPF (傳票明細檔)

2. **邏輯檔關聯**
   - W2BMLF01~03 關聯 W2BMPF
   - W2BNLF01~03 關聯 W2BNPF
   - W2BOLF01~03 關聯 W2BOPF

## 八、特殊說明

1. **狀態代碼**
   - 科目狀態：
     - 'A' = 正常
     - 'I' = 停用
   - 傳票狀態：
     - 'P' = 待審
     - 'A' = 已審
     - 'V' = 已過帳
   - 科目類別：
     - 'A' = 資產
     - 'L' = 負債
     - 'E' = 權益
     - 'R' = 收入
     - 'X' = 費用

2. **金額欄位**
   - 所有金額欄位：11位數，2位小數
   - 包含期初餘額、本期借貸、期末餘額等

3. **科目結構**
   - 科目層級：1=總帳、2=明細帳
   - 科目性質：D=借、C=貸
   - 科目代號：12位文字

4. **傳票處理**
   - 傳票類型：G=一般、A=調整、C=結帳
   - 審核流程：待審→已審→已過帳
   - 來源系統：記錄傳票來源

5. **資料維護**
   - 所有檔案都包含更新日期、時間和人員
   - 傳票主檔記錄審核和過帳資訊
   - 明細檔記錄完整的會計分錄

這份規格書詳細說明了總帳會計系統的檔案結構、關聯和特殊說明，包括會計科目主檔、傳票主檔、傳票明細檔及其相關邏輯檔的完整規格。每個檔案都經過精心設計，以支援特定的業務需求。
