好的，我將為您製作一份完整的檔案規格書。

# 檔案規格說明書

## 一、廠商管理系統檔案

### 1. 廠商主檔 (WOWEPF)
- **檔案說明**：廠商基本資料主檔
- **主鍵**：WE01 (廠商編號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| WE01 | 廠商編號 | 6 | 文字 | 主鍵 |
| WE02 | 廠商名稱 | 40 | 文字 | - |
| WE03 | 廠商簡稱 | 20 | 文字 | - |
| WE04 | 廠商地址一 | 40 | 文字 | - |
| WE041 | 廠商地址二 | 40 | 文字 | - |
| WE05 | 送貨地址一 | 40 | 文字 | - |
| WE051 | 送貨地址二 | 40 | 文字 | - |
| WE06 | 統一編號 | 8 | 文字 | - |
| WE07 | 區號 | 3 | 數值 | - |
| WE08 | 廠商代號 | 6 | 文字 | - |
| WE09 | 電話 | 15 | 文字 | - |
| WE10 | 地址 | 1 | 文字 | 值域：1=台北、2=台中、3=台南 |
| WE11 | 統一編號 | 8 | 文字 | - |
| WE12 | 聯絡人 | 20 | 文字 | - |
| WE13 | 電話 | 15 | 文字 | - |
| WE14 | 傳真 | 15 | 文字 | - |
| WE15 | 排序一 | 3 | 文字 | - |
| WE16 | 排序二 | 3 | 文字 | - |
| WE17 | 排序三 | 3 | 文字 | - |
| WE18 | 建檔日期 | 6 | 日期 | - |
| WE19 | 建檔時間 | 6 | 時間 | - |
| WE20 | 狀態代號 | 1 | 文字 | A=ACTIVE、I=INACTIVE、L=ACTIVE & 鎖定 |
| WE21 | 處理代號 | 1 | 文字 | 2=一般、3=特殊 |
| WEXX | 更新日期 | 6 | 日期 | - |
| WEYY | 更新時間 | 6 | 時間 | - |
| WEZZ | 更新人員 | 10 | 文字 | - |

### 2. 廠商維護檔 (WOWKPF)
- **檔案說明**：廠商資料維護檔
- **主鍵**：WK01+WK02 (廠商編號+廠商簡稱)
- **參考檔案**：WORF

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 參考欄位 | 檢核規則 |
|---------|---------|------|------|----------|----------|
| WK01 | 廠商編號 | 6 | 文字 | WE01 | 主鍵1 |
| WK02 | 廠商簡稱 | 20 | 文字 | WE03 | 主鍵2 |
| WK03 | 廠商地址一 | 40 | 文字 | WE04 | - |
| WK04 | 廠商地址二 | 40 | 文字 | WE04 | - |
| WK05 | 電話 | 15 | 文字 | WE09 | - |
| WK06 | 聯絡人 | 20 | 文字 | WE12 | - |
| WK07 | 排序一 | 3 | 文字 | WE15 | - |
| WK08 | 處理代號 | 1 | 文字 | WE21 | - |
| WKXX | 更新日期 | 6 | 日期 | WEXX | - |
| WKYY | 更新時間 | 6 | 時間 | WEYY | - |
| WKZZ | 更新人員 | 10 | 文字 | WEZZ | - |

### 3. 廠商主檔邏輯檔 (WOWELF01~WOWELF03)

#### 3.1 WOWELF01
- **檔案說明**：廠商主檔邏輯檔(區號排序)
- **實體檔**：WOWEPF
- **主鍵**：WE07, WE01 (區號, 廠商編號)

#### 3.2 WOWELF02
- **檔案說明**：廠商主檔邏輯檔(簡稱排序)
- **實體檔**：WOWEPF
- **主鍵**：WE03 (廠商簡稱)

#### 3.3 WOWELF03
- **檔案說明**：廠商主檔邏輯檔(複合視圖)
- **實體檔**：WOWEPF, WOWKPF
- **主鍵**：WE03, WK02 (廠商簡稱, 廠商簡稱)

## 二、出貨單管理系統檔案

### 1. 出貨單主檔 (W2BAPF)
- **檔案說明**：出貨單主檔
- **主鍵**：BA01+BA02+BA03 (出貨日期+出貨地點+訂單編號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BA01 | 出貨日期 | 8 | 數值 | 主鍵1 |
| BA02 | 出貨地點 | 5 | 文字 | 主鍵2 |
| BA03 | 訂單編號 | 12 | 文字 | 主鍵3 |
| BA04 | 總金額 | 11 | 數值(2位小數) | - |
| BA05 | 狀態 | 1 | 文字 | - |
| BA06 | 幣別 | 2 | 文字 | - |
| BA07 | 備註 | 128 | 文字 | - |
| BA08 | 未出數量 | 2 | 文字 | - |
| BA09 | 區號人員 | 10 | 文字 | - |
| BA10 | 刪除標記 | 1 | 文字 | - |
| BA11 | VIP客戶-區號 | 15 | 文字 | - |
| BA12 | VIP客戶-代號 | 5 | 文字 | - |
| BAXX | 更新日期 | 8 | 數值 | - |
| BAYY | 更新時間 | 6 | 數值 | - |
| BAZZ | 更新人員 | 10 | 文字 | - |

### 2. 出貨單明細檔 (W2BBPF)
- **檔案說明**：出貨單明細檔
- **主鍵**：BB01+BB02 (訂單編號+訂單項次)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BB01 | 訂單編號 | 12 | 文字 | 主鍵1 |
| BB02 | 訂單項次 | 6 | 數值 | 主鍵2 |
| BB03 | 產品編號 | 9 | 文字 | - |
| BB04 | 訂單數量 | 8 | 數值 | - |
| BB05 | 出貨數量 | 8 | 數值 | - |
| BB06 | 未出數量 | 8 | 數值 | - |
| BB07 | 單價 | 11 | 數值(2位小數) | - |
| BB08 | F.O.B.-UNIT | 9 | 數值(2位小數) | - |
| BB08A | FHI-UNIT | 9 | 數值(2位小數) | - |
| BB08B | DUTY-UNIT | 9 | 數值(2位小數) | - |
| BB09 | 狀態 | 1 | 文字 | - |
| BB10 | 備註 | 128 | 文字 | - |
| BB11 | 刪除標記 | 1 | 文字 | - |
| BBXX | 更新日期 | 8 | 數值 | - |
| BBYY | 更新時間 | 6 | 數值 | - |
| BBZZ | 更新人員 | 10 | 文字 | - |

### 3. 出貨單主檔邏輯檔 (W2BALF04, W2BALF05)

#### 3.1 W2BALF04
- **檔案說明**：出貨單主檔邏輯檔(出貨地點+日期降序+訂單編號排序)
- **實體檔**：W2BAPF
- **主鍵**：BA02, BA01(降序), BA03
- **選擇條件**：BA05 = 'E'

#### 3.2 W2BALF05
- **檔案說明**：出貨單主檔邏輯檔(VIP客戶+日期降序+地點+訂單編號排序)
- **實體檔**：W2BAPF
- **主鍵**：BA11, BA12, BA01(降序), BA02, BA03
- **選擇條件**：BA05 = 'O' 或 BA05 = 'P'

### 4. 出貨單明細邏輯檔 (W2BBLF01~W2BBLF04)

#### 4.1 W2BBLF01
- **檔案說明**：出貨單明細邏輯檔(訂單編號+產品編號排序)
- **實體檔**：W2BBPF
- **主鍵**：BB01, BB03

#### 4.2 W2BBLF02
- **檔案說明**：出貨單明細邏輯檔(訂單編號+項次排序，狀態篩選)
- **實體檔**：W2BBPF
- **主鍵**：BB01, BB02
- **選擇條件**：BB09 = 'O' 或 BB09 = 'B'

#### 4.3 W2BBLF03
- **檔案說明**：出貨單明細邏輯檔(訂單編號+項次+產品編號排序)
- **實體檔**：W2BBPF
- **主鍵**：BB01, BB02, BB03

#### 4.4 W2BBLF04
- **檔案說明**：出貨單明細邏輯檔(產品編號+訂單編號降序排序)
- **實體檔**：W2BBPF
- **主鍵**：BB03, BB01(降序)

### 5. 出貨單歷史檔 (W2BEPF)
- **檔案說明**：出貨單歷史主檔
- **主鍵**：BE01+BE02+BE03 (出貨日期+出貨地點+出貨單號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BE01 | 出貨日期 | 8 | 數值 | 主鍵1 |
| BE02 | 出貨地點 | 5 | 文字 | 主鍵2 |
| BE03 | 出貨單號 | 12 | 文字 | 主鍵3 |
| BE04 | 總金額 | 11 | 數值(2位小數) | - |
| BE05 | 區號人員 | 10 | 文字 | - |
| BE06 | 幣別 | 5 | 文字 | - |
| BEX | 更新日期 | 8 | 數值 | - |
| BEYY | 更新時間 | 6 | 數值 | - |
| BEZZ | 更新人員 | 10 | 文字 | - |

### 6. 出貨單明細歷史檔 (W2BFPF)
- **檔案說明**：出貨單明細歷史檔
- **主鍵**：BF01+BF02 (出貨單號+產品編號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BF01 | 出貨單號 | 12 | 文字 | 主鍵1 |
| BF02 | 產品編號 | 9 | 文字 | 主鍵2 |
| BF03 | 數量 | 8 | 數值 | - |
| BF04 | 單價 | 9 | 數值(2位小數) | - |
| BF05 | 金額 | 11 | 數值(2位小數) | - |
| BF06 | 訂單編號 | 12 | 文字 | - |
| BFXX | 更新日期 | 8 | 數值 | - |
| BFYY | 更新時間 | 6 | 數值 | - |
| BFZZ | 更新人員 | 10 | 文字 | - |

## 三、檔案關聯說明

1. **廠商管理系統**
   - WOWEPF (主檔) ←→ WOWKPF (維護檔)
   - WOWELF01~03 提供不同的資料存取路徑

2. **出貨單管理系統**
   - W2BAPF (主檔) ←→ W2BBPF (明細檔)
   - W2BEPF (歷史主檔) ←→ W2BFPF (歷史明細檔)
   - 邏輯檔提供多種查詢路徑

## 四、特殊說明

1. **狀態代碼**
   - 出貨單狀態：'O'=開放、'P'=處理中、'E'=結案
   - 廠商狀態：'A'=啟用、'I'=停用、'L'=鎖定

2. **排序方式**
   - 日期欄位：通常使用降序(DESCEND)
   - 代碼欄位：通常使用升序

3. **資料維護**
   - 所有檔案都包含更新日期、時間和人員
   - 部分檔案包含刪除標記

4. **邏輯檔用途**
   - 提供不同的資料存取路徑
   - 支援特定的業務查詢需求
   - 提高系統效能

這份規格書涵蓋了系統中主要的實體檔和邏輯檔，包括其結構、關聯和特殊說明。每個檔案都經過精心設計，以支援特定的業務需求。
