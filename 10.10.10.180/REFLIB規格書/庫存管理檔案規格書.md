我將為您製作庫存管理系統的檔案規格書。

# 庫存管理系統檔案規格書

## 一、庫存主檔 (W2BGPF)
- **檔案說明**：庫存主檔
- **主鍵**：BG01+BG02 (倉庫代號+產品編號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BG01 | 倉庫代號 | 5 | 文字 | 主鍵1 |
| BG02 | 產品編號 | 9 | 文字 | 主鍵2 |
| BG03 | 庫存數量 | 8 | 數值 | - |
| BG04 | 預留數量 | 8 | 數值 | - |
| BG05 | 可用數量 | 8 | 數值 | - |
| BG06 | 單位 | 3 | 文字 | - |
| BG07 | 最後入庫日期 | 8 | 數值 | - |
| BG08 | 最後出庫日期 | 8 | 數值 | - |
| BG09 | 平均成本 | 11 | 數值(2位小數) | - |
| BG10 | 最後成本 | 11 | 數值(2位小數) | - |
| BG11 | 安全庫存量 | 8 | 數值 | - |
| BG12 | 最大庫存量 | 8 | 數值 | - |
| BG13 | 訂購點 | 8 | 數值 | - |
| BG14 | 經濟訂購量 | 8 | 數值 | - |
| BG15 | 狀態 | 1 | 文字 | A=正常、I=停用 |
| BG16 | 備註 | 128 | 文字 | - |
| BGXX | 更新日期 | 8 | 數值 | - |
| BGYY | 更新時間 | 6 | 數值 | - |
| BGZZ | 更新人員 | 10 | 文字 | - |

## 二、庫存異動檔 (W2BHPF)
- **檔案說明**：庫存異動記錄檔
- **主鍵**：BH01+BH02+BH03 (異動日期+異動單號+異動項次)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BH01 | 異動日期 | 8 | 數值 | 主鍵1 |
| BH02 | 異動單號 | 12 | 文字 | 主鍵2 |
| BH03 | 異動項次 | 6 | 數值 | 主鍵3 |
| BH04 | 倉庫代號 | 5 | 文字 | - |
| BH05 | 產品編號 | 9 | 文字 | - |
| BH06 | 異動類型 | 1 | 文字 | I=入庫、O=出庫、T=調撥 |
| BH07 | 異動數量 | 8 | 數值 | - |
| BH08 | 單位成本 | 11 | 數值(2位小數) | - |
| BH09 | 來源單號 | 12 | 文字 | - |
| BH10 | 來源項次 | 6 | 數值 | - |
| BH11 | 備註 | 128 | 文字 | - |
| BHXX | 更新日期 | 8 | 數值 | - |
| BHYY | 更新時間 | 6 | 數值 | - |
| BHZZ | 更新人員 | 10 | 文字 | - |

## 三、庫存主檔邏輯檔

### 1. W2BGLF01
- **檔案說明**：庫存主檔邏輯檔(倉庫+產品排序)
- **實體檔**：W2BGPF
- **主鍵**：BG01, BG02
- **用途**：基本庫存查詢

### 2. W2BGLF02
- **檔案說明**：庫存主檔邏輯檔(產品+倉庫排序)
- **實體檔**：W2BGPF
- **主鍵**：BG02, BG01
- **用途**：跨倉庫產品查詢

### 3. W2BGLF03
- **檔案說明**：庫存主檔邏輯檔(可用數量排序)
- **實體檔**：W2BGPF
- **主鍵**：BG05(降序), BG01, BG02
- **選擇條件**：BG15 = 'A'
- **用途**：庫存水位查詢

## 四、庫存異動邏輯檔

### 1. W2BHLF01
- **檔案說明**：庫存異動邏輯檔(日期+單號+項次排序)
- **實體檔**：W2BHPF
- **主鍵**：BH01, BH02, BH03
- **用途**：基本異動查詢

### 2. W2BHLF02
- **檔案說明**：庫存異動邏輯檔(產品+日期排序)
- **實體檔**：W2BHPF
- **主鍵**：BH05, BH01(降序), BH02
- **用途**：產品異動歷史查詢

### 3. W2BHLF03
- **檔案說明**：庫存異動邏輯檔(倉庫+日期排序)
- **實體檔**：W2BHPF
- **主鍵**：BH04, BH01(降序), BH02
- **用途**：倉庫異動歷史查詢

## 五、庫存盤點檔 (W2BIPF)
- **檔案說明**：庫存盤點記錄檔
- **主鍵**：BI01+BI02+BI03 (盤點日期+倉庫代號+產品編號)
- **特性**：UNIQUE

| 欄位名稱 | 欄位說明 | 長度 | 屬性 | 檢核規則 |
|---------|---------|------|------|----------|
| BI01 | 盤點日期 | 8 | 數值 | 主鍵1 |
| BI02 | 倉庫代號 | 5 | 文字 | 主鍵2 |
| BI03 | 產品編號 | 9 | 文字 | 主鍵3 |
| BI04 | 帳面數量 | 8 | 數值 | - |
| BI05 | 實盤數量 | 8 | 數值 | - |
| BI06 | 差異數量 | 8 | 數值 | - |
| BI07 | 盤點人員 | 10 | 文字 | - |
| BI08 | 狀態 | 1 | 文字 | P=待確認、C=已確認 |
| BI09 | 備註 | 128 | 文字 | - |
| BIX | 更新日期 | 8 | 數值 | - |
| BIYY | 更新時間 | 6 | 數值 | - |
| BIZZ | 更新人員 | 10 | 文字 | - |

## 六、庫存盤點邏輯檔

### 1. W2BILF01
- **檔案說明**：庫存盤點邏輯檔(日期+倉庫+產品排序)
- **實體檔**：W2BIPF
- **主鍵**：BI01, BI02, BI03
- **用途**：基本盤點查詢

### 2. W2BILF02
- **檔案說明**：庫存盤點邏輯檔(產品+日期排序)
- **實體檔**：W2BIPF
- **主鍵**：BI03, BI01(降序), BI02
- **用途**：產品盤點歷史查詢

## 七、檔案關聯說明

1. **主要關聯**
   - W2BGPF (庫存主檔) ←→ W2BHPF (異動檔)
   - W2BGPF (庫存主檔) ←→ W2BIPF (盤點檔)

2. **邏輯檔關聯**
   - W2BGLF01~03 關聯 W2BGPF
   - W2BHLF01~03 關聯 W2BHPF
   - W2BILF01~02 關聯 W2BIPF

## 八、特殊說明

1. **狀態代碼**
   - 庫存狀態：
     - 'A' = 正常
     - 'I' = 停用
   - 異動類型：
     - 'I' = 入庫
     - 'O' = 出庫
     - 'T' = 調撥
   - 盤點狀態：
     - 'P' = 待確認
     - 'C' = 已確認

2. **數量欄位**
   - 庫存數量：8位數
   - 預留數量：8位數
   - 可用數量：8位數
   - 異動數量：8位數

3. **成本欄位**
   - 平均成本：11位數，2位小數
   - 最後成本：11位數，2位小數
   - 單位成本：11位數，2位小數

4. **庫存控制參數**
   - 安全庫存量
   - 最大庫存量
   - 訂購點
   - 經濟訂購量

5. **資料維護**
   - 所有檔案都包含更新日期、時間和人員
   - 異動檔記錄所有庫存變動
   - 盤點檔用於庫存盤點記錄

這份規格書詳細說明了庫存管理系統的檔案結構、關聯和特殊說明，包括庫存主檔、異動檔、盤點檔及其相關邏輯檔的完整規格。每個檔案都經過精心設計，以支援特定的業務需求。
