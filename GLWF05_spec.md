# GLWF05.txt 檔案規格書

## 檔案概述
GLWF05.txt 是一個定義借貸金額計算(GLWF05)的資料結構檔案，屬於總帳模組(GL模組)系統的一部分。該檔案主要用於處理會計系統中借貸方向的金額計算和分類，協助財務報表產生過程中的借貸方向判別和處理。

## 檔案結構
檔案採用DDS (Data Description Specifications) 格式定義，以REF(GLRF)語句參照GLRF函式庫中的定義。其主要記錄格式為GLWF05R，包含少數幾個關鍵欄位，以WF0501(科目類型)+WF0502(金額)作為複合主鍵。

### 關鍵特性
- 檔案名稱：GLWF05
- 記錄格式：GLWF05R
- 複合主鍵：WF0501(科目類型) + WF0502(金額)
- 參照檔案：GLRF (總帳模組的參照檔案)

## 欄位結構說明

GLWF05.txt 定義了一個記錄格式(GLWF05R)，其中包含以下欄位：

| 欄位名稱 | 資料類型/參照 | 標題說明 | 用途說明 |
|----------|----------|----------|----------|
| WF0501   | 5位數值(5 0) | 科目類型 | 標識科目的類型，1代表借方，2代表貸方 |
| WF0502   | 參照AH12     | 金額     | 該筆借貸交易的金額 |
| WF0503   | 參照AH03     | 傳票編號 | 關聯的會計傳票編號 |
| WF0504   | 參照AH22     | 傳票來源 | 傳票的來源代碼 |

### 欄位詳細說明

#### WF0501(科目類型)
- 資料類型：5位數值型(5 0)
- 用途：區分借方和貸方科目
- 值域：
  - 1：借方（如註解所示「借」）
  - 2：貸方（如註解所示「貸」）
- 特點：作為主鍵的第一部分，用於區分金額的借貸屬性

#### WF0502(金額)
- 參照欄位：AH12（會計傳票檔中的借方金額）
- 用途：記錄交易的金額值
- 特點：作為主鍵的第二部分，結合科目類型形成複合主鍵

#### WF0503(傳票編號)
- 參照欄位：AH03（會計傳票檔中的傳票編號）
- 用途：記錄產生此筆借貸記錄的傳票編號
- 特點：提供追溯到原始傳票的能力

#### WF0504(傳票來源)
- 參照欄位：AH22（會計傳票檔中的傳票來源）
- 用途：標識傳票的來源系統或類型
- 特點：用於區分不同來源的傳票，如手工輸入、自動產生等

### 主鍵結構
檔案定義了由兩個欄位組成的複合主鍵：
```
A          K WF0501
A          K WF0502
```

這種設計表明記錄是依據科目類型(借/貸)和金額的組合來唯一識別的。

## 檔案用途

GLWF05檔案在會計系統中的主要用途包括：

1. **借貸方向處理**：協助處理會計科目借貸方向的判別和計算
2. **金額分類匯總**：按借貸方向對金額進行分類和匯總
3. **財務報表支援**：為需要區分借貸方向的財務報表提供基礎資料
4. **傳票平衡檢查**：協助檢查傳票借貸是否平衡
5. **臨時計算存儲**：在處理過程中暫存借貸方向的計算結果

## 與其他檔案的關聯

GLWF05與總帳模組中的其他檔案有以下關聯：

1. **直接參照關係**：
   - 參照GLRF檔案庫的定義
   - 金額欄位參照會計傳票檔(GLAHPF)的借方金額欄位(AH12)
   - 傳票編號參照會計傳票檔(GLAHPF)的傳票編號欄位(AH03)
   - 傳票來源參照會計傳票檔(GLAHPF)的傳票來源欄位(AH22)

2. **功能關聯**：
   - 與GLWF04互補，GLWF04專注於科目餘額，而GLWF05專注於借貸方向處理
   - 可能為GLWF03/GLWF04提供借貸方向的中間計算結果

3. **資料流向**：
   - 會計傳票資料 → 借貸方向處理 → GLWF05 → 科目餘額計算/報表產生

## GLWF05的獨特性

相較於其他工作檔(GLWF01-GLWF04)，GLWF05具有以下獨特特點：

1. **結構簡潔**：
   - 僅包含4個欄位，是GL工作檔系列中結構最簡潔的檔案之一
   - 欄位設計直接針對借貸方向的處理需求

2. **主鍵設計特殊**：
   - 使用科目類型和金額的組合作為主鍵
   - 這種設計適合於聚焦借貸方向的處理需求

3. **專注借貸方向**：
   - 專門用於處理借貸方向的判別和計算
   - WF0501欄位直接指明借貸屬性(1=借方，2=貸方)

## 系統中的角色

在總帳模組系統中，GLWF05作為借貸金額計算工作檔，扮演以下角色：

1. **借貸方向處理中心**：處理和存儲借貸方向的判別結果
2. **借貸平衡檢查輔助**：協助檢查會計傳票的借貸平衡
3. **報表借貸方向支援**：為財務報表提供借貸方向的處理支援
4. **借貸方向臨時存儲**：暫存借貸方向的處理結果

## 操作考量

使用GLWF05檔案時的主要操作考量：

1. **借貸方向邏輯**：
   - 需明確定義不同科目的借貸方向處理邏輯
   - 確保與會計原則一致的借貸方向判別

2. **與其他工作檔的協作**：
   - 明確GLWF05與其他工作檔(如GLWF03/GLWF04)的協作方式
   - 定義清晰的資料流轉規則

3. **主鍵設計的影響**：
   - 由於主鍵包含金額欄位，需注意金額精度對記錄唯一性的影響
   - 相同科目類型、相同金額的不同交易可能需要額外識別方式

4. **傳票追溯能力**：
   - 通過WF0503(傳票編號)和WF0504(傳票來源)保持對原始傳票的追溯
   - 在除錯和審計時充分利用這種追溯能力

## 特殊使用場景

GLWF05在以下特殊場景中可能特別有用：

1. **科目性質轉換**：
   - 當科目需要改變借貸方向時，可使用GLWF05暫存處理結果
   - 例如，資產負債表中某些項目需要改變其自然借貸方向時

2. **報表金額正負處理**：
   - 在財務報表產生時，需要根據科目性質和報表需求調整金額正負號
   - GLWF05可協助此類邏輯處理

3. **借貸方向特殊規則**：
   - 處理某些特殊科目的借貸方向規則
   - 例如，某些混合性質的科目可能需要特殊的借貸方向判別

## 結論

GLWF05.txt是總帳系統中專注於借貸金額計算的工作檔案定義。它通過簡潔的結構和專注的設計，有效支援會計系統中借貸方向的判別和處理需求。雖然結構比其他工作檔簡單，但其功能對於確保會計處理的準確性至關重要，特別是在報表產生和餘額計算等需要精確借貸方向處理的場景。準確理解和使用這個檔案對於確保會計資料處理的一致性和準確性具有重要意義。 