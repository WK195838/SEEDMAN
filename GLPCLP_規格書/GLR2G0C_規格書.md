# 程式功能規格書

## 1. 基本資料
- **程式名稱**：GLR2G0C
- **程式說明**：會計系統報表控制程式（總分類帳彙總）
- **程式語言**：CLP
- **程式位置**：QCLSRC_GLPLIB/GLR2G0C
- **開發人員**：A1149 HUANG-SHU.MEI
- **建立日期**：1992/12/17
- **系統名稱**：會計系統
- **子系統**：會計處理
- **備註**：總分類帳彙總報表控制
- **聯絡電話**：7313250

## 2. 檔案架構與關聯圖
### 使用檔案：
- **相關程式**
  - GLR2G0：報表控制主程式
  - GLR2G01C：報表執行程式

## 3. 檔案欄位規格說明
### 變數宣告：
| 變數名稱 | 型態 | 長度 | 說明 |
|---------|------|------|------|
| &IN03 | 邏輯 | 1位元 | 控制變數 |
| &IN10 | 邏輯 | 1位元 | 控制變數 |
| &$PENV | 字元 | 1位元 | 環境變數 |

## 4. 輸出/入螢幕布局與說明
- 使用顯示檔案：GLR2G0D
- 螢幕功能：
  * 總分類帳彙總報表控制主畫面
  * 報表執行選項
  * 報表參數設定

## 5. 處理流程程序說明
### 1. 程式初始化
- 宣告變數
- 設定系統參數：
  * 公司代號（LDA 125-127）：'001'
  * 列印代號（LDA 217-218）：'00'
  * 環境變數（LDA 219）：'2'

### 2. 主要處理邏輯
1. 報表控制處理：
   - 呼叫GLR2G0主程式
   - 檢查控制變數&IN03
   - 如果&IN03為真：
     * 清除LDA資料區（501-600）
     * 結束程式

2. 報表執行控制：
   - 讀取環境變數&$PENV
   - 根據環境變數決定執行方式：
     * 環境變數='2'：
       - 提交批次作業執行GLR2G01C
     * 其他環境：
       - 直接呼叫GLR2G01C程式

3. 循環控制：
   - 返回START標籤
   - 重複執行報表控制流程

## 6. 子程序處理邏輯說明
- **GLR2G0**：報表控制主程式
  * 負責總分類帳彙總報表控制畫面的顯示
  * 處理使用者輸入
  * 設定報表參數

- **GLR2G01C**：報表執行程式
  * 執行總分類帳彙總報表的產生
  * 可透過批次作業或直接呼叫執行

## 7. 錯誤處理程序說明與訊息清冊
- 控制變數&IN03為真時：
  * 清除LDA資料區
  * 結束程式
- 批次作業提交失敗時：
  * 影響報表執行
  * 需要檢查作業佇列狀態

## 8. 備註
- 程式主要用於控制總分類帳彙總報表的執行
- 支援兩種執行模式：
  * 批次作業執行
  * 直接程式執行
- 使用LDA資料區傳遞參數
- 程式結構包含：
  * 參數設定
  * 報表控制
  * 報表執行
  * 循環處理 