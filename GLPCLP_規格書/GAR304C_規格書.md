# 程式功能規格書

## 1. 基本資料
- **程式名稱**：GAR304C
- **程式說明**：會計系統主選單控制程式
- **程式語言**：CLP
- **程式位置**：QCLSRC_GLPLIB/GAR304C
- **開發人員**：MERCURY
- **建立日期**：83/02/03
- **系統名稱**：會計系統
- **子系統**：會計處理
- **備註**：會計科目格式報表

## 2. 檔案架構與關聯圖
### 使用檔案：
- **相關程式**
  - GAR304：主選單顯示程式
  - GAR304C1：子選單控制程式

## 3. 檔案欄位規格說明
### 變數宣告：
| 變數名稱 | 型態 | 長度 | 說明 |
|---------|------|------|------|
| &IN03 | 邏輯 | 1位元 | 結束程式控制變數 |
| &IN10 | 邏輯 | 1位元 | 功能控制變數 |
| &$PENV | 字元 | 1位元 | 執行環境變數 |

## 4. 輸出/入螢幕布局與說明
- 使用GAR304程式顯示主選單畫面

## 5. 處理流程程序說明
### 1. 程式初始化
- 設定系統參數：
  * 設定LDA 125-127位置值為'001'
  * 設定LDA 217-218位置值為'00'
  * 設定LDA 219位置值為'2'

### 2. 主要處理邏輯
1. 呼叫GAR304程式顯示主選單
2. 判斷結束條件：
   - 若&IN03為真，清除LDA 501-600位置資料並結束程式
3. 讀取執行環境設定(&$PENV)
4. 根據執行環境決定GAR304C1的執行方式：
   - 若&$PENV = '2'：以批次作業方式執行
   - 其他：直接呼叫執行

## 6. 子程序處理邏輯說明
- **GAR304**：主選單顯示程式
- **GAR304C1**：子選單控制程式
  * 可選擇批次或互動方式執行

## 7. 錯誤處理程序說明與訊息清冊
- 無特別的錯誤處理機制

## 8. 備註
- 程式使用LDA資料區儲存系統參數
- 支援批次和互動兩種執行模式
- 主選單和子選單分離設計，便於維護
- 聯絡電話：5042266 