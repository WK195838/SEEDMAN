# 程式功能規格書

## 1. 基本資料
- **程式名稱**：GLM500C
- **程式說明**：會計系統會計科目查詢選單控制程式
- **程式語言**：CLP
- **程式位置**：QCLSRC_GLPLIB/GLM500C
- **系統名稱**：會計系統
- **子系統**：會計處理
- **備註**：會計科目查詢選單

## 2. 檔案架構與關聯圖
### 使用檔案：
- **顯示檔案**
  - GLM500D：會計科目查詢選單顯示檔案
- **相關程式**
  - P31：日期轉換程式
  - S#S01：權限檢查程式
  - GLA510-GLA550：查詢程式

## 3. 檔案欄位規格說明
### 變數宣告：
| 變數名稱 | 型態 | 長度 | 說明 |
|---------|------|------|------|
| &WDATE | 字元 | 8位元 | 工作日期 |
| &$USER | 字元 | 10位元 | 使用者代號 |
| &S0101I | 字元 | 10位元 | 權限檢查輸入參數 |
| &S0102I | 字元 | 10位元 | 權限檢查輸入參數 |
| &S0101O | 字元 | 1位元 | 權限檢查輸出結果 |
| &P3101I | 數值 | 8位元 | 日期轉換輸入參數 |
| &P3102I | 字元 | 1位元 | 日期轉換輸入參數 |
| &P3103I | 字元 | 1位元 | 日期轉換輸入參數 |
| &P3104I | 字元 | 1位元 | 日期轉換輸入參數 |
| &P3105I | 字元 | 1位元 | 日期轉換輸入參數 |
| &P3101O | 數值 | 8位元 | 日期轉換輸出結果 |

## 4. 輸出/入螢幕布局與說明
- 使用GLM500D顯示檔案
- 記錄格式：DSPD1
- 提供會計科目查詢功能選項：
  * 11-15：查詢功能
  * 90：結束程式

## 5. 處理流程程序說明
### 1. 程式初始化
- 宣告變數
- 宣告顯示檔案
- 讀取LDA資料區：
  * 使用者代號（LDA 101-110）
  * 使用者名稱（LDA 152-161）
  * 工作日期（LDA 201-208）
- 讀取參數資料區：
  * PTDA01（位置1-2）
- 執行日期轉換

### 2. 主要處理邏輯
1. 選單處理迴圈：
   - 接收使用者輸入
   - 根據選項代號設定對應程式：
     * 11-15：查詢功能（GLA510-GLA550）
     * 90：結束程式

2. 權限檢查與程式執行：
   - 呼叫S#S01程式進行權限檢查
   - 有權限則：
     * 執行對應程式
     * 變更會計期間代號為'00'
   - 無權限則設定錯誤指示器

## 6. 子程序處理邏輯說明
- **P31**：日期轉換程式
- **S#S01**：權限檢查程式
- **GLA510-GLA550**：查詢程式

## 7. 錯誤處理程序說明與訊息清冊
- 權限檢查失敗時設定&IN98 = '1'

## 8. 備註
- 程式主要用於控制會計科目查詢選單
- 提供多個功能選項：
  * 查詢功能
- 實作權限控制機制
- 支援日期轉換功能
- 使用LDA資料區儲存系統參數
- 程式執行後會變更會計期間代號
- 程式結構包含：
  * 系統初始化
  * 權限檢查
  * 選單處理
  * 程式執行 