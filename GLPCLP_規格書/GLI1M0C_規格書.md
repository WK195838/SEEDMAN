# 程式功能規格書

## 1. 基本資料
- **程式名稱**：GLI1M0C
- **程式說明**：會計系統會計科目報表控制程式
- **程式語言**：CLP
- **程式位置**：QCLSRC_GLPLIB/GLI1M0C
- **開發人員**：A1152
- **建立日期**：81/11/05
- **系統名稱**：會計系統
- **子系統**：會計處理
- **備註**：會計科目報表
- **聯絡電話**：7313250

## 2. 檔案架構與關聯圖
### 使用檔案：
- **資料庫檔案**
  - GLA7LF01：會計科目主檔
- **相關程式**
  - GLI1M01：報表處理程式

## 3. 檔案欄位規格說明
### 變數宣告：
| 變數名稱 | 型態 | 長度 | 說明 |
|---------|------|------|------|
| &IN03 | 邏輯 | 1位元 | 控制變數 |
| &IN12 | 邏輯 | 1位元 | 控制變數 |
| &DA701 | 字元 | 2位元 | 科目代號 |
| &DA705F | 字元 | 12位元 | 科目代號起值 |
| &DA705T | 字元 | 12位元 | 科目代號迄值 |
| &DA702F | 字元 | 9位元 | 科目名稱起值 |
| &DA702T | 字元 | 9位元 | 科目名稱迄值 |

## 4. 輸出/入螢幕布局與說明
- 無螢幕輸出

## 5. 處理流程程序說明
### 1. 程式初始化
- 宣告變數
- 接收參數：
  * &IN03：控制變數
  * &IN12：控制變數
- 讀取LDA資料區的科目範圍：
  * 科目代號：LDA 501-502
  * 科目代號範圍：LDA 503-514, 515-526
  * 科目名稱範圍：LDA 527-538, 536-547
- 初始化控制變數：
  * &IN03 = '0'
  * &IN12 = '0'

### 2. 主要處理邏輯
1. 開啟會計科目主檔並設定共享：
   - 檔案：GLA7LF01
   - 共享模式：*YES

2. 建立查詢檔案：
   - 根據多個條件篩選資料：
     * 科目代號（A701 = DA701）
     * 科目代號範圍（A705 在 DA705F 到 DA705T 之間）
     * 科目名稱範圍（A702 在 DA702F 到 DA702T 之間）
     * 特殊條件：A704 ≠ 'D'
   - 設定關鍵欄位：A705

3. 執行報表處理：
   - 呼叫GLI1M01程式
   - 傳遞參數：&IN03, &IN12

4. 清理資源：
   - 關閉查詢檔案
   - 刪除檔案覆蓋

## 6. 子程序處理邏輯說明
- **GLI1M01**：報表處理程式
  * 參數：&IN03, &IN12

## 7. 錯誤處理程序說明與訊息清冊
- 無特別的錯誤處理機制

## 8. 備註
- 程式主要用於處理會計科目報表
- 使用LDA資料區儲存科目範圍參數
- 支援多個條件的資料篩選
- 使用查詢檔案進行資料過濾
- 提供控制變數進行處理控制
- 程式結構簡單，主要負責：
  * 參數處理
  * 資料篩選
  * 報表處理 