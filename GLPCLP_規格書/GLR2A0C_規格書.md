# 程式功能規格書

## 1. 基本資料
- **程式名稱**：GLR2A0C
- **程式說明**：會計系統報表控制程式
- **程式語言**：CLP
- **程式位置**：QCLSRC_GLPLIB/GLR2A0C
- **開發人員**：A1149 MAY
- **建立日期**：1992/11/13
- **系統名稱**：會計系統
- **子系統**：會計處理
- **備註**：報表控制
- **聯絡電話**：7313250

## 2. 檔案架構與關聯圖
### 使用檔案：
- **相關程式**
  - GLR2A0：報表處理程式
  - GLR2A01C：報表執行程式

## 3. 檔案欄位規格說明
### 變數宣告：
| 變數名稱 | 型態 | 長度 | 說明 |
|---------|------|------|------|
| &IN03 | 邏輯 | 1位元 | 控制變數 |
| &IN10 | 邏輯 | 1位元 | 控制變數 |
| &$PENV | 字元 | 1位元 | 環境變數 |

## 4. 輸出/入螢幕布局與說明
- 無螢幕輸出
- 使用批次作業方式執行報表

## 5. 處理流程程序說明
### 1. 程式初始化
- 宣告變數
- 設定LDA資料區：
  * 系統代號（LDA 125-127）：'001'
  * 會計期間（LDA 217-218）：'00'
  * 環境設定（LDA 219）：'2'

### 2. 主要處理邏輯
1. 報表處理迴圈：
   - 呼叫GLR2A0程式進行報表處理
   - 檢查處理結果（&IN03）
   - 清除LDA資料區（位置501-600）

2. 報表執行控制：
   - 讀取環境設定（LDA 219）
   - 根據環境設定決定執行方式：
     * 環境='2'：提交批次作業（GLR2A01C）
     * 其他環境：直接呼叫程式（GLR2A01C）

## 6. 子程序處理邏輯說明
- **GLR2A0**：報表處理程式
  * 負責報表資料的處理和準備
  * 回傳處理結果（&IN03, &IN10）

- **GLR2A01C**：報表執行程式
  * 負責實際報表的產生
  * 支援批次和互動式執行

## 7. 錯誤處理程序說明與訊息清冊
- 當&IN03為真時，清除LDA資料區並結束程式

## 8. 備註
- 程式主要用於控制報表的產生
- 支援兩種執行模式：
  * 批次作業模式
  * 互動式執行模式
- 使用LDA資料區儲存系統參數
- 程式結構包含：
  * 系統初始化
  * 報表處理
  * 執行控制
  * 資源清理 