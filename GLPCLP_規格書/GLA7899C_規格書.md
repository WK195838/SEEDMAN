# 程式功能規格書

## 1. 基本資料
- **程式名稱**：GLA7899C
- **程式說明**：會計系統會計科目報表控制程式
- **程式語言**：CLP
- **程式位置**：QCLSRC_GLPLIB/GLA7899C
- **開發人員**：A1087 JOYCE
- **建立日期**：1992.11.06
- **系統名稱**：會計系統
- **子系統**：會計處理
- **備註**：會計科目報表
- **聯絡電話**：7313250

## 2. 檔案架構與關聯圖
### 使用檔案：
- **資料庫檔案**
  - GLAHPF：會計科目主檔
  - GLAIPF：會計科目主檔
  - GLALPF：會計科目主檔
  - GLAMPF：會計科目主檔
- **備份檔案**
  - QGPL/GLAHBKUP
  - QGPL/GLAIBKUP
  - QGPL/GLALBKUP
  - QGPL/GLAMBKUP
- **相關程式**
  - P63：報表處理程式
  - GLA7801：報表處理程式
  - GLA7899T：SQL處理程式

## 3. 檔案欄位規格說明
### 變數宣告：
| 變數名稱 | 型態 | 長度 | 說明 |
|---------|------|------|------|
| &AH01 | 字元 | 2位元 | 科目代號 |
| &AH02 | 字元 | 9位元 | 科目名稱 |

## 4. 輸出/入螢幕布局與說明
- 使用GLAHREV顯示檔案
- 無特別的螢幕布局說明

## 5. 處理流程程序說明
### 1. 程式初始化
- 宣告顯示檔案（GLAHREV）
- 呼叫P63程式

### 2. 主要處理邏輯
1. 備份檔案處理：
   - 刪除舊的備份檔案：
     * GLAHBKUP
     * GLAIBKUP
     * GLALBKUP
     * GLAMBKUP
   - 建立新的備份檔案：
     * 複製GLAHPF到GLAHBKUP
     * 複製GLAIPF到GLAIBKUP
     * 複製GLALPF到GLALBKUP
     * 複製GLAMPF到GLAMBKUP

2. 資料處理迴圈：
   - 接收檔案資料
   - 更新LDA資料區：
     * 科目代號（LDA 501-502）
     * 科目名稱（LDA 503-511）
     * 清除LDA 512-520
   - 呼叫GLA7801程式
   - 重複處理直到無資料

3. 執行SQL處理：
   - 執行GLA7899T SQL程式
   - 不進行交易確認（COMMIT *NONE）

## 6. 子程序處理邏輯說明
- **P63**：報表處理程式
- **GLA7801**：報表處理程式
- **GLA7899T**：SQL處理程式

## 7. 錯誤處理程序說明與訊息清冊
- 處理CPF2105錯誤（檔案不存在）：
  * 忽略錯誤繼續執行
- 處理CPF0864錯誤（無資料）：
  * 跳轉到結束處理

## 8. 備註
- 程式主要用於處理會計科目報表
- 提供檔案備份功能
- 使用LDA資料區儲存處理參數
- 支援批次處理模式
- 最後執行SQL處理程式
- 程式結構包含：
  * 檔案備份
  * 資料處理迴圈
  * SQL處理 