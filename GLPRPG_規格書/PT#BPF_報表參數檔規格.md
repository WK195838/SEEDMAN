# PT#BPF 報表參數檔規格說明

## 檔案說明
- 檔案名稱：PT#BPF
- 檔案用途：儲存季度損益表報表參數
- 檔案類型：實體檔案
- 檔案格式：固定長度記錄

## 檔案布局

### 1. 報表基本資料區（位置 1-70）
| 位置 | 長度 | 欄位名稱 | 說明 |
|------|------|----------|------|
| 1-10 | 10 | COMP_NO | 公司代碼 |
| 11-18 | 8 | RPT_DATE | 報表日期 |
| 19-26 | 8 | START_DATE | 起始日期 |
| 27-34 | 8 | END_DATE | 結束日期 |
| 35-43 | 9 | START_ACCT | 起始科目 |
| 44-52 | 9 | END_ACCT | 結束科目 |
| 53-53 | 1 | RPT_TYPE | 報表類型 |
| 54-54 | 1 | COMP_FLAG | 比較旗標 |
| 55-62 | 8 | COMP_START | 比較起始日期 |
| 63-70 | 8 | COMP_END | 比較結束日期 |

### 2. 報表選項區（位置 71-75）
| 位置 | 長度 | 欄位名稱 | 說明 |
|------|------|----------|------|
| 71-71 | 1 | OPT1 | 選項1（報表格式：1=簡式，2=詳式） |
| 72-72 | 1 | OPT2 | 選項2（顯示累計：Y=是，N=否） |
| 73-73 | 1 | OPT3 | 選項3（顯示比較：Y=是，N=否） |
| 74-74 | 1 | OPT4 | 選項4（顯示百分比：Y=是，N=否） |
| 75-75 | 1 | OPT5 | 選項5（輸出格式：1=螢幕，2=印表機，3=Excel） |

### 3. 報表標題區（位置 76-120）
| 位置 | 長度 | 欄位名稱 | 說明 |
|------|------|----------|------|
| 76-115 | 40 | COMP_NAME | 公司名稱 |
| 116-135 | 20 | RPT_TITLE | 報表標題 |
| 136-155 | 20 | PERIOD | 期間 |
| 156-165 | 10 | USER_ID | 使用者代號 |
| 166-173 | 8 | PRINT_DATE | 列印日期 |

### 4. 報表內容區（位置 174-200）
| 位置 | 長度 | 欄位名稱 | 說明 |
|------|------|----------|------|
| 174-182 | 9 | ACCT_NO | 科目代碼 |
| 183-223 | 41 | ACCT_NAME | 科目名稱 |
| 224-238 | 15 | AMOUNT | 金額 |
| 239-253 | 15 | COMP_AMT | 比較金額 |
| 254-268 | 15 | DIFF_AMT | 差異金額 |
| 269-273 | 5 | DIFF_PCT | 差異百分比 |

### 5. 報表合計區（位置 274-300）
| 位置 | 長度 | 欄位名稱 | 說明 |
|------|------|----------|------|
| 274-323 | 50 | TOTAL_DESC | 合計說明 |
| 324-338 | 15 | TOTAL_AMT | 合計金額 |
| 339-353 | 15 | COMP_TOTAL | 比較合計 |
| 354-368 | 15 | DIFF_TOTAL | 差異合計 |
| 369-373 | 5 | DIFF_PCT | 差異百分比 |

### 6. 錯誤訊息區（位置 374-400）
| 位置 | 長度 | 欄位名稱 | 說明 |
|------|------|----------|------|
| 374-380 | 7 | ERR_ID | 錯誤代碼 |
| 381-460 | 80 | ERR_MSG | 錯誤訊息 |
| 461-468 | 8 | ERR_DATE | 錯誤日期 |
| 469-476 | 8 | ERR_TIME | 錯誤時間 |
| 477-486 | 10 | ERR_USER | 錯誤使用者 |

## 使用說明

### 1. 基本資料區使用
- COMP_NO：必須輸入有效的公司代碼
- RPT_DATE：報表產生的日期，格式為 YYYYMMDD
- START_DATE/END_DATE：報表期間的起訖日期
- START_ACCT/END_ACCT：科目範圍的起訖代碼
- RPT_TYPE：1=簡式報表，2=詳式報表
- COMP_FLAG：Y=需要比較，N=不需要比較

### 2. 報表選項使用
- OPT1：決定報表顯示的詳細程度
- OPT2：決定是否顯示累計金額
- OPT3：決定是否顯示比較金額
- OPT4：決定是否顯示差異百分比
- OPT5：決定報表的輸出方式

### 3. 標題區使用
- COMP_NAME：顯示在報表標題的公司名稱
- RPT_TITLE：報表的主標題
- PERIOD：報表期間說明
- USER_ID：產生報表的使用者代號
- PRINT_DATE：報表列印日期

### 4. 內容區使用
- ACCT_NO：會計科目代碼
- ACCT_NAME：會計科目名稱
- AMOUNT：科目金額
- COMP_AMT：比較期間金額
- DIFF_AMT：差異金額
- DIFF_PCT：差異百分比

### 5. 合計區使用
- TOTAL_DESC：合計項目說明
- TOTAL_AMT：合計金額
- COMP_TOTAL：比較期間合計
- DIFF_TOTAL：差異合計
- DIFF_PCT：差異百分比

### 6. 錯誤訊息區使用
- ERR_ID：錯誤代碼
- ERR_MSG：錯誤說明
- ERR_DATE：錯誤發生日期
- ERR_TIME：錯誤發生時間
- ERR_USER：錯誤發生時的使用者 