# PCR042D 顯示檔規格說明

## 檔案說明
- 檔案名稱：PCR042D
- 檔案用途：季度損益表顯示檔
- 檔案類型：顯示檔
- 檔案格式：固定長度記錄

## 顯示畫面布局

### 1. 標題區（第1-3行）
```
[公司名稱]                                    [系統日期]
[使用者代號]    季度損益表
季度: [Q1/Q2/Q3/Q4]  [年度]    期間: [  /  /  ] - [  /  /  ]
```

### 2. 參數設定區（第4-8行）
```
報表格式: [1=簡式 2=詳式]    顯示累計: [Y=是 N=否]
顯示比較: [Y=是 N=否]        顯示百分比: [Y=是 N=否]
輸出格式: [1=螢幕 2=印表機 3=Excel]
科目範圍: [起始科目] - [結束科目]
```

### 3. 報表內容區（第9-22行）
```
科目代碼     科目名稱                 本季金額    上季金額    年度累計
------------------------------------------------------------
[科目代碼]   [科目名稱]              [金額]     [金額]     [金額]
[科目代碼]   [科目名稱]              [金額]     [金額]     [金額]
...
------------------------------------------------------------
本季合計:    [金額]    上季合計:    [金額]    年度累計:    [金額]
```

### 4. 功能鍵說明區（第23-24行）
```
F3=結束  F4=提示  F5=執行  F12=取消  F24=更多功能鍵
```

## 欄位說明

### 1. 標題區欄位
| 欄位名稱 | 位置 | 長度 | 說明 |
|----------|------|------|------|
| COMP_NAME | 1,1 | 40 | 公司名稱 |
| SYS_DATE | 1,70 | 8 | 系統日期 |
| USER_ID | 2,1 | 10 | 使用者代號 |
| QTR_CODE | 3,5 | 1 | 季度代碼（1-4） |
| YEAR | 3,15 | 4 | 年度 |
| START_DATE | 3,30 | 8 | 起始日期 |
| END_DATE | 3,45 | 8 | 結束日期 |

### 2. 參數設定區欄位
| 欄位名稱 | 位置 | 長度 | 說明 |
|----------|------|------|------|
| RPT_TYPE | 4,10 | 1 | 報表格式（1=簡式，2=詳式） |
| YTD_FLAG | 4,30 | 1 | 顯示累計（Y=是，N=否） |
| COMP_FLAG | 5,10 | 1 | 顯示比較（Y=是，N=否） |
| PCT_FLAG | 5,30 | 1 | 顯示百分比（Y=是，N=否） |
| OUTPUT_TYPE | 6,10 | 1 | 輸出格式（1=螢幕，2=印表機，3=Excel） |
| START_ACCT | 7,10 | 9 | 起始科目 |
| END_ACCT | 7,25 | 9 | 結束科目 |

### 3. 報表內容區欄位
| 欄位名稱 | 位置 | 長度 | 說明 |
|----------|------|------|------|
| ACCT_NO | 9,1 | 9 | 科目代碼 |
| ACCT_NAME | 9,11 | 41 | 科目名稱 |
| AMOUNT | 9,53 | 15 | 本季金額 |
| COMP_AMT | 9,69 | 15 | 上季金額 |
| YTD_AMT | 9,85 | 15 | 年度累計 |

### 4. 合計區欄位
| 欄位名稱 | 位置 | 長度 | 說明 |
|----------|------|------|------|
| TOTAL_AMT | 21,10 | 15 | 本季合計 |
| COMP_TOTAL | 21,30 | 15 | 上季合計 |
| YTD_TOTAL | 21,50 | 15 | 年度累計 |

## 功能鍵說明

### 1. 基本功能鍵
- F3：結束程式
- F4：顯示提示訊息
- F5：執行報表產生
- F12：取消操作
- F24：顯示更多功能鍵

### 2. 特殊功能鍵
- F6：列印報表
- F7：轉出Excel
- F8：轉出PDF
- F9：儲存參數
- F10：載入參數

## 錯誤訊息顯示

### 1. 參數錯誤
- ERR001：無效的季度代碼
- ERR002：無效的年度
- ERR003：無效的科目範圍
- ERR004：無效的報表格式

### 2. 資料錯誤
- ERR101：未結帳月份
- ERR102：資料不完整
- ERR103：金額計算錯誤
- ERR104：科目不存在

### 3. 系統錯誤
- ERR201：檔案存取錯誤
- ERR202：印表機錯誤
- ERR203：Excel轉出錯誤
- ERR204：PDF轉出錯誤

## 使用說明

### 1. 參數設定
1. 選擇報表格式（簡式/詳式）
2. 設定顯示選項（累計/比較/百分比）
3. 選擇輸出格式
4. 輸入科目範圍

### 2. 報表產生
1. 按F5執行報表產生
2. 等待系統處理
3. 檢查報表內容
4. 選擇輸出方式

### 3. 報表輸出
1. 螢幕顯示：直接顯示在畫面上
2. 印表機輸出：按F6列印
3. Excel轉出：按F7轉出
4. PDF轉出：按F8轉出

### 4. 參數儲存
1. 按F9儲存參數
2. 輸入參數名稱
3. 確認儲存

### 5. 參數載入
1. 按F10載入參數
2. 選擇參數名稱
3. 確認載入 