*---------------------------------------------------------------*
*  程式名稱：PCR042P  報表產生程式 (RPGII)
*---------------------------------------------------------------*
*  變數定義
*---------------------------------------------------------------*
C     QTR         DS      1 0      * 季度代碼(1-4)
C     YEAR        DS      4 0      * 年度
C     QTR_TOTAL   DS     15 2      * 季度合計金額
C     QTR_PREV    DS     15 2      * 上季金額
C     QTR_YTD     DS     15 2      * 年度累計金額
C     COMP_OPT    DS      1        * 上季比較選項(Y/N)
C     YTD_OPT     DS      1        * 年度累計選項(Y/N)
C     OUTPUT_TYPE DS      1        * 輸出類型(1:螢幕 2:印表機 3:Excel)
C     COMP_NAME   DS     40        * 公司名稱
C     RPT_TITLE   DS     20        * 報表標題
C     PERIOD      DS     20        * 期間
C     USER_ID     DS     10        * 使用者代號
C     PRINT_DATE  DS      8        * 列印日期
C     WORK_AREA   DS    100        * 工作區
*---------------------------------------------------------------*
*  檔案定義
*---------------------------------------------------------------*
C     GLR2D0P2   E                   DISK    * 報表格式檔
C     GLRPDF     E                   DISK    * 報表參數檔
*---------------------------------------------------------------*
*  參數接收
*---------------------------------------------------------------*
C     *ENTRY    PLIST
C               PARM    QTR
C               PARM    YEAR
C               PARM    QTR_TOTAL
C               PARM    QTR_PREV
C               PARM    QTR_YTD
C               PARM    COMP_OPT
C               PARM    YTD_OPT
*---------------------------------------------------------------*
*  取得報表參數
*---------------------------------------------------------------*
C               CHAIN   'PARM' GLRPDF
C               IF      %FOUND
C               MOVE    COMP_NAME COMP_NAME
C               MOVE    RPT_TITLE RPT_TITLE
C               MOVE    USER_ID   USER_ID
C               ENDIF
*---------------------------------------------------------------*
*  設定報表期間
*---------------------------------------------------------------*
C     QTR       IFEQ    1
C               MOVE    '1Q'     PERIOD
C     QTR       ELSEIF  2
C               MOVE    '2Q'     PERIOD
C     QTR       ELSEIF  3
C               MOVE    '3Q'     PERIOD
C     QTR       ELSEIF  4
C               MOVE    '4Q'     PERIOD
C               ENDIF
*---------------------------------------------------------------*
*  取得系統日期
*---------------------------------------------------------------*
C               TIME                    PRINT_DATE
*---------------------------------------------------------------*
*  產生報表標題
*---------------------------------------------------------------*
C               CHAIN   'HEADER' GLR2D0P2
C               IF      %FOUND
C               UPDATE  GLR2D0P2R
C               ENDIF
*---------------------------------------------------------------*
*  產生報表內容
*---------------------------------------------------------------*
C               CHAIN   'DETAIL' GLR2D0P2
C               IF      %FOUND
C               UPDATE  GLR2D0P2R
C               ENDIF
*---------------------------------------------------------------*
*  產生報表合計
*---------------------------------------------------------------*
C               CHAIN   'TOTAL' GLR2D0P2
C               IF      %FOUND
C               UPDATE  GLR2D0P2R
C               ENDIF
*---------------------------------------------------------------*
*  輸出報表
*---------------------------------------------------------------*
C     OUTPUT_TYPE IFEQ    '1'
C               EXFMT    SCREEN
C     OUTPUT_TYPE ELSEIF  '2'
C               EXFMT    PRINTER
C     OUTPUT_TYPE ELSEIF  '3'
C               EXFMT    EXCEL
C               ENDIF
*---------------------------------------------------------------*
C               SETON   LR
*---------------------------------------------------------------* 