# PCR042D LDA 格式說明

## LDA 基本說明
- 程式名稱：PCR042D
- 用途：季度損益表顯示檔
- 記錄長度：400 bytes
- 記錄格式：固定長度

## LDA 記錄布局

### 1. 標題區（位置 1-70）
| 位置 | 長度 | 欄位名稱 | 說明 |
|------|------|----------|------|
| 1-40 | 40 | COMP_NAME | 公司名稱 |
| 41-48 | 8 | SYS_DATE | 系統日期 |
| 49-58 | 10 | USER_ID | 使用者代號 |
| 59-59 | 1 | QTR_CODE | 季度代碼（1-4） |
| 60-63 | 4 | YEAR | 年度 |
| 64-71 | 8 | START_DATE | 起始日期 |
| 72-79 | 8 | END_DATE | 結束日期 |

### 2. 參數設定區（位置 80-150）
| 位置 | 長度 | 欄位名稱 | 說明 |
|------|------|----------|------|
| 80-80 | 1 | RPT_TYPE | 報表格式（1=簡式，2=詳式） |
| 81-81 | 1 | YTD_FLAG | 顯示累計（Y=是，N=否） |
| 82-82 | 1 | COMP_FLAG | 顯示比較（Y=是，N=否） |
| 83-83 | 1 | PCT_FLAG | 顯示百分比（Y=是，N=否） |
| 84-84 | 1 | OUTPUT_TYPE | 輸出格式（1=螢幕，2=印表機，3=Excel） |
| 85-93 | 9 | START_ACCT | 起始科目 |
| 94-102 | 9 | END_ACCT | 結束科目 |
| 103-150 | 48 | FILLER1 | 保留欄位 |

### 3. 報表內容區（位置 151-300）
| 位置 | 長度 | 欄位名稱 | 說明 |
|------|------|----------|------|
| 151-159 | 9 | ACCT_NO | 科目代碼 |
| 160-200 | 41 | ACCT_NAME | 科目名稱 |
| 201-215 | 15 | AMOUNT | 本季金額 |
| 216-230 | 15 | COMP_AMT | 上季金額 |
| 231-245 | 15 | YTD_AMT | 年度累計 |
| 246-300 | 55 | FILLER2 | 保留欄位 |

### 4. 合計區（位置 301-350）
| 位置 | 長度 | 欄位名稱 | 說明 |
|------|------|----------|------|
| 301-315 | 15 | TOTAL_AMT | 本季合計 |
| 316-330 | 15 | COMP_TOTAL | 上季合計 |
| 331-345 | 15 | YTD_TOTAL | 年度累計 |
| 346-350 | 5 | FILLER3 | 保留欄位 |

### 5. 錯誤訊息區（位置 351-400）
| 位置 | 長度 | 欄位名稱 | 說明 |
|------|------|----------|------|
| 351-357 | 7 | ERR_ID | 錯誤代碼 |
| 358-437 | 80 | ERR_MSG | 錯誤訊息 |
| 438-445 | 8 | ERR_DATE | 錯誤日期 |
| 446-453 | 8 | ERR_TIME | 錯誤時間 |
| 454-463 | 10 | ERR_USER | 錯誤使用者 |
| 464-400 | 37 | FILLER4 | 保留欄位 |

## 欄位說明

### 1. 標題區欄位
- COMP_NAME：公司名稱，左靠齊
- SYS_DATE：系統日期，格式為 YYYYMMDD
- USER_ID：使用者代號，左靠齊
- QTR_CODE：季度代碼，1-4
- YEAR：年度，4位數
- START_DATE：起始日期，格式為 YYYYMMDD
- END_DATE：結束日期，格式為 YYYYMMDD

### 2. 參數設定區欄位
- RPT_TYPE：報表格式代碼
- YTD_FLAG：顯示累計旗標
- COMP_FLAG：顯示比較旗標
- PCT_FLAG：顯示百分比旗標
- OUTPUT_TYPE：輸出格式代碼
- START_ACCT：起始科目代碼
- END_ACCT：結束科目代碼

### 3. 報表內容區欄位
- ACCT_NO：科目代碼，左靠齊
- ACCT_NAME：科目名稱，左靠齊
- AMOUNT：本季金額，右靠齊，含小數點2位
- COMP_AMT：上季金額，右靠齊，含小數點2位
- YTD_AMT：年度累計，右靠齊，含小數點2位

### 4. 合計區欄位
- TOTAL_AMT：本季合計，右靠齊，含小數點2位
- COMP_TOTAL：上季合計，右靠齊，含小數點2位
- YTD_TOTAL：年度累計，右靠齊，含小數點2位

### 5. 錯誤訊息區欄位
- ERR_ID：錯誤代碼，左靠齊
- ERR_MSG：錯誤訊息，左靠齊
- ERR_DATE：錯誤日期，格式為 YYYYMMDD
- ERR_TIME：錯誤時間，格式為 HHMMSS
- ERR_USER：錯誤使用者，左靠齊

## 使用說明

### 1. 資料初始化
- 所有數值欄位初始值為 0
- 所有字元欄位初始值為空白
- 所有日期欄位初始值為系統日期
- 所有時間欄位初始值為系統時間

### 2. 資料驗證
- 季度代碼必須為 1-4
- 年度必須為 4位數
- 日期格式必須為 YYYYMMDD
- 科目代碼必須為 9位數
- 金額欄位必須為數值

### 3. 資料處理
- 金額欄位計算時保留 2位小數
- 百分比計算時保留 1位小數
- 日期時間欄位使用系統格式
- 錯誤訊息最多顯示 80個字元

### 4. 錯誤處理
- 錯誤代碼為 7位數
- 錯誤訊息最多 80個字元
- 錯誤日期時間使用系統值
- 錯誤使用者記錄操作者代號 